---
layout: post
title:  "JS判断鼠标从什么方向进入一个容器"
date:   2012-11-06 16:12:00
author: 司徒正美
categories: program
---

## JS判断鼠标从什么方向进入一个容器
### by 司徒正美
### at 2012-11-06 16:12:00
### original <http://www.cnblogs.com/rubylouvre/archive/2012/11/06/2757175.html>

<div><img src="http://images.cnblogs.com/cnblogs_com/rubylouvre/199042/o_js_direction.png"></div><p>偶然将想到的一个如何判断鼠标从哪个方向进入一个容器的问题。首先想到的是给容器的四个边添加几个块，然后看鼠标进入的时候哪个块先监听到鼠标事件。不过这样麻烦太多了。google了一下找到了一个不错的解决方法，是基于jquery的，<a href="http://stackoverflow.com/questions/3627042/jquery-animation-for-a-hover-with-mouse-direction">原文地址</a></p><p>说实话，其中的var direction = Math.round((((Math.atan2(y, x) * (180 / Math.PI)) + 180) / 90) + 3) % 4;这句用到的数学知识我是真没有看明白，原文中有一些英文注释我就不一一说明了。代码部分不是很多，我直接写了个示例。</p> &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;meta charset=&quot;UTF-8&quot;&gt;&lt;title&gt;判断鼠标进入方向&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;style&gt;html,body{margin:0;padding:0;}#wrap{width:300px;height:300px;background:#33aa00;margin:50px;display:inline-block;font-size:50px;text-align:center;line-height:300px;}&lt;/style&gt;&lt;div id=&quot;wrap&quot;&gt; 方向反馈&lt;/div&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;http://common.cnblogs.com/script/jquery.js&quot;&gt;&lt;/script&gt;&lt;script&gt;$(&quot;#wrap&quot;).bind(&quot;mouseenter mouseleave&quot;,function(e) {var w = $(this).width();var h = $(this).height();var x = (e.pageX - this.offsetLeft - (w / 2)) * (w &gt; h ? (h / w) : 1);var y = (e.pageY - this.offsetTop - (h / 2)) * (h &gt; w ? (w / h) : 1);var direction = Math.round((((Math.atan2(y, x) * (180 / Math.PI)) + 180) / 90) + 3) % 4;var eventType = e.type;var dirName = new Array(&#39;上方&#39;,&#39;右侧&#39;,&#39;下方&#39;,&#39;左侧&#39;);if(e.type == &#39;mouseenter&#39;){$(this).html(dirName[direction]+&#39;进入&#39;);}else{$(this).html(dirName[direction]+&#39;离开&#39;);}});&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;<p>运行代码</p> <p>鼠标移动到上面，可以看到效果。其中返回的direction的值为“0,1,2,3”分别对应着“上，右，下，左”<br>所以结果值可以switch循环</p><br><br><br>switch (direction) {<br>  case 0:<br>$(this).html('上方进入');<br>break;<br>  case 1:<br>$(this).html('右侧进入');<br>break;<br>  case 2:<br>$(this).html('下方进入');<br>break;<br>  case 3:<br>$(this).html('左侧进入');<br>break;<br>}<p>原文代码是基于jquery的，后面我写了个原生的js效果，代码没有封装，给需要的朋友。由于firefox等浏览器不支持mouseenter,mouseleave事件，所以我暂时用mouseover,mouseout代替了，如果大家需要解决冒泡问题的话，还是自行搜索兼容性解决方法吧。</p><br><br>var wrap = document.getElementById('wrap');<br>var hoverDir = function(e){<br>var w=wrap.offsetWidth;<br>var h=wrap.offsetHeight;<br>var x=(e.clientX - wrap.offsetLeft - (w / 2)) * (w &gt; h ? (h / w) : 1);<br>var y=(e.clientY - wrap.offsetTop - (h / 2)) * (h &gt; w ? (w / h) : 1);<br>var direction = Math.round((((Math.atan2(y, x) * (180 / Math.PI)) + 180) / 90) + 3) % 4;<br>var eventType = e.type;<br>var dirName = new Array('上方','右侧','下方','左侧');<br>if(e.type == 'mouseover' || e.type == 'mouseenter'){<br>wrap.innerHTML=dirName[direction]+'进入';<br>}else{<br>wrap.innerHTML=dirName[direction]+'离开';<br>}<br>}<br>if(window.addEventListener){<br>wrap.addEventListener('mouseover',hoverDir,false);<br>wrap.addEventListener('mouseout',hoverDir,false);<br>}else if(window.attachEvent){<br>wrap.attachEvent('onmouseenter',hoverDir);<br>wrap.attachEvent('onmouseleave',hoverDir);<br>}            <p>作者：痞子</p>            <p>原贴地址：http://www.niumowang.org/javascript/js-direction/</p><img src="http://www.cnblogs.com/rubylouvre/aggbug/2757175.html?type=1" width="1" height="1" alt=""><p><a href="http://www.cnblogs.com/rubylouvre/archive/2012/11/06/2757175.html">本文链接</a></p>