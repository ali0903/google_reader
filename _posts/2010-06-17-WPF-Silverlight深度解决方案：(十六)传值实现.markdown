---
layout: post
title:  "WPF/Silverlight深度解决方案：(十六)传值实现"
date:   2010-06-17 15:55:00
author: 深蓝色右手
categories: program
---

## WPF/Silverlight深度解决方案：(十六)传值实现
### by 深蓝色右手
### at 2010-06-17 15:55:00
### original <http://www.cnblogs.com/alamiye010/archive/2010/06/17/1759611.html>

<p><a href="http://www.cnblogs.com/alamiye010/"><img src="http://pic.cnblogs.com/face/u71881.jpg" alt="" border="0"></a><br>作者: <a href="http://www.cnblogs.com/alamiye010/">深蓝色右手</a> 发表于 2010-06-17 15:55 <a href="http://www.cnblogs.com/alamiye010/archive/2010/06/17/1759611.html">原文链接</a> 阅读: 983 评论: 8</p><p style="margin:0cm 0cm 0pt;text-indent:21pt"><span style="font-family:宋体">许多开发者在从</span><span lang="EN-US"><font face="Times New Roman">.NET</font></span><span style="font-family:宋体">网站开发向</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">转型过程中往往都会经历一个比较郁闷的过度期：</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">作为镶嵌在网页中的插件，如何能像传统</span><span lang="EN-US"><font face="Times New Roman">ASP.NET</font></span><span style="font-family:宋体">网页一样实现页面切换及参数传递等问题时常捆饶着大家。解决之道我们还得从本质谈起。</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21pt"><span lang="EN-US"><font face="Times New Roman">ASP.NET</font></span><span style="font-family:宋体">网站主要是基于服务器端的开发</span><span lang="EN-US"><font face="Times New Roman">(</font></span><span lang="EN-US" style="font-size:9.5pt;color:red;font-family:NSimSun">runat</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">="server"</span><span lang="EN-US"><font face="Times New Roman">)</font></span><span style="font-family:宋体">；由于在服务器中运行，因此</span><span lang="EN-US"><font face="Times New Roman">ASPX</font></span><span style="font-family:宋体">动态页面操作的都是服务器端对象，比如访问服务器中的数据库等；而</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">则是标准的客户端插件</span><span lang="EN-US"><font face="Times New Roman">(</font></span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">&lt;</span><span lang="EN-US" style="font-size:9.5pt;color:maroon;font-family:NSimSun">object</span><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"> …</span><span lang="EN-US"><font face="Times New Roman">)</font></span><span style="font-family:宋体">，如果去掉它的网页外壳</span><span lang="EN-US"><font face="Times New Roman">(out-of-browser)</font></span><span style="font-family:宋体">，它的形态与客户端软件几乎无差别，在安全使用范围内它能与用户的电脑直接进行数据交互；相反，如果想通过</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">去访问网络上某台服务器中的数据库，则必须劳驾第三者如</span><span lang="EN-US"><font face="Times New Roman">WCF</font></span><span style="font-family:宋体">等作为传输中介。</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21pt"><span style="font-family:宋体">因此，对于初学</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">的朋友我强烈建议大家深刻分清楚</span><font face="Times New Roman"> </font><span style="color:maroon;font-family:宋体">服务器端</span><font face="Times New Roman"> </font><span style="font-family:宋体">与</span><font face="Times New Roman"> </font><span style="color:maroon;font-family:宋体">客户端</span><font face="Times New Roman"> </font><span style="font-family:宋体">的区别，就像当初在学习</span><span lang="EN-US"><font face="Times New Roman">ASP.NET</font></span><span style="font-family:宋体">时，必须分清服务器端控件与客户端控件的区别一样。</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21pt"><span style="font-family:宋体">大家先看个例子：我们创建一个</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">应用程序网站，此时整个解决方案中将包含两个项目分别为</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">项目和</span><span lang="EN-US"><font face="Times New Roman">Web</font></span><span style="font-family:宋体">网站项目，为了进行对比分析，我们在</span><span lang="EN-US"><font face="Times New Roman">Web</font></span><span style="font-family:宋体">网站项目中添加一个</span><span lang="EN-US"><font face="Times New Roman">ASP.NET</font></span><span style="font-family:宋体">页面，然后分别在该两个项目中均编写代码一模一样的静态类</span><span lang="EN-US"><font face="Times New Roman">Global.cs</font></span><span style="font-family:宋体">：</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>    </span><span style="color:blue">public</span> <span style="color:blue">static</span> <span style="color:blue">class</span> <span style="color:#2b91af">Global</span> {</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>        </span><span style="color:blue">public</span> <span style="color:blue">static</span> <span style="color:blue">int</span> num = 50;</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:18pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun">}</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><img alt="" src="http://images.cnblogs.com/cnblogs_com/alamiye010/100617/0.jpg" border="0"></span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21.75pt"><span style="font-family:宋体">接着在</span><span lang="EN-US"><font face="Times New Roman">Index.aspx</font></span><span style="font-family:宋体">页面中添加一个按钮，每次点击时</span><span lang="EN-US"><font face="Times New Roman">num</font></span><span style="font-family:宋体">值增加</span><span lang="EN-US"><font face="Times New Roman">50</font></span><span style="font-family:宋体">：</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21.75pt"><span lang="EN-US"><font face="Times New Roman">Index.aspx</font></span><span style="font-family:宋体">：</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>    </span><span style="color:blue">&lt;</span><span style="color:maroon">div</span><span style="color:blue">&gt;</span></span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>        </span><span style="color:blue">&lt;</span><span style="color:maroon">asp</span><span style="color:blue">:</span><span style="color:maroon">Button</span> <span style="color:red">ID</span><span style="color:blue">="button1"</span> <span style="color:red">Text</span><span style="color:blue">="</span></span><span style="font-size:9.5pt;color:blue;font-family:宋体">确定</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">"</span><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"> <span style="color:red">runat</span><span style="color:blue">="server"</span> <span style="color:red">OnClick</span><span style="color:blue">="button1_OnClick"</span> <span style="color:blue">/&gt;</span></span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>        </span><span style="color:blue">&lt;</span><span style="color:maroon">asp</span><span style="color:blue">:</span><span style="color:maroon">TextBox</span> <span style="color:red">ID</span><span style="color:blue">="textBox1"</span> <span style="color:red">runat</span><span style="color:blue">="server"</span> <span style="color:blue">/&gt;</span></span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>    </span><span style="color:blue">&lt;/</span><span style="color:maroon">div</span><span style="color:blue">&gt;</span></span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21.75pt"><span lang="EN-US"><font face="Times New Roman">Index.aspx.cs</font></span><span style="font-family:宋体">：</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>        </span><span style="color:blue">protected</span> <span style="color:blue">void</span> button1_OnClick(<span style="color:blue">object</span> sender, <span style="color:#2b91af">EventArgs</span> e) {</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>            </span><span style="color:#2b91af">Global</span>.num += 50;</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>            </span>textBox1.Text = <span style="color:#2b91af">Global</span>.num.ToString();</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>        </span>}</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21.75pt;text-align:left" align="left"><span style="font-family:宋体">同样在</span><span lang="EN-US"><font face="Times New Roman">MainPage.xaml</font></span><span style="font-family:宋体">中添加一个按钮，每次点击时</span><span lang="EN-US"><font face="Times New Roman">num</font></span><span style="font-family:宋体">值也增加</span><span lang="EN-US"><font face="Times New Roman">50</font></span><span style="font-family:宋体">：</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:18pt;text-align:left" align="left"><span lang="EN-US"><font face="Times New Roman">MainPage.xaml:</font></span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;color:#a31515;font-family:NSimSun"><span>    </span></span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">&lt;</span><span lang="EN-US" style="font-size:9.5pt;color:#a31515;font-family:NSimSun">Canvas</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">&gt;</span><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"></span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;color:#a31515;font-family:NSimSun"><span>        </span></span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">&lt;</span><span lang="EN-US" style="font-size:9.5pt;color:#a31515;font-family:NSimSun">Button</span><span lang="EN-US" style="font-size:9.5pt;color:red;font-family:NSimSun"> x</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">:</span><span lang="EN-US" style="font-size:9.5pt;color:red;font-family:NSimSun">Name</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">="button1"</span><span lang="EN-US" style="font-size:9.5pt;color:red;font-family:NSimSun"> Content</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">="</span><span style="font-size:9.5pt;color:blue;font-family:宋体">确定</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">"</span><span lang="EN-US" style="font-size:9.5pt;color:red;font-family:NSimSun"> Click</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">=&quot;button1_Click&quot;/&gt;</span><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"></span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;color:#a31515;font-family:NSimSun"><span>        </span></span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">&lt;</span><span lang="EN-US" style="font-size:9.5pt;color:#a31515;font-family:NSimSun">TextBox</span><span lang="EN-US" style="font-size:9.5pt;color:red;font-family:NSimSun"> x</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">:</span><span lang="EN-US" style="font-size:9.5pt;color:red;font-family:NSimSun">Name</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">="textBox1"</span><span lang="EN-US" style="font-size:9.5pt;color:red;font-family:NSimSun"> Canvas.Left</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">="30"</span><span lang="EN-US" style="font-size:9.5pt;color:red;font-family:NSimSun"> Width</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">=&quot;85&quot; /&gt;</span><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"></span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;color:#a31515;font-family:NSimSun"><span>    </span></span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">&lt;/</span><span lang="EN-US" style="font-size:9.5pt;color:#a31515;font-family:NSimSun">Canvas</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">&gt;</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:18pt;text-align:left" align="left"><span lang="EN-US"><font face="Times New Roman">MainPage.xaml.cs</font></span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>        </span><span style="color:blue">private</span> <span style="color:blue">void</span> Button1_Click(<span style="color:blue">object</span> sender, <span style="color:#2b91af">RoutedEventArgs</span> e) {</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>            </span><span style="color:#2b91af">Global</span>.num += 50;</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>            </span>textBox1.Text = <span style="color:#2b91af">Global</span>.num.ToString();</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>        </span>}</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21.75pt"><span style="font-family:宋体">尝试一：用户</span><span lang="EN-US"><font face="Times New Roman">A</font></span><span style="font-family:宋体">访问</span><span lang="EN-US"><font face="Times New Roman">Index.aspx</font></span><span style="font-family:宋体">页面，点击</span><span lang="EN-US"><font face="Times New Roman">1</font></span><span style="font-family:宋体">次</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">button1</span><span style="font-family:宋体">按钮；接下来用户</span><span lang="EN-US"><font face="Times New Roman">B</font></span><span style="font-family:宋体">也访问该页面，同样也点击</span><span lang="EN-US"><font face="Times New Roman">1</font></span><span style="font-family:宋体">次该按钮；此时用户</span><span lang="EN-US"><font face="Times New Roman">B</font></span><span style="font-family:宋体">电脑中显示的</span><span lang="EN-US"><font face="Times New Roman">num</font></span><span style="font-family:宋体">值是多少？如果用户</span><span lang="EN-US"><font face="Times New Roman">A</font></span><span style="font-family:宋体">接下来又点击了</span><span lang="EN-US"><font face="Times New Roman">1</font></span><span style="font-family:宋体">次该按钮，用户</span><span lang="EN-US"><font face="Times New Roman">A</font></span><span style="font-family:宋体">电脑中的</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">textBox1</span><span style="font-family:宋体">最终显示的</span><span lang="EN-US"><font face="Times New Roman">num</font></span><span style="font-family:宋体">值是多少？</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21.75pt"><span style="font-family:宋体">尝试二：用户</span><span lang="EN-US"><font face="Times New Roman">A</font></span><span style="font-family:宋体">访问</span><span lang="EN-US"><font face="Times New Roman">Index.aspx</font></span><span style="font-family:宋体">页面，点击</span><span lang="EN-US"><font face="Times New Roman">1</font></span><span style="font-family:宋体">次该页面</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">程序</span><span lang="EN-US"><font face="Times New Roman">MainPage</font></span><span style="font-family:宋体">中的</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">button1</span><span style="font-family:宋体">按钮；接下来用户</span><span lang="EN-US"><font face="Times New Roman">B</font></span><span style="font-family:宋体">也访问该页面的</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">程序，并点击</span><span lang="EN-US"><font face="Times New Roman">MainPage</font></span><span style="font-family:宋体">中的该按钮</span><span lang="EN-US"><font face="Times New Roman">1</font></span><span style="font-family:宋体">次，此时用户</span><span lang="EN-US"><font face="Times New Roman">B</font></span><span style="font-family:宋体">电脑中显示的</span><span lang="EN-US"><font face="Times New Roman">num</font></span><span style="font-family:宋体">值是多少？如果用户</span><span lang="EN-US"><font face="Times New Roman">A</font></span><span style="font-family:宋体">之后又点击了</span><span lang="EN-US"><font face="Times New Roman">1</font></span><span style="font-family:宋体">次该按钮，用户</span><span lang="EN-US"><font face="Times New Roman">A</font></span><span style="font-family:宋体">电脑中的</span><span lang="EN-US" style="font-size:9.5pt;color:blue;font-family:NSimSun">textBox1</span><span style="font-family:宋体">最终显示的</span><span lang="EN-US"><font face="Times New Roman">num</font></span><span style="font-family:宋体">值是多少？</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21.75pt"><span style="font-family:宋体">这是非常深刻而有意义的例子，答案是什么？大家不妨自己练习一次。</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21.75pt"><span style="font-family:宋体">到此，如果大家能充分理解服务器端与客户端的区别，那么</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">中的传值就相当好理解了。</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21pt;text-align:left" align="left"><span style="font-family:宋体">在</span><span lang="EN-US"><font face="Times New Roman">ASP.NET</font></span><span style="font-family:宋体">网站开发中，由</span><span lang="EN-US"><font face="Times New Roman">Index1.aspx</font></span><span style="font-family:宋体">跳转到</span><span lang="EN-US"><font face="Times New Roman">Index2.aspx</font></span><span style="font-family:宋体">并传递</span><span lang="EN-US"><font face="Times New Roman">ID</font></span><span style="font-family:宋体">和</span><span lang="EN-US"><font face="Times New Roman">PWD</font></span><span style="font-family:宋体">参数，我们可以在</span><span lang="EN-US"><font face="Times New Roman">Index1.aspx</font></span><span style="font-family:宋体">中通过</span><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun">Response.Redirect(<span style="color:#a31515">&quot;Index2.aspx?ID={0}&amp;PWD={1}&quot;</span>,p1,p2);</span><span style="font-size:9.5pt;font-family:宋体">或</span><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun">Server.Transfer(<span style="color:#a31515">&quot;Index2.aspx……&quot;</span>);</span><span style="font-family:宋体">等方式进行操作。而在</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">应用程序中，由</span><span lang="EN-US"><font face="Times New Roman">MainPage1.xaml</font></span><span style="font-family:宋体">向</span><span lang="EN-US"><font face="Times New Roman">MainPage2.xaml</font></span><span style="font-family:宋体">切换则必须通过一个包含它们的第三者中介容器器类控件比如</span><span lang="EN-US"><font face="Times New Roman">Canvas</font></span><span style="font-family:宋体">或</span><span lang="EN-US"><font face="Times New Roman">Grid</font></span><span style="font-family:宋体">等。因为虽然它们名字中都有个</span><span lang="EN-US"><font face="Times New Roman">Page</font></span><span style="font-family:宋体">，但确切讲它们并不是页面，而本质是用户控件；因此从一个控件向另一个控件传值必须通过属性或构造函数进行传递，且过程中还得移除掉</span><span lang="EN-US"><font face="Times New Roman">MainPage1</font></span><span style="font-family:宋体">后再添加</span><span lang="EN-US"><font face="Times New Roman">MainPage2</font></span><span style="font-family:宋体">。</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21.75pt"><span style="font-family:宋体">按照以上思路，我们首先在</span><span lang="EN-US"><font face="Times New Roman">MainPage2.xaml.cs</font></span><span style="font-family:宋体">中定义好参数的属性或则构造函数参数，例如：</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>        </span><span style="color:blue">public</span> <span style="color:blue">long</span> ID { <span style="color:blue">get</span>; <span style="color:blue">set</span>; }</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>        </span><span style="color:blue">public</span> <span style="color:blue">string</span> PWD { <span style="color:blue">get</span>; <span style="color:blue">set</span>; }</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21.75pt"><span style="font-family:宋体">或者：</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>        </span><span style="color:blue">public</span> MainPage2(<span style="color:blue">long</span> id, <span style="color:blue">string</span> pwd) {</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>            </span>InitializeComponent();</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>        </span>}</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21.75pt"><span style="font-family:宋体">当需要由</span><span lang="EN-US"><font face="Times New Roman">MainPage1</font></span><span style="font-family:宋体">向</span><span lang="EN-US"><font face="Times New Roman">MainPage2</font></span><span style="font-family:宋体">切换时，在</span><span lang="EN-US"><font face="Times New Roman">Canvas</font></span><span style="font-family:宋体">或</span><span lang="EN-US"><font face="Times New Roman">Grid</font></span><span style="font-family:宋体">中我们先移除掉</span><span lang="EN-US"><font face="Times New Roman">MainPage1</font></span><span style="font-family:宋体">实例：</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:19pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun">LayoutRoot.Children.Remove(mainPage1);</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21.75pt"><span style="font-family:宋体">然后携带参数创建</span><span lang="EN-US"><font face="Times New Roman">MainPage2</font></span><span style="font-family:宋体">的实例：</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>     </span><span style="color:#2b91af">MainPage2</span> mainPage2 = <span style="color:blue">new</span> <span style="color:#2b91af">MainPage2</span>() {</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>         </span>ID = p1,</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>         </span>PWD = p2,</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>         </span>...</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"><span>     </span>};</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21.75pt"><span style="font-family:宋体">或者：</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:19pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;color:#2b91af;font-family:NSimSun">MainPage2</span><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"> mainPage2 = <span style="color:blue">new</span> <span style="color:#2b91af">MainPage2</span>(p1, p2,…);</span></p>
<p style="margin:0cm 0cm 0pt"><span lang="EN-US"><span><font face="Times New Roman">   </font></span></span><span style="font-family:宋体">最后将</span><span lang="EN-US"><font face="Times New Roman">mainPage2</font></span><span style="font-family:宋体">添加进</span><span lang="EN-US"><font face="Times New Roman">LayoutRoot</font></span><span style="font-family:宋体">：</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:19pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun">LayoutRoot.Children.add(mainPage2);</span></p>
<p style="margin:0cm 0cm 0pt"><span lang="EN-US"><span><font face="Times New Roman">   </font></span></span><span style="font-family:宋体">到此大家也应该感受到，如果您是初学</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">，并且假如您的大脑中里已经驻扎了较深刻的</span><span lang="EN-US"><font face="Times New Roman">ASP.NET</font></span><span style="font-family:宋体">网站开发的知识经验，那么您必须进行思维的转变才能更快的融入到</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">的开发中。</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21.75pt;text-align:left" align="left"><span style="font-family:宋体">接下来我们不妨再往更深层次的方向探索，</span><span lang="EN-US"><font face="Times New Roman">MainPage</font></span><span style="font-family:宋体">的本质是继承自</span><span lang="EN-US"><font face="Times New Roman">UserControl</font></span><span style="font-family:宋体">的用户控件（</span><span lang="EN-US" style="font-size:9.5pt;color:#2b91af;font-family:NSimSun">MainPage</span><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun"> : <span style="color:#2b91af">UserControl</span></span><span style="font-family:宋体">），那么用户控件的本质又是什么呢？其实不就是类</span><span lang="EN-US"><font face="Times New Roman">(Class)</font></span><span style="font-family:宋体">吗。因此，</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">中传值的本质就是类与类之间的属性值传递，此时我们可以尝试将项目中所有的用户控件都删除掉，然后添加同样名字的类进去，让它们分别也继承自</span><span lang="EN-US" style="font-size:9.5pt;color:#2b91af;font-family:NSimSun">UserControl</span><span style="font-family:宋体">，最后的执行效果一模一样，大家是否已经领悟到什么了？</span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US" style="font-size:9.5pt;color:#2b91af;font-family:NSimSun"><img height="282" alt="" src="http://images.cnblogs.com/cnblogs_com/alamiye010/100617/1.jpg" width="630" border="0"></span></p>
<p style="margin:0cm 0cm 0pt;text-align:left" align="left"><span lang="EN-US"><span><font face="Times New Roman">   </font></span></span><span style="font-family:宋体">没错，在传统的</span><span lang="EN-US"><font face="Times New Roman">ASP.NET</font></span><span style="font-family:宋体">网站开发中，我们是如何创建一个带参数的类的实例的，那么在</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">中的做法也一模一样；仅有的一点区别是</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">中继承自</span><span lang="EN-US" style="font-size:9.5pt;color:#2b91af;font-family:NSimSun">UserControl</span><span style="font-family:宋体">的类拥有一个</span><span lang="EN-US"><font face="Times New Roman">UI</font></span><span style="font-family:宋体">外壳，很形象的为它们冠以</span><span lang="EN-US"><font face="Times New Roman">Page</font></span><span style="font-family:宋体">的名称描述目的是让开发者从</span><span lang="EN-US"><font face="Times New Roman">ASP.NET</font></span><span style="font-family:宋体">网站开发向</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">转型时更加亲切，我们从</span><span lang="EN-US"><font face="Times New Roman">VisualStudio</font></span><span style="font-family:宋体">新建</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">应用程序模板中得到证实。</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21pt;text-align:left" align="left"><span style="font-family:宋体">最后再回到本文的开头，我们通过两种尝试体验了静态变量在服务器端与客户端的不同表现，结果也在意料之中，</span><span lang="EN-US"><font face="Times New Roman">.NET</font></span><span style="font-family:宋体">网站中静态变量存储于服务器的内存中，因此所有用户看到且操作的都是同一个变量对象。而</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">应用程序中的静态变量则存储于用户各自的电脑内存中，也就是说每个用户操作的都是自己电脑中的对象，这样的特性我们是否也可以将之作为</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">传值的媒介呢？</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21pt;text-align:left" align="left"><span style="font-family:宋体">处理时只需</span><span lang="EN-US" style="font-size:9.5pt;color:#2b91af;font-family:NSimSun">Global</span><span lang="EN-US" style="font-size:9.5pt;font-family:NSimSun">.args = value;</span><span style="font-family:宋体">对该全局静态变量进行赋值，然后不论切换到哪个控件，该控件需要参数时直接取用即可。归纳一下：</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">中的静态变量在程序的启动之初就驻扎用户电脑内存，不存在多用户并发，不仅方便，高效，自由；而且无须考虑控件的生命周期，实乃</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">项目开发的万用利器。</span></p>
<p style="margin:0cm 0cm 0pt;text-indent:21pt;text-align:left" align="left"><span style="font-family:宋体">小结：传值仅仅是我们平常开发中会遇到的最常见问题之一，本文通过</span><span lang="EN-US"><font face="Times New Roman">ASP.NET</font></span><span style="font-family:宋体">网页与</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">控件的分析对比，目的旨在告诉大家</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">运行于客户端上，这句话不仅仅是一个定义，而且还深刻蕴涵着</span><span lang="EN-US"><font face="Times New Roman">Silverlight</font></span><span style="font-family:宋体">的原理以及运行机制，知其然且知其所以然在开发中解决各种问题才能更显游刃有余。</span><strong><span lang="EN-US"></span></strong></p>
<div>
<div><img alt="WPF/Silverlight" src="http://silverfuture.cn/MyImages/deep.jpg"></div>
<div>作者：<a href="http://alamiye010.cnblogs.com/">深蓝色右手</a><br>出处：<a href="http://alamiye010.cnblogs.com/">http://alamiye010.cnblogs.com/</a><br>本系列目录及源码下载：<a href="http://www.cnblogs.com/alamiye010/archive/2009/10/03/1577740.html">点击进入</a>(<a href="http://space.cnblogs.com/group/WPF_SL/">欢迎加入WPF/Silverlight小组</a>　<a href="http://wpf_sl.cnblogs.com/">WPF/Silverlight博客团队</a>)<br>本文版权归作者和博客园共有，欢迎转载。但未经作者同意必须保留此段声明，且在文章页面显著位置给出原文连接，否则保留追究法律责任的权利。 </div></div><img src="http://www.cnblogs.com/alamiye010/aggbug/1759611.html?type=1" width="1" height="1" alt=""><p>评论: 8　<a href="http://www.cnblogs.com/alamiye010/archive/2010/06/17/1759611.html#pagedcomment">查看评论</a>　<a href="http://www.cnblogs.com/alamiye010/archive/2010/06/17/1759611.html#commentform">发表评论</a></p><p><a href="http://a4.yeshj.com/rd/35721/">众里寻你千百度，百度期待您的加盟</a></p><hr><p>最新新闻：<br>· <a href="http://news.cnblogs.com/n/66485/">Google员工休息设备EnergyPod曝光</a><span style="color:gray">(2010-06-18 08:26)</span><br>· <a href="http://news.cnblogs.com/n/66484/">百思买因无法按时出货停止接受iPhone 4预订</a><span style="color:gray">(2010-06-18 08:24)</span><br>· <a href="http://news.cnblogs.com/n/66483/">Office2010刚上市 微软已开始开发Office2013</a><span style="color:gray">(2010-06-18 08:24)</span><br>· <a href="http://news.cnblogs.com/n/66482/">Windows VS Apple：手机游戏的未来</a><span style="color:gray">(2010-06-18 08:22)</span><br>· <a href="http://news.cnblogs.com/n/66481/">Twitter的设计原则</a><span style="color:gray">(2010-06-18 08:16)</span><br></p><p>编辑推荐：<a href="http://www.cnblogs.com/miloyip/archive/2010/06/14/Kinematics_ParticleSystem.html">用JavaScript玩转游戏物理：运动学模拟与粒子系统</a><br></p><p>网站导航：<a href="http://www.cnblogs.com">博客园首页</a>  <a href="http://home.cnblogs.com/">个人主页</a>  <a href="http://news.cnblogs.com">新闻</a>  <a href="http://home.cnblogs.com/ing/">闪存</a>  <a href="http://home.cnblogs.com/group/">小组</a>  <a href="http://space.cnblogs.com/q/">博问</a>  <a href="http://space.cnblogs.com">社区</a>  <a href="http://kb.cnblogs.com">知识库</a></p>