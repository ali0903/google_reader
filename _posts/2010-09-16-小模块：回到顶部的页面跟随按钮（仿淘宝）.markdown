---
layout: post
title:  "小模块：回到顶部的页面跟随按钮（仿淘宝）"
date:   2010-09-16 18:13:00
author: BENNY CHIA
categories: program
---

## 小模块：回到顶部的页面跟随按钮（仿淘宝）
### by BENNY CHIA
### at 2010-09-16 18:13:00
### original <http://www.cnblogs.com/bienfantaisie/archive/2010/09/16/1828331.html>

<p><a href="http://www.cnblogs.com/bienfantaisie/"><img src="http://pic.cnblogs.com/face/u73211.png" alt="" border="0"></a><br>作者: <a href="http://www.cnblogs.com/bienfantaisie/">BENNY CHIA</a> 发表于 2010-09-16 18:13 <a href="http://www.cnblogs.com/bienfantaisie/archive/2010/09/16/1828331.html">原文链接</a> 阅读: 955 评论: 9</p><p><img src="http://pic002.cnblogs.com/img/bienfantaisie/201009/2010091618320497.png"></p>
<p>工作中越来越觉得模块化的重要，有些功能提出来更便于今后重用，于是从今天起，工作中写的模块化的东西我会把他们提出来，也方便大家参考学习。现在的技术和前端博客貌似都喜欢在文章前面配个抬头图。那么我以后也配吧，另外我承认今天的头图风格抄自腾讯CDC（这种wp风格的东西怎么巨不搭啊~）。</p>
<p>在工作中经常会做一些巨长无比的页面，这些页面包括产品列表页，或者SNS的好友信息列表等等。当用户将页面向下拉动的时候，用户发现，页面怎么这么长，怎么拉不完呢？化用小饭小说的一句话说“你能把页面写出来，我没理由看不完的啊”。当这个页面高度超过5000px，用户就受不了啦，他被自己1024*768的lcd显示器刺痛了双眼，从而失去了自己当前的focus（焦点），这时候她为了搞清楚自己的focus，就想：“bless me回到页面头部吧！”，按鼠标的手向右寻找，找到了他IE右边的scrollbar。这种事情时常发生。所以很多程序员朋友浏览网页使用键盘的pagedown或者向下按键去翻页。这样他就比较清楚自己的位置。快捷键是上帝赐给人类的礼物，有些人没有这种礼物，于是无所不晓的前端开发者们在曾几何时说了：“要有返回顶部跟随页面滚动的按钮。”于是这种按钮出现了，出现在淘宝的宝贝列表里，出现在SNS好友信息的列表里。</p>
<p> </p>
<p>言归正传，先贴最终效果：</p>
<p><img src="http://pic002.cnblogs.com/img/bienfantaisie/201009/2010091617110246.png"></p>
<p><strong>需求：</strong></p>
<p>1 页面scrollTop为0的时候不显示此按钮，下拉页面后渐显，上拉页面回到页面头部后渐隐，并跟随页面拉动处在页面右边固定位置。</p>
<p>2 网上大多代码都是相对window定位来个fixed，我们的需求不要他fixed，而要相对外层container定位，从而可以紧靠container右端，而不至于调整浏览器宽度时致使此按钮浮动在页面内容之上。</p>
<p>3 兼容所有当前要照顾的浏览器，包括ie6。</p>
<p><strong>需要准备的工具：</strong></p>
<p>电脑一个，jQuery库一个</p>
<p><strong>img素材：</strong></p>
<p><img src="http://pic002.cnblogs.com/img/bienfantaisie/201009/2010091617593134.gif"></p>
<p><strong>先让我们写HTML吧</strong>：</p>
<div>
<pre><div><span style="color:#0000ff">&lt;</span><span style="color:#800000">div </span><span style="color:#ff0000">id</span><span style="color:#0000ff">="container"</span><span style="color:#0000ff">&gt;</span><span style="color:#000000"><br></span><span style="color:#0000ff">&lt;/</span><span style="color:#800000">div</span><span style="color:#0000ff">&gt;</span></div></pre>
</div>
<p><strong>是不是很简单呢，CSS也不是很复杂，.go-top是按钮的容器，absolute的定位是针对他外面的relative的，这个relative会通过js加在id为container的容器上。right:-30px保证这个东西出现在container容器的右端，a的cursor和outline仅作装饰作用，当然你也可以加个background啊什么的，以你觉得好看为准:</strong></p>
<div>
<pre><div><span style="color:#800000">.go-top</span><span style="color:#000000">{</span><span style="color:#ff0000"> width</span><span style="color:#000000">:</span><span style="color:#0000ff">25px</span><span style="color:#000000">;</span><span style="color:#ff0000"> height</span><span style="color:#000000">:</span><span style="color:#0000ff">65px</span><span style="color:#000000">;</span><span style="color:#ff0000"> position</span><span style="color:#000000">:</span><span style="color:#0000ff">absolute</span><span style="color:#000000">;</span><span style="color:#ff0000"> right</span><span style="color:#000000">:</span><span style="color:#0000ff">-30px</span><span style="color:#000000">;</span><span style="color:#000000">}</span><span style="color:#800000"><br>.go-top a</span><span style="color:#000000">{</span><span style="color:#ff0000"> display</span><span style="color:#000000">:</span><span style="color:#0000ff">block</span><span style="color:#000000">;</span><span style="color:#ff0000"> cursor</span><span style="color:#000000">:</span><span style="color:#0000ff">pointer</span><span style="color:#000000">;</span><span style="color:#ff0000"> outline</span><span style="color:#000000">:</span><span style="color:#0000ff">none</span><span style="color:#000000">;</span><span style="color:#000000">}</span></div></pre>
</div>
<p><strong>写JS是关键的部分，主要用到的方法就是个scroll()吧，使用这个东西能够让页面随着你的鼠标滚动而动态改变go-top距页面顶端（准确说是body或html顶端）的距离:</strong></p>
<div><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif"><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif"><span>代码</span>
<div>
<pre><div><span style="color:#000000">$(</span><span style="color:#0000ff">function</span><span style="color:#000000">(){<br>    </span><span style="color:#0000ff">var</span><span style="color:#000000"> topDistance </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#000000">450</span><span style="color:#000000">;</span><span style="color:#008000">//</span><span style="color:#008000">go-top距顶端距离</span><span style="color:#008000"><br></span><span style="color:#000000">    </span><span style="color:#0000ff">var</span><span style="color:#000000"> showDistance </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#000000">1</span><span style="color:#000000">;</span><span style="color:#008000">//</span><span style="color:#008000">距离顶端多少距离开始显示go-top</span><span style="color:#008000"><br></span><span style="color:#000000">    </span><span style="color:#0000ff">var</span><span style="color:#000000"> gotopCon </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#000000">"</span><span style="color:#000000">&lt;div class=&#39;go-top&#39;&gt;&lt;a href=&#39;#&#39;&gt;&lt;img src=&#39;images/gotop.gif&#39; /&gt;&lt;/a&gt;&lt;/div&gt;</span><span style="color:#000000">"</span><span style="color:#000000"><br>    </span><span style="color:#0000ff">var</span><span style="color:#000000"> thisTop </span><span style="color:#000000">=</span><span style="color:#000000"> $(window).scrollTop() </span><span style="color:#000000">+</span><span style="color:#000000"> topDistance;<br>    $(</span><span style="color:#000000">"</span><span style="color:#000000">#container</span><span style="color:#000000">"</span><span style="color:#000000">).css(</span><span style="color:#000000">"</span><span style="color:#000000">position</span><span style="color:#000000">"</span><span style="color:#000000">,</span><span style="color:#000000">"</span><span style="color:#000000">relative</span><span style="color:#000000">"</span><span style="color:#000000">);<br>    $(</span><span style="color:#000000">"</span><span style="color:#000000">#container</span><span style="color:#000000">"</span><span style="color:#000000">).append(gotopCon);<br>    $(</span><span style="color:#000000">"</span><span style="color:#000000">.go-top</span><span style="color:#000000">"</span><span style="color:#000000">).css(</span><span style="color:#000000">"</span><span style="color:#000000">top</span><span style="color:#000000">"</span><span style="color:#000000">,thisTop);<br>    </span><span style="color:#0000ff">if</span><span style="color:#000000">($(window).scrollTop() </span><span style="color:#000000">&lt;</span><span style="color:#000000"> showDistance){<br>        $(</span><span style="color:#000000">"</span><span style="color:#000000">.go-top</span><span style="color:#000000">"</span><span style="color:#000000">).hide();<br>        }<br>    $(window).scroll(</span><span style="color:#0000ff">function</span><span style="color:#000000">(){<br>        thisTop </span><span style="color:#000000">=</span><span style="color:#000000"> $(</span><span style="color:#0000ff">this</span><span style="color:#000000">).scrollTop() </span><span style="color:#000000">+</span><span style="color:#000000"> topDistance;<br>        $(</span><span style="color:#000000">"</span><span style="color:#000000">.go-top</span><span style="color:#000000">"</span><span style="color:#000000">).css(</span><span style="color:#000000">"</span><span style="color:#000000">top</span><span style="color:#000000">"</span><span style="color:#000000">,thisTop);<br>        </span><span style="color:#0000ff">if</span><span style="color:#000000">($(</span><span style="color:#0000ff">this</span><span style="color:#000000">).scrollTop() </span><span style="color:#000000">&lt;</span><span style="color:#000000"> showDistance){<br>            $(</span><span style="color:#000000">"</span><span style="color:#000000">.go-top</span><span style="color:#000000">"</span><span style="color:#000000">).fadeOut(</span><span style="color:#000000">"</span><span style="color:#000000">fast</span><span style="color:#000000">"</span><span style="color:#000000">);<br>            }</span><span style="color:#0000ff">else</span><span style="color:#000000">{<br>                $(</span><span style="color:#000000">"</span><span style="color:#000000">.go-top</span><span style="color:#000000">"</span><span style="color:#000000">).fadeIn(</span><span style="color:#000000">"</span><span style="color:#000000">fast</span><span style="color:#000000">"</span><span style="color:#000000">);<br>                }<br>        });<br>    $(</span><span style="color:#000000">"</span><span style="color:#000000">a</span><span style="color:#000000">"</span><span style="color:#000000">,</span><span style="color:#000000">"</span><span style="color:#000000">.go-top</span><span style="color:#000000">"</span><span style="color:#000000">).click(</span><span style="color:#0000ff">function</span><span style="color:#000000">(){<br>        $(</span><span style="color:#000000">"</span><span style="color:#000000">html</span><span style="color:#000000">"</span><span style="color:#000000">).animate({scrollTop:</span><span style="color:#000000">0</span><span style="color:#000000">},</span><span style="color:#000000">"</span><span style="color:#000000">fast</span><span style="color:#000000">"</span><span style="color:#000000">);</span><span style="color:#008000">//</span><span style="color:#008000">IE,FF</span><span style="color:#008000"><br></span><span style="color:#000000">        $(</span><span style="color:#000000">"</span><span style="color:#000000">body</span><span style="color:#000000">"</span><span style="color:#000000">).animate({scrollTop:</span><span style="color:#000000">0</span><span style="color:#000000">},</span><span style="color:#000000">"</span><span style="color:#000000">fast</span><span style="color:#000000">"</span><span style="color:#000000">);</span><span style="color:#008000">//</span><span style="color:#008000">Webkit</span><span style="color:#008000"><br></span><span style="color:#000000">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> </span><span style="color:#0000ff">false</span><span style="color:#000000">;<br>        });<br>    });</span></div></pre>
</div>
</div>
<p> </p>
<p>好了，今天的课上到这里，有问题的同学下课留下来问问题，其他同学出去玩去吧。</p><img src="http://www.cnblogs.com/bienfantaisie/aggbug/1828331.html?type=1" width="1" height="1" alt=""><p>评论: 9　<a href="http://www.cnblogs.com/bienfantaisie/archive/2010/09/16/1828331.html#pagedcomment">查看评论</a>　<a href="http://www.cnblogs.com/bienfantaisie/archive/2010/09/16/1828331.html#commentform">发表评论</a></p><p><a href="http://job.cnblogs.com/">程序员找工作，就在博客园</a></p><hr><p>最新新闻：<br>· <a href="http://news.cnblogs.com/n/74616/">乔布斯纪念日：苹果公司的iCEO</a><span style="color:gray">(2010-09-17 13:02)</span><br>· <a href="http://news.cnblogs.com/n/74612/">黑客正准备发布iOS 4.1永久越狱程序</a><span style="color:gray">(2010-09-17 11:49)</span><br>· <a href="http://news.cnblogs.com/n/74610/">世界首款MeeGo Tablet解密</a><span style="color:gray">(2010-09-17 11:46)</span><br>· <a href="http://news.cnblogs.com/n/74611/">互联网/移动互联网小团队如何白手起家创业</a><span style="color:gray">(2010-09-17 11:44)</span><br>· <a href="http://news.cnblogs.com/n/74609/">Google重新推出Instantiations的开发工具 — 现在全部免费</a><span style="color:gray">(2010-09-17 11:32)</span><br></p><p>编辑推荐：<a href="http://news.cnblogs.com/n/74574/">Google声称Chrome7浏览器将提速60倍</a><br></p><p>网站导航：<a href="http://www.cnblogs.com">博客园首页</a>  <a href="http://home.cnblogs.com/">个人主页</a>  <a href="http://news.cnblogs.com">新闻</a>  <a href="http://home.cnblogs.com/ing/">闪存</a>  <a href="http://home.cnblogs.com/group/">小组</a>  <a href="http://space.cnblogs.com/q/">博问</a>  <a href="http://space.cnblogs.com">社区</a>  <a href="http://kb.cnblogs.com">知识库</a></p>