<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>[javascript]mouseenter/mouseleave</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/">Your New Jekyll Site</a></h1>
              <a class="extra" href="/">home</a>
            </div>

                <h2>[javascript]mouseenter/mouseleave</h2>
<p class="meta">13 Mar 2012</p>

<div class="post">
<h2>[javascript]mouseenter/mouseleave</h2>

<h3>by 小玉西瓜</h3>

<h3>at 2012-03-13 15:34:00</h3>

<h3>original <a href="http://www.cnblogs.com/enix/archive/2012/03/13/2393930.html">http://www.cnblogs.com/enix/archive/2012/03/13/2393930.html</a></h3>

<p> </p>


<p>事件委托的概念大家都很清楚，如果在某个元素上使用<span style="font-family:&#39;Times New Roman&#39;">mouseover/mouseout</span><span style="font-family:宋体">的话，很有可能就被动的委托了这个事件。该元素中的子元素都会触发</span><span style="font-family:&#39;Times New Roman&#39;">mouseover/mouseout </span><span style="font-family:宋体">而且无法通过停止冒泡来处理这个烦人的意外情况。</span></p>


<p>在<span style="font-family:&#39;Times New Roman&#39;">ie</span><span style="font-family:宋体">上有两个非常好的事件</span><span style="font-family:&#39;Times New Roman&#39;">,mouseenter/mouseleave</span><span style="font-family:宋体">他们不会冒泡,当然不会产生这个问题。新版本的</span><span style="font-family:&#39;Times New Roman&#39;">ff10 opera11</span><span style="font-family:宋体">都有支持这个事件。遗憾的是</span><span style="font-family:&#39;Times New Roman&#39;">chrome19</span><span style="font-family:宋体">还没有支持。 流行的类库比如</span><span style="font-family:&#39;Times New Roman&#39;">jquery</span><span style="font-family:宋体">已经支持这个事件了。对于不支持这两个事件的浏览器必须自己处理了。</span></p>


<p>通过处理<span style="font-family:&#39;Times New Roman&#39;">mouseover/mouseout</span><span style="font-family:宋体">也可以达到</span><span style="font-family:&#39;Times New Roman&#39;">mouseenter/mouseleave</span><span style="font-family:宋体">同样的目的。这个关键点在于我们判断</span><span style="font-family:&#39;Times New Roman&#39;">mouseover/mouseout</span><span style="font-family:宋体">元素和事件监听的元素的关系，如果是包含关系就不执行操作。</span></p>


<p>我们通过事件函数得到<span style="font-family:&#39;Times New Roman&#39;">event</span><span style="font-family:宋体">对象，通过</span><span style="font-family:&#39;Times New Roman&#39;">event</span><span style="font-family:宋体">的相关属性来确定元素的关系。</span></p>


<p> </p>


<div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px">elem.onmouseover=function(e){<br>      var e=window.event || e, target= e.currentTarget,related= e.relatedTarget || e.formElement;<br>}<br></div>


<p>用<span style="font-family:&#39;Times New Roman&#39;">currentTarget</span><span style="font-family:宋体">可以获得</span>事件的目标节点，<span style="font-family:&#39;Times New Roman&#39;">relatedTarget </span><span style="font-family:宋体">可以获得</span>事件的目标节点相关的节点。ie<span style="font-family:宋体">的话是</span>formElement/toElement<span style="font-family:宋体">从字面意思也很好理解从那个节点来的</span><span style="font-family:&#39;Times New Roman&#39;">/</span><span style="font-family:宋体">到达那个节点。</span>所有相关节点都已经获得，这样我们只要比较他们的关系是不是包含的。<span style="font-family:&#39;Times New Roman&#39;">Dom</span><span style="font-family:宋体">也提供了相关的方法，非</span><span style="font-family:&#39;Times New Roman&#39;">ie</span><span style="font-family:宋体">的用</span><span style="font-family:&#39;Times New Roman&#39;">compareDocumentPosition</span><span style="font-family:宋体">这个有很多值一时比较难说的清，</span><span style="font-family:&#39;Times New Roman&#39;">ie</span><span style="font-family:宋体">的是</span><span style="font-family:&#39;Times New Roman&#39;">contains </span><span style="font-family:宋体">只会得到</span><span style="font-family:&#39;Times New Roman&#39;">true</span><span style="font-family:宋体">或者</span><span style="font-family:&#39;Times New Roman&#39;">false</span><span style="font-family:宋体">。<strong>（关于这个方法</strong></span><strong><span style="font-family:&#39;Times New Roman&#39;">ppk </span><span style="font-family:宋体">和</span><span style="font-family:&#39;Times New Roman&#39;">john resing</span><span style="font-family:宋体">都有比较优雅的封装，有兴趣可以搜索一下）。</span></strong></p>


<p>我使用的是这个版本</p>


<div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px"><p>function contains (a,b){<br>    try {return a.contains ? a != b &amp;&amp; a.contains(b) : !!(a.compareDocumentPosition(b)&amp;16)}catch(e){};<br> };</p></div>


<p></p>


<div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px">elem.onmouseover=function(e){var e=window.event || e, target= e.currentTarget,related= e.relatedTarget || e.formElement;//注意这里if(!contains(target, related) &amp;&amp; target!==related){　//执行代码}　}elem.onmouseout=function(e){var e=window.event || e, target= e.currentTarget,related= e.relatedTarget || e.toElement;//注意这里if(!contains(target, related) &amp;&amp; target!==related){　//执行代码}　}</div>


<p> </p>


<p>听同事说是用鼠标范围来确定是不是包含关系，相比这个也是一个不错的方案有兴趣可以实现一下。</p>


<p> </p>


<p>相关资料见</p>


<p>ppk   <a href="http://www.quirksmode.org/js/events_mouse.html">http://www.quirksmode.org/js/events_mouse.html</a></p>


<p>mdn  <a href="https://developer.mozilla.org/en/DOM/DOM_event_reference/mouseleave">https://developer.mozilla.org/en/DOM/DOM_event_reference/mouseleave</a></p>


<p>john resig <a href="http://ejohn.org/blog/comparing-document-position/">http://ejohn.org/blog/comparing-document-position/</a></p>


<p></p>


<p><img src="http://www.cnblogs.com/enix/aggbug/2393930.html?type=1" width="1" height="1" alt=""><p><a href="http://www.cnblogs.com/enix/archive/2012/03/13/2393930.html">本文链接</a></p></p>

</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/yourusername/">github.com/yourusername</a><br />
                  <a href="http://twitter.com/yourusername/">twitter.com/yourusername</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
