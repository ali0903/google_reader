<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>node.js-v0.8API解读（2）- api的修改部分</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/">Your New Jekyll Site</a></h1>
              <a class="extra" href="/">home</a>
            </div>

                <h2>node.js-v0.8API解读（2）- api的修改部分</h2>
<p class="meta">03 Jul 2012</p>

<div class="post">
<h2>node.js-v0.8API解读（2）- api的修改部分</h2>

<h3>by snoopyxdy</h3>

<h3>at 2012-07-02 16:02:22</h3>

<h3>original <a href="http://snoopyxdy.blog.163.com/blog/static/601174402012528111035908">http://snoopyxdy.blog.163.com/blog/static/601174402012528111035908</a></h3>

<div><div>0.8版本修改了不少api，以下是一些常用的api修改，大家注意哦：</div><div>以下是主要常用的api变更</div><div><br></div><div><b><i>1、path</i></b><br>path.{exists,existsSync} was moved to fs.{exists,existsSync}</div>很早就觉得path.exists应该归纳到fs模块中<div><br></div><div><i><b>2、cluster</b></i></div><div><div>cluster.fork() no longer return a child_process.fork() object use cluster.fork().process to get the object.</div><div>返回子进程的process对象需要使用：cluster.fork().process</div><div><br></div><div>the 'death' event on the cluster object is renamed to 'exit'.</div><div>cluster的death事件改名为exit</div><div><br></div><div>the kill() method is renamed to destroy().</div><div>cluster的kill方法改名为destory</div><div><br></div><div>the CLUSTER_WORKER_ID env is now called CLUSTER_UNIQUE_ID, but you should not have used that anyway.</div><div>不建议使用CLUSTER_WORKER_ID 这个环境变量</div><div><br></div><div>workers now kill themselves when they accidentally lose their connection to the master.</div></div><div>子进程会自杀，当他们偶然失去去与主进程的通信</div><div><i><b><br></b></i></div><div><i><b>3、http</b></i></div><div><div>http.Server emits 'connect' event instead of 'upgrade' when the CONNECT method is requested.</div><div>当连接被请求时，connect 事件会代替 upgrade 事件</div><div><br></div><div>http.ServerResponse sends Date: header by default. You can disable it by setting response.sendDate to false.</div><div>http的响应头会自动加上Date这个值，想要关掉它可以将 response.sendDate 设置为false</div><div><br></div><div>http.ClientRequest emits 'connect' event instead of 'request' when the CONNECT method is responded.</div></div><div>当node.js作为客户端去请求其他http服务器时，当对方响应，将会触发connect事件来代替request事件</div><div><br></div><div><b><i>4、net</i></b></div><div>net.listen(socketPath) no longer unlinks the socket unless you call server.close(). Automatic unlinking was subject to race conditions in multi-process setups. Also applies to http.listen(socketPath).</div><div>net.listen(socketPath)方法不会去断开socket，直到server.close()方法调用才会断开。自动断开的情况是多个进程竞争条件，同样适用于http.listen(socketPath).方法。</div><div><br></div><div><b><i>5、child_process</i></b></div><div><div>arguments and options arguments of child_process.fork() became an option.//修改了fork的api，详细见doc</div><div>the 'exit' event is now emitted right after the child process exits. It no longer waits for all stdio pipes to be closed.</div><div>//现在exit事件会等到进程退出后再出发，但是不会等待stdio pipes关闭</div><div>the 'close' event was added that has is emitted after the child has exited and all the stdio pipes are closed.</div></div><div>//同上，但是会等到stdio 管道关触发</div><div><br></div><div><b><i>6、url</i></b></div><div>url.parse() now parses IPv6 addresses. //支持IPv6的地址</div><div><div>url.parse() now escapes delimiters characters rather than truncating the input.//这句不是很理解</div><div>url.format() now escapes the auth section, and url.parse() decodes it.</div></div><div>//可以加入auth的片段支持</div><div><br></div><div><b><i>7、fs</i></b></div><div>path.exists() and path.existsSync() has moved to fs.exists() and fs.existsSync().</div><div>//以后查找文件是否存在改用fs.exists()方法了</div><div>fs.symlink type argument can now be 'junction' (for Windows only).</div><div>//junction是windows特有的，属于磁盘映射的工具，比如我们C盘容量过大了，于是我们把文件夹X（假设X有10个G）拷贝到D盘，然后使用junction工具将文件夹X映射回C盘，这样从C盘看访问路径还是C:/xxxx，也可以对其进行正常的修改删除，但是空间占用的是D盘的</div><div>fs.realpath and fs.lstat work the same on Windows as on Unix</div><div>//fs.realpath和fs.lstat在unix和windows上运行时一样了</div><div><br></div><div><b><i>8、console</i></b></div><div>console.timeEnd now throws when there's no such label</div><div>没有 label 时输出当前时间戳</div><div><br></div><div><i><b>9、os</b></i></div><div><div>os.cpus().times is now supported on Windows</div><div>os.uptime now displays the correct uptime if the system&#39;s current uptime is &gt; 50 days on Windows</div></div><div>//这里主要是windows的支持问题</div></div>


</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/yourusername/">github.com/yourusername</a><br />
                  <a href="http://twitter.com/yourusername/">twitter.com/yourusername</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
