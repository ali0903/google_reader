<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>【外刊IT评论网】命令，不要去询问(Tell, Don’t Ask)</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/">Your New Jekyll Site</a></h1>
              <a class="extra" href="/">home</a>
            </div>

                <h2>【外刊IT评论网】命令，不要去询问(Tell, Don’t Ask)</h2>
<p class="meta">02 Aug 2012</p>

<div class="post">
<h2>【外刊IT评论网】命令，不要去询问(Tell, Don’t Ask)</h2>

<h3>by Aqee</h3>

<h3>at 2012-08-02 00:07:35</h3>

<h3>original <a href="http://aqee.feedsportal.com/c/34519/f/631690/s/21f122ab/l/0L0Saqee0Bnet0Ctell0Edont0Eask0C/story01.htm">http://aqee.feedsportal.com/c/34519/f/631690/s/21f122ab/l/0L0Saqee0Bnet0Ctell0Edont0Eask0C/story01.htm</a></h3>

<p><br><p>前些时间我曾经翻译过一篇叫做《<a href="http://www.aqee.net/i-give-the-orders-around-here/">这里我说了算！</a>》的文章，里面作者讲述了关于“命令，不要去询问(Tell, Don’t Ask)”原则：</p> <blockquote><p>我看到的最多被违反的原则是“命令，不要去询问(Tell, Don’t Ask)”原则。这个原则讲的是，一个对象应该命令其它对象该做什么，而不是去查询其它对象的状态来决定做什么(查询其它对象的状态来决定做什么也被称作‘功能嫉妒（Feature Envy）’)。</p></blockquote> <p>这篇文章里有个很生动的例子，我至今记忆犹新：</p> <blockquote><p>if (person.getAddress().getCountry() == “Australia”) {</p> <p>这违反了得墨忒耳定律，因为这个调用者跟Person过于亲密。它知道Person里有一个Address，而Address里还有一个country。它实际上应该写成这样：</p> <p>if (person.livesIn(“Australia”)) {</p></blockquote> <p>非常的明了。今天我又看到一个关于“Tell, Don’t Ask”原则的文章，里面提供了4个关于这个原则的例子，都很有价值。</p> <h2>例一</h2> <p>不好：</p> <pre>&lt;% if current_user.admin? %&gt; &lt;%= current_user.admin_welcome_message %&gt; &lt;% else %&gt; &lt;%= current_user.user_welcome_message %&gt; &lt;% end %&gt;</pre> <p>好：</p> <pre><code>&lt;%= current_user.welcome_message %&gt;</code></pre> <h2>例二</h2> <p>不好：</p> <pre>def check_for_overheating(system_monitor) if system_monitor.temperature &gt; 100 system_monitor.sound_alarms end end</pre> <p>好：</p> <pre>system_monitor.check_for_overheating class SystemMonitor def check_for_overheating if temperature &gt; 100 sound_alarms end end end</pre> <h2>例三</h2> <p>不好：</p> <pre>class Post def send_to_feed if user.is_a?(TwitterUser) user.send_to_feed(contents) end end end</pre> <p>好：</p> <pre>class Post def send_to_feed user.send_to_feed(contents) end end class TwitterUser def send_to_feed(contents) twitter_client.post_to_feed(contents) end end class EmailUser def send_to_feed(contents) # no-op. end end</pre> <h2>例四</h2> <p>不好：</p> <pre>def street_name(user) if user.address user.address.street_name else 'No street name on file' end end</pre> <p>好：</p> <pre>def street_name(user) user.address.street_name end class User def address @address || NullAddress.new end end class NullAddress def street_name 'No street name on file' end end</pre> <p>好的面向对象编程是告诉对象你要做什么，而不是询问对象的状态后根据状态做行动。数据和依赖这些数据的操作都应该属于同一个对象。</p> <p>命令，不要去询问！</p> <hr>本文来自<a href="http://www.aqee.net">外刊IT评论网</a>(<a href="http://www.aqee.net">www.aqee.net</a>)，原始地址：<a href="http://www.aqee.net/tell-dont-ask/" rel="bookmark">命令，不要去询问(Tell, Don’t Ask)</a><br><img width="1" height="1" src="http://aqee.feedsportal.com/c/34519/f/631690/s/21f122ab/mf.gif" border="0"><div><table border="0"><tr><td valign="middle"><a href="http://share.feedsportal.com/viral/sendEmail.cfm?lang=en&amp;title=%E3%80%90%E5%A4%96%E5%88%8AIT%E8%AF%84%E8%AE%BA%E7%BD%91%E3%80%91%E5%91%BD%E4%BB%A4%EF%BC%8C%E4%B8%8D%E8%A6%81%E5%8E%BB%E8%AF%A2%E9%97%AE%28Tell%2C+Don%E2%80%99t+Ask%29&amp;link=http%3A%2F%2Fwww.aqee.net%2Ftell-dont-ask%2F"><img src="http://res3.feedsportal.com/images/emailthis2.gif" border="0"></a></td><td valign="middle"><a href="http://res.feedsportal.com/viral/bookmark.cfm?title=%E3%80%90%E5%A4%96%E5%88%8AIT%E8%AF%84%E8%AE%BA%E7%BD%91%E3%80%91%E5%91%BD%E4%BB%A4%EF%BC%8C%E4%B8%8D%E8%A6%81%E5%8E%BB%E8%AF%A2%E9%97%AE%28Tell%2C+Don%E2%80%99t+Ask%29&amp;link=http%3A%2F%2Fwww.aqee.net%2Ftell-dont-ask%2F"><img src="http://res3.feedsportal.com/images/bookmark.gif" border="0"></a></td></tr></table></div><br><br><a href="http://da.feedsportal.com/r/139262784477/u/0/f/631690/c/34519/s/21f122ab/a2.htm"><img src="http://da.feedsportal.com/r/139262784477/u/0/f/631690/c/34519/s/21f122ab/a2.img" border="0"></a><img width="1" height="1" src="http://pi.feedsportal.com/r/139262784477/u/0/f/631690/c/34519/s/21f122ab/a2t.img" border="0"><img src="http://www1.feedsky.com/t1/666651079/aqee-net/feedsky/s.gif?r=http://aqee.feedsportal.com/c/34519/f/631690/s/21f122ab/l/0L0Saqee0Bnet0Ctell0Edont0Eask0C/story01.htm" border="0" height="0" width="0"></p>

</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/yourusername/">github.com/yourusername</a><br />
                  <a href="http://twitter.com/yourusername/">twitter.com/yourusername</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
