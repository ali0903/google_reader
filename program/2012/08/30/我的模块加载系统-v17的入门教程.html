<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>我的模块加载系统 v17的入门教程</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/google_reader/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/google_reader/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/google_reader/">Google Reader</a></h1>
              <a class="extra" href="/google_reader/">home</a>
            </div>

                <h2>我的模块加载系统 v17的入门教程</h2>
<p class="meta">2012-08-30 19:22</p>

<div class="post">
<h2>我的模块加载系统 v17的入门教程</h2>

<h3>by 司徒正美</h3>

<h3>at 2012-08-30 11:22:00</h3>

<h3>original <a href="http://www.cnblogs.com/rubylouvre/archive/2012/08/30/2663198.html">http://www.cnblogs.com/rubylouvre/archive/2012/08/30/2663198.html</a></h3>

<p>听说有人不用，就写个简单的教程吧。</p>


<p>先把<a href="https://github.com/RubyLouvre/mass-Framework/blob/master/mass.js">mass.js</a>下载回来。</p>


<p>然后建立一个HTML页面，index.html,内容为</p>


<pre>&lt;!DOCTYPE HTML&gt;&lt;html&gt;    &lt;head&gt;        &lt;title&gt;AMD&lt;/title&gt;        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;        &lt;script src=&quot;mass.js&quot;&gt;        &lt;/script&gt;&lt;script&gt;           $.log(&quot;测试是否加载成功&quot;)        &lt;/script&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;h2&gt;欢迎加入mass Framework团队！&lt;/h2&gt;          &lt;/body&gt;&lt;/html&gt;</pre>


<p>这样index.html就能正确引用mass.js</p>


<p>我们再用firefox中打开此页面，在firebug下就把看到日志打印，说明加载成功！</p>


<div><img src="http://images.cnblogs.com/cnblogs_com/rubylouvre/205314/o_amd_check.jpg"></div>


<p>然后我们建立一个新JS文件，放到同一目录，叫hello.js。那理所当然，这模块名为hello，当然你可以改别的，最好文件名与模块名一致。</p>


<pre>define("hello", function(){    var helloMass = function(){        alert("hello mass!")    }    var helloAMD = function(){        alert("hello AMD!")    }    var helloWorld = function(){        alert("hello world!")    }    return {        helloMass: helloMass,        helloAMD: helloAMD,        helloWorld: helloWorld    }});</pre>


<p>然后我们修改index.html</p>


<pre>&lt;!DOCTYPE HTML&gt;&lt;html&gt;    &lt;head&gt;        &lt;title&gt;AMD&lt;/title&gt;        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;        &lt;script src=&quot;mass.js&quot;&gt;        &lt;/script&gt;&lt;script&gt;           $.require(&quot;./hello&quot;, function(obj){      obj.helloWorld();  obj.helloAMD()  obj.helloMass()   })        &lt;/script&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;h2&gt;欢迎加入mass Framework团队！&lt;/h2&gt;     &lt;/body&gt;&lt;/html&gt;</pre>


<p>然后你再用IE，FF或chrome打开，就会看到弹出三个alert了。</p>


<p>这里稍微说一下怎么调用模块吧。require有两个参数，第一个是字符串，表示要调用的模块，第二个是回调函数。比如我要调用aaa.js文件，而aaa.js与mass.js是位于同一目录下，那么这样调用。</p>


<pre>$.require("./aaa", function(){   });</pre>


<p>当然你也可以，".js"后缀不是必需的。</p>


<pre>$.require("./aaa.js", function(){   });</pre>


<p><strong>"./"</strong>表示在当前目录查找。</p>


<p>如果我要依赖两个模块，aaa.js, bbb.js，并且它们都与mass.js在同一目录下吧。</p>


<pre>$.require("./aaa,./bbb", function(a, b){    alert(a+b)//3});</pre>


<p>aaa.js,bbb.js的内容很简单</p>


<pre>//aaa.jsdefine("aaa", function(){   return 1});</pre>


<pre>//bbb.jsdefine("bbb", function(){   return 1});</pre>


<p>于是页面改成这样：</p>


<pre>&lt;!DOCTYPE HTML&gt;&lt;html&gt;    &lt;head&gt;        &lt;title&gt;AMD&lt;/title&gt;        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;        &lt;script src=&quot;mass.js&quot;&gt;        &lt;/script&gt;&lt;script&gt;           $.require(&quot;./aaa,./bbb&quot;, function(a,b){      alert(a+b)   })        &lt;/script&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;h2&gt;欢迎加入mass Framework团队！&lt;/h2&gt;     &lt;/body&gt;&lt;/html&gt;</pre>


<div><img src="http://images.cnblogs.com/cnblogs_com/rubylouvre/205314/o_amd_ccc.jpg"></div>


<p>好了，我们再看一下模块间的依赖。每个模块应该自行处理依赖。现在有一个ccc.js，它与mass.js也位于同一目录下，它依赖于上面的aaa.js.</p>


<pre>//ccc.jsdefine("ccc",["./aaa"], function(a){// ./表示aaa与ccc是同一目录   return a + 10});</pre>


<p>那么我们在页面调用ccc模块时,就不用于是会aaa.js,它自行会加载aaa模块的.</p>


<pre>&lt;!DOCTYPE HTML&gt;&lt;html&gt;    &lt;head&gt;        &lt;title&gt;AMD&lt;/title&gt;        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;        &lt;script src=&quot;mass.js&quot;&gt;        &lt;/script&gt;&lt;script&gt;           $.require(&quot;./ccc&quot;, function(c){     alert(c)           })        &lt;/script&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;h2&gt;欢迎加入mass Framework团队！&lt;/h2&gt;     &lt;/body&gt;&lt;/html&gt;</pre>


<div><img src="http://images.cnblogs.com/cnblogs_com/rubylouvre/205314/o_amd_deps.jpg"></div>


<p>好了，我们再看一下引用其他目录的js文件是怎么用的。在mass.js的目录下建立一个ddd文件夹，然后里面再建立一个ddd.js文件，ddd模块依赖于ccc模块。</p>


<pre>//ddd.jsdefine("ddd",["../ccc"], function(c){// ../表示在上一级目录中查找，会点编程的人都懂吧。很普通的常识，不需要学太多东西。   return c+100});</pre>


<p>然后我在页面上这样引用它们。</p>


<pre>&lt;!DOCTYPE HTML&gt;&lt;html&gt;    &lt;head&gt;        &lt;title&gt;AMD&gt;/title&gt;        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;        &lt;script src=&quot;mass.js&quot;&gt;        &lt;/script&gt;&lt;script&gt;           $.require(&quot;./ddd/ddd&quot;, function(d){//在当前目录中ddd目录找ddd文件      alert(d)   })        &lt;/script&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;h2&gt;欢迎加入mass Framework团队！&gt;/h2&gt;     &lt;/body&gt;&lt;/html&gt;</pre>


<div><img src="http://images.cnblogs.com/cnblogs_com/rubylouvre/205314/o_amd_ddd.jpg"></div>


<p>我们再来看远程文件的调用，肯定所有资源不是放在同一服务器上。比如我有一个模块是放在<em>http://files.cnblogs.com/rubylouvre/20120830__amd.js</em>中</p>


<p>里面的内容为</p>


<pre>//20120830_amd.jsdefine("remote",function(){   return {     name:"这是一个远程文件",     address:"位于cnblog的服务器上"  }})</pre>


<p>然后调用时就直接输入这个URL</p>


<pre>&lt;!DOCTYPE HTML&gt;&lt;html&gt;    &lt;head&gt;        &lt;title&gt;AMD&lt;/title&gt;        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;        &lt;script src=&quot;mass.js&quot;&gt;        &lt;/script&gt;&lt;script&gt;           $.require(&quot;http://files.cnblogs.com/rubylouvre/20120830__amd.js&quot;, function(obj){      alert(obj.address)   })        &lt;/script&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;h2&gt;欢迎加入mass Framework团队！&lt;/h2&gt;     &lt;/body&gt;&lt;/html&gt;</pre>


<div><img src="http://images.cnblogs.com/cnblogs_com/rubylouvre/205314/o_amd_remote.jpg"></div>


<p>全文完，如果你想了解一下怎么加载jQuery，可以看一下老外的文章，毕竟AMD现范在国外很普及了，可以搜到的。或者等我下一篇教程。</p>


<p><img src="http://www.cnblogs.com/rubylouvre/aggbug/2663198.html?type=1" width="1" height="1" alt=""><p><a href="http://www.cnblogs.com/rubylouvre/archive/2012/08/30/2663198.html">本文链接</a></p></p>

</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/lyuehh/">github.com/lyuehh</a><br />
                  <a href="http://twitter.com/lyuehh/">twitter.com/lyuehh</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
