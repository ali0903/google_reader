<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>JavaScript中的属性:如何遍历属性</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/google_reader/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/google_reader/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/google_reader/">Google Reader</a></h1>
              <a class="extra" href="/google_reader/">home</a>
            </div>

                <h2>JavaScript中的属性:如何遍历属性</h2>
<p class="meta">2012-11-04 04:37</p>

<div class="post">
<h2>JavaScript中的属性:如何遍历属性</h2>

<h3>by 紫云飞</h3>

<h3>at 2012-11-03 20:37:00</h3>

<h3>original <a href="http://www.cnblogs.com/ziyunfei/archive/2012/11/03/2752905.html">http://www.cnblogs.com/ziyunfei/archive/2012/11/03/2752905.html</a></h3>

<p>在JavaScript中,遍历一个对象的属性往往没有在其他语言中遍历一个哈希(有些语言称为字典)的键那么简单.这主要有两个方面的原因:一个是,JavaScript中的对象通常都处在某个原型链中,它会从一个或多个的上层原型上继承一些属性.第二个原因是,JavaScript中的属性不光有值,它还有一些除了值以外的其他特性,其中一个影响属性遍历的特性就是[[Enumerable]],如果该值为true,则称这个属性是可枚举的,否则反之.</p>


<p>知道了这些,我们就可以把属性的遍历分为四种情况.</p>


<p>注:示例代码中,我们要遍历的对象是浏览器中的window,环境为Firefox 19,代码运行在空白页面中的script标签里.没有Firebug或者其他调试工具的影响(会导入一些全局变量,console等).</p>


<p><strong>1.遍历可枚举的自身属性</strong></p>


<p>可枚举的意思就是该属性的[[Enumerable]]特性为true,自身属性的意思就是该属性不是从原型链上继承下来的.</p>


<div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px">(<span style="color:#0000ff">function</span><span style="color:#000000"> () {<br>    </span><span style="color:#0000ff">var</span> propertys =<span style="color:#000000"> Object.keys(window);<br>    alert(propertys.length);         </span><span style="color:#008000">//</span><span style="color:#008000">3<br></span>    alert(propertys.join("\n"));     <span style="color:#008000">//</span><span style="color:#008000">window,document,InstallTrigger,除了最后一个是火狐私有的属性,原来window对象只有两个可枚举的自身属性.window属性指向window对象自身,一般没什么用.</span><br>})()</div>


<p><strong>2.遍历所有的自身属性</strong></p>


<p>特性为不可枚举的属性也并不是遍历不到,ES5给我们提供了<span style="color:#000000">getOwnPropertyNames</span>方法,可以获取到一个对象的所有自身属性.</p>


<div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px">(<span style="color:#0000ff">function</span><span style="color:#000000"> () {<br>    </span><span style="color:#0000ff">var</span> propertys =<span style="color:#000000"> Object.getOwnPropertyNames(window);<br>    alert(propertys.length);       </span><span style="color:#008000">//</span><span style="color:#008000">72</span><br>    alert(propertys.join("\n"));   <span style="color:#008000">//</span><span style="color:#008000">Object,Function,eval等等</span><br>})()</div>


<p><strong>3.遍历可枚举的自身属性和继承属性</strong></p>


<p>继承属性怎么遍历,你应该知道,就是最常用的for in遍历</p>


<div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px">(<span style="color:#0000ff">function</span><span style="color:#000000"> () {<br>    </span><span style="color:#0000ff">var</span> getEnumPropertyNames = <span style="color:#0000ff">function</span><span style="color:#000000"> (obj) {<br>        </span><span style="color:#0000ff">var</span> props =<span style="color:#000000"> [];<br>        </span><span style="color:#0000ff">for</span> (prop <span style="color:#0000ff">in</span><span style="color:#000000"> obj) {<br>            props.push(prop);<br>        }<br>        </span><span style="color:#0000ff">return</span><span style="color:#000000"> props;<br>    }<br>    </span><span style="color:#0000ff">var</span> propertys =<span style="color:#000000"> getEnumPropertyNames(window);<br>    alert(propertys.length);       </span><span style="color:#008000">//</span><span style="color:#008000">185</span><br>    alert(propertys.join("\n"));   <span style="color:#008000">//</span><span style="color:#008000">addEventListener,onload等等</span><br>})()</div>


<p><strong>4.遍历所有的自身属性和继承属性</strong></p>


<p>这种遍历主要用在各种js调试工具的代码补全功能上.比如Firebug的.</p>


<div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px">(<span style="color:#0000ff">function</span><span style="color:#000000"> () {<br>    </span><span style="color:#0000ff">var</span> getAllPropertyNames = <span style="color:#0000ff">function</span><span style="color:#000000"> (obj) {<br>        </span><span style="color:#0000ff">var</span> props =<span style="color:#000000"> [];<br>        </span><span style="color:#0000ff">do</span><span style="color:#000000"> {<br>            props </span>=<span style="color:#000000"> props.concat(Object.getOwnPropertyNames(obj));<br>        } </span><span style="color:#0000ff">while</span> (obj =<span style="color:#000000"> Object.getPrototypeOf(obj));<br>        </span><span style="color:#0000ff">return</span><span style="color:#000000"> props;<br>    }<br>    </span><span style="color:#0000ff">var</span> propertys =<span style="color:#000000"> getAllPropertyNames(window);<br>    alert(propertys.length);          </span><span style="color:#008000">//</span><span style="color:#008000">276</span><br>    alert(propertys.join("\n"));      <span style="color:#008000">//</span><span style="color:#008000">toString等</span><br>})()</div>


<p><img src="http://www.cnblogs.com/ziyunfei/aggbug/2752905.html?type=1" width="1" height="1" alt=""><p><a href="http://www.cnblogs.com/ziyunfei/archive/2012/11/03/2752905.html">本文链接</a></p></p>

</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/lyuehh/">github.com/lyuehh</a><br />
                  <a href="http://twitter.com/lyuehh/">twitter.com/lyuehh</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
