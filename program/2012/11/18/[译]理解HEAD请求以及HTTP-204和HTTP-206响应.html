<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>[译]理解HEAD请求以及HTTP/204和HTTP/206响应</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/">Your New Jekyll Site</a></h1>
              <a class="extra" href="/">home</a>
            </div>

                <h2>[译]理解HEAD请求以及HTTP/204和HTTP/206响应</h2>
<p class="meta">18 Nov 2012</p>

<div class="post">
<h2>[译]理解HEAD请求以及HTTP/204和HTTP/206响应</h2>

<h3>by 紫云飞</h3>

<h3>at 2012-11-17 22:39:00</h3>

<h3>original <a href="http://www.cnblogs.com/ziyunfei/archive/2012/11/17/2775421.html">http://www.cnblogs.com/ziyunfei/archive/2012/11/17/2775421.html</a></h3>

<p>原文:<a href="http://www.telerik.com/automated-testing-tools/blog/12-11-12/understanding-head-http-204-and-http-206.aspx">http://www.telerik.com/automated-testing-tools/blog/12-11-12/understanding-head-http-204-and-http-206.aspx</a></p>


<hr><p>上次我们讲了<a href="http://www.cnblogs.com/ziyunfei/archive/2012/11/16/2772729.html">HTTP/304响应</a>,今天我们继续讨论另外三种可能让Fiddler用户感到困惑的请求或响应类型.</p><p>下面的截图中有三条Web会话,每一条都返回了不同的状态码,但都在HTTP/2xx范围内:</p><p><img style="float:none;display:block;background-image:none" title="image" src="http://pic002.cnblogs.com/images/2012/116671/2012111616400412.jpg" alt="image" width="444" height="96" border="0"></p><p><strong>HEAD请求方法</strong></p><p>第一个请求返回了HTTP/200,但你应该注意到了,服务器并没有返回响应体.如果你在Inspectors选项卡中查看一下,就会发现客户端使用的是<strong>HEAD</strong>请求方法.HEAD方法允许客户端仅向服务器请求某个资源的响应头,而不要真正的下载该资源本身.服务器返回的响应头应该和客户端使用GET方法请求该资源时返回的请求头相同,比起GET方法,只是省略了响应体.</p><p><img style="float:none;display:block;background-image:none" title="image" src="http://pic002.cnblogs.com/images/2012/116671/2012111616400564.jpg" alt="image" width="292" height="331" border="0"></p><p>从上图中可以看出,如果客户端使用GET而不是HEAD方法请求该资源,服务器就应该会返回6623字节大小的响应体.还可以看出,该资源的类型为<strong>text/html</strong>以及它的编码为<strong>UTF-8</strong>.客户端可以使用HEAD请求来收集相关信息以确定如何操作该资源.例如,在IE中,如果一个<strong>OBJECT</strong>元素缺少<strong>TYPE</strong>参数,浏览器就会发送一个HEAD请求,目标URL为这个OBJECT元素的<strong>SRC</strong>属性指定的URL.然后浏览器就能够根据响应中的<strong>Content-Type</strong>头知道这是哪种类型的OBJECT.</p><p><strong>HTTP/204响应</strong></p><p>会话列表中的第二条会话返回了<strong>HTTP/204</strong>响应.从<strong>Content-Length</strong>响应头可以看出,该响应没有响应体,状态码描述为“<strong>No Content</strong>”:</p><p><img style="float:none;display:block;background-image:none" title="image" src="http://pic002.cnblogs.com/images/2012/116671/2012111616400632.jpg" alt="image" width="231" height="163" border="0"></p><p>你也许会有疑问:“返回一个没有响应体的HTTP/200响应不行吗?”</p><p>如果没有响应体,则在大多数场景下,这两种响应码完全等效,但有一种情况下,HTTP/204响应会让浏览器有不同的表现.这种情况就是当用户在浏览器窗口window或者frame/iframe框架中导航的时候.</p><ul><li>如果导航到的URL返回了一个没有响应体的HTTP/200响应,则页面将会显示一个空白文档(就是一片白色).页面的URL地址也会变成新指定的URL.</li><li>如果服务器返回的是一个HTTP/204响应,当前页面不会有任何变化,就好像根本没有进行导航操作一样.页面的URL地址也保持不变.</li></ul><p>HTTP/205响应码很少见,它类似于HTTP/204,除了页面保留在当前文档不变以外,多了一步操作,就是要清空当前文档内所有表单控件的内容.</p><p><strong>HTTP/206响应</strong></p><p>最后一条会话返回了HTTP/206 “Partial Content”响应.这种响应是在客户端表明自己只需要目标URL上的部分资源的时候返回的.这种情况经常发生在客户端继续请求一个<a href="http://blogs.msdn.com/b/ieinternals/archive/2011/06/03/send-an-etag-to-enable-http-206-file-download-resume-without-restarting.aspx">未完成的下载</a>的时候(通常是当客户端加载一个体积较大的嵌入文件,比如视屏或PDF文件),或者是客户端尝试实现<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa362708%28v=vs.85%29.aspx"><span><span>带宽遏流</span></span></a>的时候.</p><p>你可以通过<strong>Range</strong>请求头辨认出一个部分内容请求.该请求头表明了客户端需要请求资源的哪一部分:</p><p><img style="float:none;display:block;background-image:none" title="image" src="http://pic002.cnblogs.com/images/2012/116671/2012111616400560.jpg" alt="image" width="501" height="228" border="0"></p><p>在上图的请求中,客户端告诉服务器,它需要该视屏文件中从172,032到13,325,503字节范围内的数据.</p><p>在大多数情况下,客户端还会发送一些条件请求头,让服务器来辨别该返回哪个版本的资源.在上图的请求中,客户端把它在上次接收该资源的0到172032字节部分请求中服务器返回的<strong>ETag</strong>响应头作为了本次请求的<strong>If-Match</strong>请求头发送了出去,同样还把上次响应中的<strong>Last-Modified</strong>响应头用<strong>If-Unmodified-Since</strong>请求头发送了出去.</p><p>如果服务器发现该资源的版本与客户端所请求的版本不匹配,则会返回一个<strong>HTTP/412 Precondition Failed</strong>响应.如果客户端使用<strong>If-Range</strong>请求头而不是If-Match发送了上次收到的<strong>ETag</strong>响应头的值,且服务器发现客户端请求的版本与当前资源的版本不匹配,则服务器会返回整个资源数据.如果客户端需要完整的资源数据,使用If-Range可以减少一个网络请求.</p><p>服务器的<strong>Content-Range</strong>响应头表明了返回的是文件的哪一部分,<strong>Content-Length</strong>响应头表明了该部分文件的大小:<br><img style="float:none;display:block;background-image:none" title="image" src="http://pic002.cnblogs.com/images/2012/116671/2012111616400528.jpg" alt="image" width="490" height="242" border="0"></p><p>你也许注意到了<strong>Accept-Ranges</strong>响应头,服务器发送这个头的目的是让客户端知道服务器接受以字节为单位的部分内容请求.</p><p>如果你在Fiddler中看到了一个HTTP/206响应,但你需要的是一个完整的文件(比如你想保存一个完整的视屏文件),你可以选中该会话按下<strong>U</strong>键,或者按住<strong>Ctrl</strong>键点击工具栏中的<strong>Replay</strong>按钮,执行无条件请求.</p><img src="http://www.cnblogs.com/ziyunfei/aggbug/2775421.html?type=1" width="1" height="1" alt=""><p><a href="http://www.cnblogs.com/ziyunfei/archive/2012/11/17/2775421.html">本文链接</a></p>


</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/yourusername/">github.com/yourusername</a><br />
                  <a href="http://twitter.com/yourusername/">twitter.com/yourusername</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
