<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>一道关于&quot;/g&quot;笔试题</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/google_reader/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/google_reader/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/google_reader/">Google Reader</a></h1>
              <a class="extra" href="/google_reader/">home</a>
            </div>

                <h2>一道关于&quot;/g&quot;笔试题</h2>
<p class="meta">2012-11-13 21:44</p>

<div class="post">
<h2>一道关于&quot;/g&quot;笔试题</h2>

<h3>by snandy</h3>

<h3>at 2012-11-13 13:44:00</h3>

<h3>original <a href="http://www.cnblogs.com/snandy/archive/2012/11/13/2767264.html">http://www.cnblogs.com/snandy/archive/2012/11/13/2767264.html</a></h3>

<p>正则里“g”表示全局(global)的意思，比如当替换字符串时，如果正则不加g，则只替换一次。</p>


<div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px">str = 'hello, jack, hello, lily';<br>reg = /hello/;<br>res = str.replace(reg, 'hi');<br>console.log(res); // 'hi, jack, hello, lily'<br></div>


<p>第二个hello未被替换，正则reg换成“/hello/g”后则全部替换。</p>


<p> </p>


<p>“g”还有一个作用是它会记录上次匹配时的位置(lastIndex)。这道题如下</p>


<div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px">var reg = /abc/g;<br>var str = 'abcd';<br>reg.test(str);<br>reg.test(str);<br></div>


<p>两次test的结果分别是什么？ 相信不少人会迷惑。</p>


<p> </p>


<p>这种情况Perl里也会发生</p>


<div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px">use 5.012;<br><br>my $str = 'abcd';<br>if ($str =~ /abc/g) {<br>  say 'true';<br>} else {<br>  say 'false';<br>}<br>if ($str =~ /abc/g) {<br>  say 'true';<br>} else {<br>  say 'false';<br>}<br></div>


<p> </p>


<p>对于不同的正则对象，JS中会从字符串重新开始，因此以下两次输出都是true。</p>


<div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px">reg1 = /ab/g;<br>reg2 = /cd/g;<br>str = 'abcd';<br>console.log(reg2.test(str));<br>console.log(reg1.test(str));<br></div>


<p> </p>


<p>但Perl中第二次却是false，因为它记住了上次匹配的位置。从字符d后再去匹配ab就匹配不上了。</p>


<div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px">use 5.012;<br><br>my $str = 'abcd';<br>if ($str =~ /cd/g) {<br>say 'true';<br>} else {<br>say 'false';<br>}<br>if ($str =~ /ab/g) {<br>say 'true';<br>} else {<br>say 'false';<br>}<br></div>


<p>　　</p>


<p> </p>


<p><img src="http://www.cnblogs.com/snandy/aggbug/2767264.html?type=1" width="1" height="1" alt=""><p><a href="http://www.cnblogs.com/snandy/archive/2012/11/13/2767264.html">本文链接</a></p></p>

</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/lyuehh/">github.com/lyuehh</a><br />
                  <a href="http://twitter.com/lyuehh/">twitter.com/lyuehh</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
