<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Android 解码Gif 图像并播放</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/google_reader/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/google_reader/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/google_reader/">Google Reader</a></h1>
              <a class="extra" href="/google_reader/">home</a>
            </div>

                <h2>Android 解码Gif 图像并播放</h2>
<p class="meta">2011-01-14 05:37</p>

<div class="post">
<h2>Android 解码Gif 图像并播放</h2>

<h3>by Terry_龙</h3>

<h3>at 2011-01-13 21:37:00</h3>

<h3>original <a href="http://www.cnblogs.com/TerryBlog/archive/2011/01/13/1934951.html">http://www.cnblogs.com/TerryBlog/archive/2011/01/13/1934951.html</a></h3>

<p><p> </p>
<p style="text-align:left;line-height:150%;margin:2.7pt 0cm" align="left"><span style="line-height:150%;font-family:Arial;font-size:12pt">　　</span><span style="line-height:150%;font-family:Arial;font-size:12pt">Android </span><span style="line-height:150%;font-family:Arial;font-size:12pt">播放</span><span style="line-height:150%;font-family:Arial;font-size:12pt">GIF</span><span style="line-height:150%;font-family:Arial;font-size:12pt">之前就有过一篇文章是讲述如何使用</span><span style="line-height:150%;font-family:Arial;font-size:12pt">GIF</span><span style="line-height:150%;font-family:Arial;font-size:12pt">文件并播放。可以通过</span><span style="line-height:150%;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;font-size:7.5pt"> <a href="http://www.cnblogs.com/TerryBlog/archive/2010/09/06/1819641.html"><span style="line-height:150%;font-family:Arial;color:red;font-size:12pt">这里</span></a> </span><span style="line-height:150%;font-family:Arial;font-size:12pt">了解关于播放</span><span style="line-height:150%;font-family:Arial;font-size:12pt">GIF</span><span style="line-height:150%;font-family:Arial;font-size:12pt">的一种方法。</span><span style="line-height:150%;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;font-size:7.5pt"></span></p>
<p style="text-align:left;line-height:150%;margin:2.7pt 0cm" align="left"><span style="line-height:150%;font-family:Arial;font-size:12pt">　　如果前面有了解过的朋友肯定知道这上面的做法比较麻烦，又要去分解图片，又要写各种麻烦的</span><span style="line-height:150%;font-family:Arial;font-size:12pt">XML</span><span style="line-height:150%;font-family:Arial;font-size:12pt">文件，有点郁闷，而且还带来的直接后果是一个比较多动作的</span><span style="line-height:150%;font-family:Arial;font-size:12pt">GIF</span><span style="line-height:150%;font-family:Arial;font-size:12pt">图片可能会将项目的体积变大，这点很多朋友都无法接受。不过这样的好处也显而易见，就是运行的速度会比你去解码的速度要快。</span></p>
<p style="text-align:left;line-height:150%;margin:2.7pt 0cm" align="left"><span style="line-height:150%;font-family:Arial;font-size:12pt">　　以下这种方法是需要解码，但是速度的话保证不了，可能开线程的时候没有处理好吧，以下面这张图片为例做解码播放：</span></p>
<p style="text-align:left;line-height:150%;margin:2.7pt 0cm" align="center"><span style="line-height:150%;font-family:Arial;font-size:12pt">
<div align="center"><img border="0" alt="" src="http://images.cnblogs.com/cnblogs_com/terryblog/lzl.gif" width="128" height="128"></div></span></p>
<p style="text-align:center;line-height:150%;margin:2.7pt 0cm" align="center"><span style="line-height:150%;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;font-size:7.5pt"></span></p>
<p style="text-align:left;line-height:150%;margin:2.7pt 0cm" align="left"><span style="line-height:150%;font-family:Arial;font-size:12pt">　　首先，先编写一个</span><span style="line-height:150%;font-family:Arial;font-size:12pt">GIF</span><span style="line-height:150%;font-family:Arial;font-size:12pt">解码的帮助类，该类提供了几个操作</span><span style="line-height:150%;font-family:Arial;font-size:12pt">GIF</span><span style="line-height:150%;font-family:Arial;font-size:12pt">图片的方法，比如图片的初始化呀，切换图片呀，获得整个</span><span style="line-height:150%;font-family:Arial;font-size:12pt">GIF</span><span style="line-height:150%;font-family:Arial;font-size:12pt">的组合数量等等，由于代码量太多，这里就不列出来，后面会提供源码供大家参考，可于源码内找到该帮助类。</span></p>
<p style="text-align:left;line-height:150%;margin:2.7pt 0cm" align="left"> </p>
<p style="text-align:left;line-height:150%;margin:2.7pt 0cm" align="left"><span style="line-height:150%;font-family:Arial;font-size:12pt">之后，编写一个用于可显示</span><span style="line-height:150%;font-family:Arial;font-size:12pt">Gif </span><span style="line-height:150%;font-family:Arial;font-size:12pt">的组件，继承自</span><span style="line-height:150%;font-family:Arial;font-size:12pt">View </span><span style="line-height:150%;font-family:Arial;font-size:12pt">并实现了</span><span style="line-height:150%;font-family:Arial;font-size:12pt">Runable</span><span style="line-height:150%;font-family:Arial;font-size:12pt">，代码如下：</span></p>
<p style="text-align:left;line-height:150%;margin:2.7pt 0cm" align="left"> </p>
<p style="text-align:left;line-height:150%;background:whitesmoke;word-break:break-all" align="left"><span style="line-height:150%;font-family:&#39;Courier New&#39;;font-size:7pt"><span style="font-family:Arial;color:black;font-size:12pt">package com.terry.gif;<br><br></span><span style="font-family:Arial;color:black;font-size:12pt">import android.content.Context;<br></span><span style="font-family:Arial;color:black;font-size:12pt">import android.content.res.TypedArray;<br></span><span style="font-family:Arial;color:black;font-size:12pt">import android.graphics.Bitmap;<br></span><span style="font-family:Arial;color:black;font-size:12pt">import android.graphics.Canvas;<br></span><span style="font-family:Arial;color:black;font-size:12pt">import android.graphics.Paint;<br></span><span style="font-family:Arial;color:black;font-size:12pt">import android.util.AttributeSet;<br></span><span style="font-family:Arial;color:black;font-size:12pt">import android.view.View;<br><br></span><span style="font-family:Arial;color:blue;font-size:12pt">public</span> <span style="font-family:Arial;color:blue;font-size:12pt">class</span><span style="font-family:Arial;color:black;font-size:12pt"> TypegifView extends View implements Runnable {<br></span><span style="font-family:Arial;color:black;font-size:12pt">    gifOpenHelper gHelper;<br>    </span><span style="font-family:Arial;color:blue;font-size:12pt">private</span><span style="font-family:Arial;color:black;font-size:12pt"> boolean isStop = </span><span style="font-family:Arial;color:blue;font-size:12pt">true</span><span style="font-family:Arial;color:black;font-size:12pt">;<br>    </span><span style="font-family:Arial;color:blue;font-size:12pt">int</span><span style="font-family:Arial;color:black;font-size:12pt"> delta;<br></span><span style="font-family:Arial;color:black;font-size:12pt">    String title;<br><br></span><span style="font-family:Arial;color:black;font-size:12pt">    Bitmap bmp;<br><br>    </span><span style="font-family:Arial;color:green;font-size:12pt">// construct - refer for java<br></span><span style="color:black">    </span><span style="font-family:Arial;color:blue;font-size:12pt">public</span><span style="font-family:Arial;color:black;font-size:12pt"> TypegifView(Context context) {<br>        </span><span style="font-family:Arial;color:blue;font-size:12pt">this</span><span style="font-family:Arial;color:black;font-size:12pt">(context, </span><span style="font-family:Arial;color:blue;font-size:12pt">null</span><span style="font-family:Arial;color:black;font-size:12pt">);<br><br></span><span style="font-family:Arial;color:black;font-size:12pt">    }<br><br>    </span><span style="font-family:Arial;color:green;font-size:12pt">// construct - refer for xml<br></span><span style="color:black">    </span><span style="font-family:Arial;color:blue;font-size:12pt">public</span><span style="font-family:Arial;color:black;font-size:12pt"> TypegifView(Context context, AttributeSet attrs) {<br></span><span style="font-family:Arial;color:black;font-size:12pt">        super(context, attrs);<br></span><span style="font-family:Arial;color:green;font-size:12pt">//</span></span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">添加属性</span><span style="line-height:150%;font-family:&#39;Courier New&#39;;color:green;font-size:7pt"><br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">        TypedArray ta = context.obtainStyledAttributes(attrs,<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">                R.styleable.gifView);<br>        </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">int</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> n = ta.getIndexCount();<br><br>        </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">for</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> (</span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">int</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> i = </span><span style="line-height:150%;font-family:Arial;color:purple;font-size:12pt">0</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">; i &lt; n; i++) {<br>            </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">int</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> attr = ta.getIndex(i);<br><br>            </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">switch</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> (attr) {<br>            </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">case</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> R.styleable.gifView_src:<br>                </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">int</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> id = ta.getResourceId(R.styleable.gifView_src, </span><span style="line-height:150%;font-family:Arial;color:purple;font-size:12pt">0</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">);<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">                setSrc(id);<br>                </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">break</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">;<br><br>            </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">case</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> R.styleable.gifView_delay:<br>                </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">int</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> idelta = ta.getInteger(R.styleable.gifView_delay, </span><span style="line-height:150%;font-family:Arial;color:purple;font-size:12pt">1</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">);<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">                setDelta(idelta);<br>                </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">break</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">;<br><br>            </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">case</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> R.styleable.gifView_stop:<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">                boolean sp = ta.getBoolean(R.styleable.gifView_stop, </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">false</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">);<br>                </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">if</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> (!sp) {<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">                    setStop();<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">                }<br>                </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">break</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">;<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">            }<br><br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">        }<br><br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">        ta.recycle();<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">    }<br><br>    </span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">/**<br></span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">     * </span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">设置停止</span><span style="line-height:150%;font-family:&#39;Courier New&#39;;color:green;font-size:7pt"><br></span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">     * <br></span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">     * @param stop<br></span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">     */</span><span style="line-height:150%;font-family:&#39;Courier New&#39;;color:black;font-size:7pt"><br>    </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">public</span> <span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">void</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> setStop() {<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">        isStop = </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">false</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">;<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">    }<br><br>    </span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">/**<br></span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">     * </span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">设置启动</span><span style="line-height:150%;font-family:&#39;Courier New&#39;;color:green;font-size:7pt"><br></span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">     */</span><span style="line-height:150%;font-family:&#39;Courier New&#39;;color:black;font-size:7pt"><br>    </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">public</span> <span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">void</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> setStart() {<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">        isStop = </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">true</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">;<br><br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">        Thread updateTimer = </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">new</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> Thread(</span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">this</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">);<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">        updateTimer.start();<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">    }<br><br>    </span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">/**<br></span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">     * </span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">通过下票设置第几张图片显示</span><span style="line-height:150%;font-family:&#39;Courier New&#39;;color:green;font-size:7pt"><br></span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">     * @param id<br></span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">     */</span><span style="line-height:150%;font-family:&#39;Courier New&#39;;color:black;font-size:7pt"><br>    </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">public</span> <span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">void</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> setSrc(</span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">int</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> id) {<br><br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">        gHelper = </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">new</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> gifOpenHelper();<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">        gHelper.read(TypegifView.</span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">this</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">.getResources().openRawResource(id));<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">        bmp = gHelper.getImage();</span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">// </span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">得到第一张图片</span><span style="line-height:150%;font-family:&#39;Courier New&#39;;color:green;font-size:7pt"><br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">    }<br><br>    </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">public</span> <span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">void</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> setDelta(</span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">int</span> <span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">is</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">) {<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">        delta = </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">is</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">;<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">    }<br><br>    </span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">// to meaure its Width &amp; Height<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">    @Override<br>    </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">protected</span> <span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">void</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> onMeasure(</span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">int</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> widthMeasureSpec, </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">int</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> heightMeasureSpec) {<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">        setMeasuredDimension(measureWidth(widthMeasureSpec),<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">                measureHeight(heightMeasureSpec));<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">    }<br><br>    </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">private</span> <span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">int</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> measureWidth(</span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">int</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> measureSpec) {<br>        </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">return</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> gHelper.getWidth();<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">    }<br><br>    </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">private</span> <span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">int</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> measureHeight(</span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">int</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> measureSpec) {<br>        </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">return</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> gHelper.getHeigh();<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">    }<br><br>    </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">protected</span> <span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">void</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> onDraw(Canvas canvas) {<br>        </span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">// TODO Auto-generated method stub<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">        canvas.drawBitmap(bmp, </span><span style="line-height:150%;font-family:Arial;color:purple;font-size:12pt">0</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">, </span><span style="line-height:150%;font-family:Arial;color:purple;font-size:12pt">0</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">, </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">new</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> Paint());<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">        bmp = gHelper.nextBitmap();<br><br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">    }<br><br>    </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">public</span> <span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">void</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> run() {<br>        </span><span style="line-height:150%;font-family:Arial;color:green;font-size:12pt">// TODO Auto-generated method stub<br></span><span style="line-height:150%;font-family:&#39;Courier New&#39;;color:black;font-size:7pt">        </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">while</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> (isStop) {<br>            </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">try</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> {<br>                </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">this</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">.postInvalidate();<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">                Thread.sleep(gHelper.nextDelay() / delta);<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">            } </span><span style="line-height:150%;font-family:Arial;color:blue;font-size:12pt">catch</span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt"> (Exception ex) {<br><br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">            }<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">        }<br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">    }<br><br></span><span style="line-height:150%;font-family:Arial;color:black;font-size:12pt">}</span></p>
<p style="text-align:left;line-height:150%;margin:2.7pt 0cm" align="left"> </p>
<p style="text-align:left;line-height:150%;margin:2.7pt 0cm" align="left"><span style="line-height:150%;font-family:Arial;font-size:12pt">基础功能实现后。可通过</span><span style="line-height:150%;font-family:Arial;font-size:12pt">view.start()</span><span style="line-height:150%;font-family:Arial;font-size:12pt">开启</span><span style="line-height:150%;font-family:Arial;font-size:12pt">GIF</span><span style="line-height:150%;font-family:Arial;font-size:12pt">的播放，或者</span><span style="line-height:150%;font-family:Arial;font-size:12pt">view.stop()</span><span style="line-height:150%;font-family:Arial;font-size:12pt">停止</span><span style="line-height:150%;font-family:Arial;font-size:12pt">GIF</span><span style="line-height:150%;font-family:Arial;font-size:12pt">的播放，代码如下：</span></p>
<p style="text-align:left;line-height:150%;margin:2.7pt 0cm" align="left"> </p>
<p style="text-align:left;line-height:150%;background:whitesmoke;word-break:break-all" align="left"><span style="line-height:150%;font-family:&#39;Courier New&#39;;font-size:7pt"><span style="font-family:Arial;color:black;font-size:12pt">setContentView(R.layout.main);<br></span><span style="font-family:Arial;color:black;font-size:12pt">        Button btn = (Button) findViewById(R.id.Button01);<br></span><span style="font-family:Arial;color:black;font-size:12pt">        Button btn2 = (Button) findViewById(R.id.Button02);<br></span><span style="font-family:Arial;color:black;font-size:12pt">        final TypegifView view = (TypegifView) findViewById(R.id.gifView1);<br><br></span><span style="font-family:Arial;color:black;font-size:12pt">        btn.setOnClickListener(</span><span style="font-family:Arial;color:blue;font-size:12pt">new</span><span style="font-family:Arial;color:black;font-size:12pt"> OnClickListener() {<br><br></span><span style="font-family:Arial;color:black;font-size:12pt">            @Override<br>            </span><span style="font-family:Arial;color:blue;font-size:12pt">public</span> <span style="font-family:Arial;color:blue;font-size:12pt">vo</span><span style="color:blue;font-size:12pt">id</span><span style="color:black;font-size:12pt"> onClick(Vie</span><span style="color:black;font-size:12pt">w v) {<br></span><span style="color:black;font-size:12pt">                view.setStop();<br></span><span style="color:black;font-size:12pt">            }<br></span><span style="color:black;font-size:12pt">        });<br><br></span><span style="color:black;font-size:12pt">        btn2.setOnClickListener(</span><span style="color:blue;font-size:12pt">new</span><span style="color:black;font-size:12pt"> OnClickListener() {<br><br></span><span style="color:black;font-size:12pt">            @Override<br>            </span><span style="color:blue;font-size:12pt">public</span> <span style="color:blue;font-size:12pt">void</span><span style="color:black;font-size:12pt"> onClick(View v) {<br></span><span style="color:black;font-size:12pt">                view.setStart();<br></span><span style="color:black;font-size:12pt">            }<br></span><span style="color:black;font-size:12pt">        });</span></span></p>
<p style="text-align:left;line-height:150%;margin:2.7pt 0cm" align="left"> </p>
<p style="text-align:left;line-height:150%;margin:2.7pt 0cm" align="left"><span style="line-height:150%;font-family:宋体;font-size:12pt">显示效果：</span></p>
<p style="text-align:left;line-height:150%;margin:2.7pt 0cm" align="left"></p>
<p style="text-align:left;line-height:150%;margin:2.7pt 0cm" align="left"> <img border="0" alt="" src="http://images.cnblogs.com/cnblogs_com/terryblog/gifplayer.png" width="235" height="288"></p>
<p style="text-align:left;line-height:150%;margin:2.7pt 0cm" align="left"><span style="line-height:150%;font-family:宋体;font-size:12pt">源码参见：</span><span style="line-height:150%;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;font-size:7.5pt"><a title="gifPlayer" href="http://files.cnblogs.com/TerryBlog/gifPlayer.rar"><span style="line-height:150%;color:blue;font-size:12pt">gifPlayer</span></a></span></p>
<p> </p>
<p> </p><img src="http://www.cnblogs.com/TerryBlog/aggbug/1934951.html?type=1" width="1" height="1" alt=""><p>作者: <a href="http://www.cnblogs.com/TerryBlog/">Terry_龙</a> 发表于 2011-01-13 21:37 <a href="http://www.cnblogs.com/TerryBlog/archive/2011/01/13/1934951.html">原文链接</a></p><p>评论: 1　<a href="http://www.cnblogs.com/TerryBlog/archive/2011/01/13/1934951.html#pagedcomment">查看评论</a>　<a href="http://www.cnblogs.com/TerryBlog/archive/2011/01/13/1934951.html#commentform">发表评论</a></p><hr><p>最新新闻：<br>· <a href="http://news.cnblogs.com/n/88320/">黑客回应索尼起诉 称破解合法并未支持盗版</a><span style="color:gray">(2011-01-14 12:10)</span><br>· <a href="http://news.cnblogs.com/n/88319/">开源带来监管不利Android手机吸金</a><span style="color:gray">(2011-01-14 12:06)</span><br>· <a href="http://news.cnblogs.com/n/88318/">“美国豆瓣”Pandora获上亿美元投资 考虑上市</a><span style="color:gray">(2011-01-14 12:04)</span><br>· <a href="http://news.cnblogs.com/n/88317/">开发人员能够得到的最好赞扬</a><span style="color:gray">(2011-01-14 12:03)</span><br>· <a href="http://news.cnblogs.com/n/88316/">京东：翻新iPhone4源自联通 无私拆情况</a><span style="color:gray">(2011-01-14 11:59)</span><br></p><p>编辑推荐：<a href="http://www.cnblogs.com/JeffreyZhao/archive/2011/01/14/be-clear-with-language-spec-and-platform-implementation-dotnet-cross-platform.html">分清“语言/规范”以及“平台/实现”，以及跨平台.NET开发</a><br></p><p>网站导航：<a href="http://www.cnblogs.com">博客园首页</a>  <a href="http://home.cnblogs.com/">我的园子</a>  <a href="http://news.cnblogs.com">新闻</a>  <a href="http://home.cnblogs.com/ing/">闪存</a>  <a href="http://home.cnblogs.com/group/">小组</a>  <a href="http://space.cnblogs.com/q/">博问</a>  <a href="http://kb.cnblogs.com">知识库</a></p></p>


</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/lyuehh/">github.com/lyuehh</a><br />
                  <a href="http://twitter.com/lyuehh/">twitter.com/lyuehh</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
