<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Java的内部类——你知道多少？</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/">Your New Jekyll Site</a></h1>
              <a class="extra" href="/">home</a>
            </div>

                <h2>Java的内部类——你知道多少？</h2>
<p class="meta">27 Dec 2010</p>

<div class="post">
<h2>Java的内部类——你知道多少？</h2>

<h3>by 青竹少年</h3>

<h3>at 2010-12-26 17:06:00</h3>

<h3>original <a href="http://www.cnblogs.com/juniorblanhan/archive/2010/12/26/1908546.html">http://www.cnblogs.com/juniorblanhan/archive/2010/12/26/1908546.html</a></h3>

<p><p>　　我在写这篇文章之前，我对Java内部类也不是很清楚，只知道简单的应用。前几天有个朋友问我怎么理解Java内部类，我当时就有点傻了，想了半天也没有说出来，我想，如果让大家来回答这个问题，大家该怎么回答呢？我估计，总有一些人回答不上来的，或者说回答的不够完整。我特意查了查，自己又总结了总结，在这给大家分享一下。 在说之前，我先列出几个问题： </p>
<p>　　　　1.外部类（非主类）通过怎样的方式访问内部类？ </p>
<p>　　　　2.内部类能不能访问主类私有的属性，为什么？ </p>
<p>　　　　3.内部类能不能继承别的类和接口？</p>
<p>　　　　4.内部类能不能是static的？ </p>
<p>　　　　5.在主类的方法里面可不可以定义内部类？ </p>
<p>　　　　6.初始化主类的时候是不是也把内部类给初始化了？为什么？ </p>
<p>　　　　7.怎样写一个匿名的内部类？ </p>
<p>　　我目前想到的就这些，在我给大家陈述之前，希望大家好好想想，再往下看：</p>
<p>　　第一个问题：外部类是怎样引用内部类的？这个问题，我想，可能有的人就会这样写：</p>
<p>　　这是内部类：InnerClass.</p>
<div>
<pre><div><span style="color:#008080"> 1</span> <span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">class</span><span style="color:#000000"> MainClass {<br></span><span style="color:#008080"> 2</span> <span style="color:#000000">    <br></span><span style="color:#008080"> 3</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">class</span><span style="color:#000000"> InnerClass{<br></span><span style="color:#008080"> 4</span> <span style="color:#000000">        </span><span style="color:#0000ff">public</span><span style="color:#000000"> String name </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#000000">"</span><span style="color:#000000">name</span><span style="color:#000000">"</span><span style="color:#000000">;<br></span><span style="color:#008080"> 5</span> <span style="color:#000000"><br></span><span style="color:#008080"> 6</span> <span style="color:#000000">        </span><span style="color:#0000ff">public</span><span style="color:#000000"> String getName() {<br></span><span style="color:#008080"> 7</span> <span style="color:#000000">            </span><span style="color:#0000ff">return</span><span style="color:#000000"> name;<br></span><span style="color:#008080"> 8</span> <span style="color:#000000">        }<br></span><span style="color:#008080"> 9</span> <span style="color:#000000"><br></span><span style="color:#008080">10</span> <span style="color:#000000">        </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> setName(String name) {<br></span><span style="color:#008080">11</span> <span style="color:#000000">            </span><span style="color:#0000ff">this</span><span style="color:#000000">.name </span><span style="color:#000000">=</span><span style="color:#000000"> name;<br></span><span style="color:#008080">12</span> <span style="color:#000000">        }<br></span><span style="color:#008080">13</span> <span style="color:#000000">    }<br></span><span style="color:#008080">14</span> <span style="color:#000000">}</span></div></pre>
</div>
<p>　　以下是引用：</p>
<p> </p>
<div>
<pre><div><span style="color:#008080">1</span> <span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">class</span><span style="color:#000000"> CheckClass {<br></span><span style="color:#008080">2</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">static</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> main(String[] args) {<br></span><span style="color:#008080">3</span> <span style="color:#000000">        InnerClass innerClass </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> InnerClass();<br></span><span style="color:#008080">4</span> <span style="color:#000000">        System.out.println(innerClass.getName());<br></span><span style="color:#008080">5</span> <span style="color:#000000">    }<br></span><span style="color:#008080">6</span> <span style="color:#000000">}</span></div></pre>
</div>
<p>　　如果这样写的话，会报编译错误。那么为什么会报错呢？因为在Java的设计中，如果想访问一个类的内部类，你必须通过宿主类去取它，然后，再对它进行操作，Java就是想这样把内部类给封闭起来的，好吧，正确的写法，我给大家贴出来：</p>
<p>　　以下是内部类的写法：</p>
<p>　　</p>
<div>
<pre><div><span style="color:#008080"> 1</span> <span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">class</span><span style="color:#000000"> MainClass {<br></span><span style="color:#008080"> 2</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> InnerClass getInnerClass() {<br></span><span style="color:#008080"> 3</span> <span style="color:#000000">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> InnerClass();<br></span><span style="color:#008080"> 4</span> <span style="color:#000000">    }<br></span><span style="color:#008080"> 5</span> <span style="color:#000000"><br></span><span style="color:#008080"> 6</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">class</span><span style="color:#000000"> InnerClass {<br></span><span style="color:#008080"> 7</span> <span style="color:#000000">        </span><span style="color:#0000ff">public</span><span style="color:#000000"> String name </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#000000">"</span><span style="color:#000000">name</span><span style="color:#000000">"</span><span style="color:#000000">;<br></span><span style="color:#008080"> 8</span> <span style="color:#000000"><br></span><span style="color:#008080"> 9</span> <span style="color:#000000">        </span><span style="color:#0000ff">public</span><span style="color:#000000"> String getName() {<br></span><span style="color:#008080">10</span> <span style="color:#000000">            </span><span style="color:#0000ff">return</span><span style="color:#000000"> name;<br></span><span style="color:#008080">11</span> <span style="color:#000000">        }<br></span><span style="color:#008080">12</span> <span style="color:#000000"><br></span><span style="color:#008080">13</span> <span style="color:#000000">        </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> setName(String name) {<br></span><span style="color:#008080">14</span> <span style="color:#000000">            </span><span style="color:#0000ff">this</span><span style="color:#000000">.name </span><span style="color:#000000">=</span><span style="color:#000000"> name;<br></span><span style="color:#008080">15</span> <span style="color:#000000">        }<br></span><span style="color:#008080">16</span> <span style="color:#000000">    }<br></span><span style="color:#008080">17</span> <span style="color:#000000">}</span></div></pre>
</div>
<p>　　如果你想访问Java内部类，你必须先拿到它的宿主类，这样你才能对内部类进行操作：</p>
<p> </p>
<div>
<pre><div><span style="color:#008080">1</span> <span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">class</span><span style="color:#000000"> CheckClass {<br></span><span style="color:#008080">2</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">static</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> main(String[] args) {<br></span><span style="color:#008080">3</span> <span style="color:#000000">        MainClass mainClass </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> MainClass();<br></span><span style="color:#008080">4</span> <span style="color:#000000">        System.out.println(mainClass.getInnerClass().getName());<br></span><span style="color:#008080">5</span> <span style="color:#000000">    }<br></span><span style="color:#008080">6</span> <span style="color:#000000">}</span></div></pre>
</div>
<p>　　这样的话，编译就不会报错了。</p>
<p> </p>
<p> </p>
<p> </p>
<p>　　好了，该回答第二个问题了，就是内部类能不能访问宿主类的私有属性？回答是可以的。如果，你会看JVM的源码的话，你就会看到，在编译内部类调用主类私有变量时，会把它们转换成一种特殊的符号，JVM会把这种符号解析成公有的，然后让内部类调用。代码很简单，我就不贴了。</p>
<p>　　接着回答第三个和第四个问题：就是内部类能不能继承别的类和接口？内部类能不能是static的？为什么不能，当然可以，这些并没有什么约束。你自己可以试一下。</p>
<p>　　该第五个问题了：在主类的方法里面可不可以定义内部类？其实，这个问题，在我回答第一个问题的时候，已经把答案告诉了大家，就是在getInnerClass()方法里面，不就是new了一个内部类吗。</p>
<p>　　第六个问题：初始化主类的时候是不是也把内部类给初始化了？为什么？这个嘛，如果反过来说就对了，因为如果，你想调用内部类，你就得初始化它的主类，因此，你在初始化内部类时就初始化了主类，但是，你初始化主类，如果不是显示的去初始化，你就不可能初始化它的内部类，尽管内部类是在主类的里面。如果，你有时间，你可以到编译的主类文件去看看。</p>
<p>　　最后一个问题就是：怎样写一个匿名的内部类？如果大家搞过Java Swing或者Android开发，这个问题对你来说很简单，因为在随便的一些事件里，你就可以定义一个匿名的内部类，然后实现它的方法。不过，为了让更多的人明白，我把代码贴出来，以下是我的代码：</p>
<p>　　这是要实现的那个接口：</p>
<div>
<pre><div><span style="color:#008080">1</span> <span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">interface</span><span style="color:#000000"> SuperInterface {<br></span><span style="color:#008080">2</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> print();<br></span><span style="color:#008080">3</span> <span style="color:#000000">}</span></div></pre>
</div>
<p>　　以下是主类的代码：</p>
<div>
<pre><div><span style="color:#008080"> 1</span> <span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">class</span><span style="color:#000000"> MainClass {<br></span><span style="color:#008080"> 2</span> <span style="color:#000000">    <br></span><span style="color:#008080"> 3</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> SuperInterface print(){<br></span><span style="color:#008080"> 4</span> <span style="color:#000000">        <br></span><span style="color:#008080"> 5</span> <span style="color:#000000">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> SuperInterface(){<br></span><span style="color:#008080"> 6</span> <span style="color:#000000"><br></span><span style="color:#008080"> 7</span> <span style="color:#000000">            </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> print() {<br></span><span style="color:#008080"> 8</span> <span style="color:#000000">                System.out.println(</span><span style="color:#000000">"</span><span style="color:#000000">Hello Anonymity Interface</span><span style="color:#000000">"</span><span style="color:#000000">);<br></span><span style="color:#008080"> 9</span> <span style="color:#000000">            }};<br></span><span style="color:#008080">10</span> <span style="color:#000000">    }<br></span><span style="color:#008080">11</span> <span style="color:#000000">}</span></div></pre>
</div>
<p>　　其实上面的一段代码就是一个匿名内部类，为什么叫匿名内部类呢？因为，你没有给那个内部类起名字，而是直接实现那个接口，所以叫匿名内部类。</p>
<p>　　好吧，我看写的也不少了，不过，可能我还会有疏漏的地方，希望大家能参与进来共同讨论。</p>
<p> </p>
<p> </p>
<p>　　</p>
<p> </p><img src="http://www.cnblogs.com/juniorblanhan/aggbug/1908546.html?type=1" width="1" height="1" alt=""><p>作者: <a href="http://www.cnblogs.com/juniorblanhan/">青竹少年</a> 发表于 2010-12-26 17:06 <a href="http://www.cnblogs.com/juniorblanhan/archive/2010/12/26/1908546.html">原文链接</a></p><p>评论: 2　<a href="http://www.cnblogs.com/juniorblanhan/archive/2010/12/26/1908546.html#pagedcomment">查看评论</a>　<a href="http://www.cnblogs.com/juniorblanhan/archive/2010/12/26/1908546.html#commentform">发表评论</a></p><hr><p>最新新闻：<br>· <a href="http://news.cnblogs.com/n/86008/">百度涉足电子图书销售：推出文库书店业务</a><span style="color:gray">(2010-12-27 08:29)</span><br>· <a href="http://news.cnblogs.com/n/86007/">互联网地图牌照申请期限延长 谷歌微软仍待批</a><span style="color:gray">(2010-12-27 08:28)</span><br>· <a href="http://news.cnblogs.com/n/86006/">乔布斯应做的六件事：建立支付和通讯系统</a><span style="color:gray">(2010-12-27 08:28)</span><br>· <a href="http://news.cnblogs.com/n/86005/">80后闹离婚争网游装备 法院驳回平分财产诉求</a><span style="color:gray">(2010-12-27 08:27)</span><br>· <a href="http://news.cnblogs.com/n/86004/">硅谷2011年预测：巨额并购将诞生</a><span style="color:gray">(2010-12-27 08:26)</span><br></p><p>编辑推荐：<a href="http://zt.cnblogs.com/blogswarriors/">“博客无双“活动：写博客、攒园豆、赢大奖</a><br></p><p>网站导航：<a href="http://www.cnblogs.com">博客园首页</a>  <a href="http://home.cnblogs.com/">我的园子</a>  <a href="http://news.cnblogs.com">新闻</a>  <a href="http://home.cnblogs.com/ing/">闪存</a>  <a href="http://home.cnblogs.com/group/">小组</a>  <a href="http://space.cnblogs.com/q/">博问</a>  <a href="http://kb.cnblogs.com">知识库</a></p></p>


</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/yourusername/">github.com/yourusername</a><br />
                  <a href="http://twitter.com/yourusername/">twitter.com/yourusername</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
