<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>两道设计模式的面试题</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/google_reader/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/google_reader/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/google_reader/">Google Reader</a></h1>
              <a class="extra" href="/google_reader/">home</a>
            </div>

                <h2>两道设计模式的面试题</h2>
<p class="meta">2010-12-24 00:38</p>

<div class="post">
<h2>两道设计模式的面试题</h2>

<h3>by Binhua Liu</h3>

<h3>at 2010-12-23 16:38:00</h3>

<h3>original <a href="http://www.cnblogs.com/Binhua-Liu/archive/2010/12/23/1914935.html">http://www.cnblogs.com/Binhua-Liu/archive/2010/12/23/1914935.html</a></h3>

<p><h4 align="center"><font color="#333333">两道设计模式的面试题</font></h4>  <p align="center"><a href="http://www.cnblogs.com/Binhua-Liu">Binhua Liu</a></p>  <p align="left"> </p>  <p><font color="#333333">这是最近碰到的2个设计模式的面试题，大概如此： </font></p>  <p><font color="#333333">  </font></p>  <p><font color="#333333">1, Windows Media Player和RealPlayer是常用的媒体播放器，它们的API结构和调用方法非常不同，现在你的应用需要同时支持调用这2种播放器的API。你要怎么设计？ </font></p>  <p><font color="#333333">  </font></p>  <p><font color="#333333">2, 现在有一种空调，它支持3种模式：Hot Air，Cool Air 和DoNothing。例如，当选择Hot Air模式时，再选择温度为20度，空调将输送热风；选择 Cool Air模式，温度设置为20度时，将输送冷风；在选择DoNothing模式时，空调什么都不做。 你将考虑如何为空调设计应用程序？如果将来空调需要增加支持新的模式呢？</font></p>  <p><font color="#333333"></font> </p>  <p>下面是我的解答，权当抛砖引玉。</p>  <p> </p>  <h4><font color="#333333"><font style="font-weight:bold">一、 第一题的解：适配器模式+抽象工厂模式</font></font></h4>  <p><font color="#333333"></font> </p>  <p><font color="#333333">我采用了抽象工厂模式+适配器模式，</font><font color="#333333">先上图：</font></p>  <p> </p>  <p><a href="http://images.cnblogs.com/cnblogs_com/Binhua-Liu/201012/201012221403155294.png"><img style="background-image:none;border-right-width:0px;padding-left:0px;padding-right:0px;display:block;float:none;border-top-width:0px;border-bottom-width:0px;margin-left:auto;border-left-width:0px;margin-right:auto;padding-top:0px" title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/Binhua-Liu/201012/201012221403176558.png" width="631" height="480"></a></p>  <p> </p>  <p><font color="#333333" size="3"><strong></strong></font> </p>  <p><font color="#333333">设计的重点是：</font></p>  <p> </p>  <p>1,首先看适配器模式。MediaPlayerClassA和RealPlayerClassA都实现了IMediaA接口。MediaPlayerClassA调用MediaPlayer的APIs来实现IMediaA接口定义的功能；RealPlayerClassA则调用RealPlayer APIs。</p>  <p> </p>  <p>2,再来看抽象工厂模式。MediaPlayerFactory和RealPlayerFactory继承自抽象类MediaFactory类，MediaPlayerFactory用来创建MediaPlayer产品族；RealPlayerFactory用来创建RealPlayer产品族。虽然上图中只画出了IMediaA接口，但事实上我们可能需要实现多个接口如IMediaB，IMediaC等，这就是这里为什么使用抽象工厂模式。</p>  <p> </p>  <p>3,抽象类MediaFactory实现了一个静态方法CreateFactory，用来创建具体工厂，该方法返回MediaFactory类型的对象给Client，这样，Client不就需要知道它操作的是那个具体工厂。CreateFactory方法采用反射技术，这样，不需要修改CreateFactory方法的代码，就可以支持以后添加新的具体工厂。</p>  <p> </p>  <p>4,工厂类返回IMediaA接口给Client，Client操作IMediaA接口而不需要知道它具体使用的是MediaPlayerClassA还是RealPlayerClassA的实例。</p>  <p> </p>  <p>序列图如下：</p>  <p> </p>  <p><a href="http://images.cnblogs.com/cnblogs_com/Binhua-Liu/201012/201012231539071124.png"><img style="background-image:none;border-right-width:0px;padding-left:0px;padding-right:0px;display:block;float:none;border-top-width:0px;border-bottom-width:0px;margin-left:auto;border-left-width:0px;margin-right:auto;padding-top:0px" title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/Binhua-Liu/201012/201012231539117315.png" width="640" height="372"></a></p>  <p><strong><font size="3"></font></strong> </p>  <p><strong><font size="3"></font></strong> </p>  <p><font color="#333333" size="3"><strong>二、 第二题的解：Flyweight模式</strong></font></p>  <p><font color="#333333"></font> </p>  <p><font color="#333333">我采用了Flyweight模式，先上图:</font></p>  <p> </p>  <p><a href="http://images.cnblogs.com/cnblogs_com/Binhua-Liu/201012/201012231539149003.png"><img style="background-image:none;border-bottom:0px;border-left:0px;padding-left:0px;padding-right:0px;display:block;float:none;margin-left:auto;border-top:0px;margin-right:auto;border-right:0px;padding-top:0px" title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/Binhua-Liu/201012/2010122315391768.png" width="640" height="409"></a></p>  <p> </p>  <p><font color="#333333">设计的重点是：</font></p>  <p> </p>  <p>1,把AirConditioner和它支持的Model分离开来，在AirConditioner类的实例中保存它支持的所有Model类的实例，这样做的好处是1)如果只是支持的Model有变化，不需要去实现新的AirConditioner类，只要添加或删除支持的Model即可。2)多个不同的AirConditioner类可以方便地共享共同的Model类，否则，可能需要复杂的继承关系才能在不同AirConditioner类之间共享Model。事实上，AirConditioner类和Model类的关系非常类似于桥梁模式中抽象类和实现类的关系。</p>  <p> </p>  <p>2,采用Flyweight模式。在多个AirCondition实例中，共享Model的实例，这样可以大大地节省存储空间。ModelFactory用于创建Model实例并返回给AirCondition，它保存了一个Model池，每种类型的Model只有一个实例。在Model类中只保存内蕴状态，AirConditioner类保存外蕴状态，调用Model类的Execute方法时，需要把IAirConditioner作为外蕴状态传递给方法（或者也可以使用专门的状态类作为外蕴状态）。</p>  <p> </p>  <p>序列图如下：</p>  <p> </p>  <p><a href="http://images.cnblogs.com/cnblogs_com/Binhua-Liu/201012/201012231637587075.png"><img style="background-image:none;border-bottom:0px;border-left:0px;padding-left:0px;padding-right:0px;display:block;float:none;margin-left:auto;border-top:0px;margin-right:auto;border-right:0px;padding-top:0px" title="image" border="0" alt="image" src="http://images.cnblogs.com/cnblogs_com/Binhua-Liu/201012/201012231638078592.png" width="640" height="369"></a></p><img src="http://www.cnblogs.com/Binhua-Liu/aggbug/1914935.html?type=1" width="1" height="1" alt=""><p>作者: <a href="http://www.cnblogs.com/Binhua-Liu/">Binhua Liu</a> 发表于 2010-12-23 16:38 <a href="http://www.cnblogs.com/Binhua-Liu/archive/2010/12/23/1914935.html">原文链接</a></p><p>评论: 22　<a href="http://www.cnblogs.com/Binhua-Liu/archive/2010/12/23/1914935.html#pagedcomment">查看评论</a>　<a href="http://www.cnblogs.com/Binhua-Liu/archive/2010/12/23/1914935.html#commentform">发表评论</a></p><hr><p>最新新闻：<br>· <a href="http://news.cnblogs.com/n/85669/">2010年世界品牌500强排行揭晓 Facebook居首位</a><span style="color:gray">(2010-12-23 22:32)</span><br>· <a href="http://news.cnblogs.com/n/85667/">Facebook是颗摇钱树，以色列人正在拼命的摇</a><span style="color:gray">(2010-12-23 22:14)</span><br>· <a href="http://news.cnblogs.com/n/85666/">腾讯问问知识频道上线：问答媒体新模式</a><span style="color:gray">(2010-12-23 21:46)</span><br>· <a href="http://news.cnblogs.com/n/85664/">消息称下一代iPad下月出货仍不支持USB</a><span style="color:gray">(2010-12-23 21:29)</span><br>· <a href="http://news.cnblogs.com/n/85660/">Kinect + VR 眼镜 = 我是初音？</a><span style="color:gray">(2010-12-23 21:26)</span><br></p><p>编辑推荐：<a href="http://news.cnblogs.com/n/85621/">程序员在创业团队的技术挑战</a><br></p><p>网站导航：<a href="http://www.cnblogs.com">博客园首页</a>  <a href="http://home.cnblogs.com/">我的园子</a>  <a href="http://news.cnblogs.com">新闻</a>  <a href="http://home.cnblogs.com/ing/">闪存</a>  <a href="http://home.cnblogs.com/group/">小组</a>  <a href="http://space.cnblogs.com/q/">博问</a>  <a href="http://kb.cnblogs.com">知识库</a></p></p>


</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/lyuehh/">github.com/lyuehh</a><br />
                  <a href="http://twitter.com/lyuehh/">twitter.com/lyuehh</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
