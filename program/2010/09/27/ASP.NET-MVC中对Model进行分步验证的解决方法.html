<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>ASP.NET MVC中对Model进行分步验证的解决方法</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/">Your New Jekyll Site</a></h1>
              <a class="extra" href="/">home</a>
            </div>

                <h2>ASP.NET MVC中对Model进行分步验证的解决方法</h2>
<p class="meta">27 Sep 2010</p>

<div class="post">
<h2>ASP.NET MVC中对Model进行分步验证的解决方法</h2>

<h3>by 麒麟</h3>

<h3>at 2010-09-27 00:16:00</h3>

<h3>original <a href="http://www.cnblogs.com/zhuqil/archive/2010/09/27/Mvc-Validation.html">http://www.cnblogs.com/zhuqil/archive/2010/09/27/Mvc-Validation.html</a></h3>

<p><a href="http://www.cnblogs.com/zhuqil/"><img src="http://pic.cnblogs.com/face/u38542.jpg" alt="" border="0"></a><br>作者: <a href="http://www.cnblogs.com/zhuqil/">麒麟</a> 发表于 2010-09-27 00:16 <a href="http://www.cnblogs.com/zhuqil/archive/2010/09/27/Mvc-Validation.html">原文链接</a> 阅读: 1050 评论: 3</p>


<p>    在我之前的文章:<a href="http://www.cnblogs.com/zhuqil/archive/2010/05/02/ASP-MVC-2-wf-4.html">ASP.NET MVC2.0结合WF4.0实现用户多步注册流程</a>中将一个用户的注册分成了四步，而这四个步骤都是在完善一个Model的信息，但是又分页面填写信息的，当时我加上ModelState.IsValid这句验证代码的时候，根本没法通过验证，因为在注册的前面三步，注册用户的Model信息都没填写完整，而ModelState.IsValid是对一个实体的所有属性进行判断验证的。当时很纠结，因为刚接触Asp.net MVC，故没有找到解决方案。这篇文章将给出解决的办法。看下面需要验证的Model的代码如下：</p>


<div><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span>代码</span>
<div>
<pre><div><span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">class</span><span style="color:#000000"> UserViewModel<br>    {<br>        [DisplayName(</span><span style="color:#800000">"</span><span style="color:#800000">step</span><span style="color:#800000">"</span><span style="color:#000000">)]<br>        [Required(ErrorMessage </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">You must select a step .</span><span style="color:#800000">"</span><span style="color:#000000">)]<br>        </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">int</span><span style="color:#000000"> Step { </span><span style="color:#0000ff">get</span><span style="color:#000000">; </span><span style="color:#0000ff">set</span><span style="color:#000000">; }<br>        </span><span style="color:#008000">//</span><span style="color:#008000">个人信息</span><span style="color:#008000"><br></span><span style="color:#000000">        [Required(ErrorMessage </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">姓名不能为空</span><span style="color:#800000">"</span><span style="color:#000000">)]<br>        [StringLength(</span><span style="color:#800080">20</span><span style="color:#000000">, ErrorMessage </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">姓名长度不能超过20个字符</span><span style="color:#800000">"</span><span style="color:#000000">)]<br>        </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">string</span><span style="color:#000000"> Name { </span><span style="color:#0000ff">get</span><span style="color:#000000">; </span><span style="color:#0000ff">set</span><span style="color:#000000">; }<br><br>        [RegularExpression(</span><span style="color:#800000">@"</span><span style="color:#800000">120|((1[0-1]|\d)?\d)</span><span style="color:#800000">"</span><span style="color:#000000">, ErrorMessage </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">年龄格式不对</span><span style="color:#800000">"</span><span style="color:#000000">)]<br>        </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">int</span><span style="color:#000000">?</span><span style="color:#000000"> Age { </span><span style="color:#0000ff">get</span><span style="color:#000000">; </span><span style="color:#0000ff">set</span><span style="color:#000000">; }<br><br>        </span><span style="color:#008000">//</span><span style="color:#008000">职位信息</span><span style="color:#008000"><br></span><span style="color:#000000">        [Required(ErrorMessage </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">职位不能为空</span><span style="color:#800000">"</span><span style="color:#000000">)]<br>        </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">string</span><span style="color:#000000"> Post { </span><span style="color:#0000ff">get</span><span style="color:#000000">; </span><span style="color:#0000ff">set</span><span style="color:#000000">; }<br>        </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">int</span><span style="color:#000000">?</span><span style="color:#000000"> Salary { </span><span style="color:#0000ff">get</span><span style="color:#000000">; </span><span style="color:#0000ff">set</span><span style="color:#000000">; }<br><br>        </span><span style="color:#008000">//</span><span style="color:#008000">学历信息</span><span style="color:#008000"><br></span><span style="color:#000000">        [Required(ErrorMessage </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">毕业院校不能为空</span><span style="color:#800000">"</span><span style="color:#000000">)]<br>        </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">string</span><span style="color:#000000"> University { </span><span style="color:#0000ff">get</span><span style="color:#000000">; </span><span style="color:#0000ff">set</span><span style="color:#000000">; }<br>        </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">int</span><span style="color:#000000">?</span><span style="color:#000000"> GraduationYear { </span><span style="color:#0000ff">get</span><span style="color:#000000">; </span><span style="color:#0000ff">set</span><span style="color:#000000">; }<br><br>        </span><span style="color:#008000">//</span><span style="color:#008000">联系信息</span><span style="color:#008000"><br></span><span style="color:#000000">        [Required(ErrorMessage </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">邮件不能为空</span><span style="color:#800000">"</span><span style="color:#000000">)]<br>        [RegularExpression(</span><span style="color:#800000">@"</span><span style="color:#800000">^[a-z][a-z|0-9|]*([_][a-z|0-9]+)*([.][a-z|</span><span style="color:#800000">"</span><span style="color:#000000"> </span><span style="color:#000000">+</span><span style="color:#000000"> </span><span style="color:#800000">@"</span><span style="color:#800000">0-9]+([_][a-z|0-9]+)*)?@[a-z][a-z|0-9|]*\.([a-z]</span><span style="color:#800000">"</span><span style="color:#000000"> </span><span style="color:#000000">+</span><span style="color:#000000"> </span><span style="color:#800000">@"</span><span style="color:#800000">[a-z|0-9]*(\.[a-z][a-z|0-9]*)?)$</span><span style="color:#800000">"</span><span style="color:#000000">, ErrorMessage</span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">邮件格式不正确</span><span style="color:#800000">"</span><span style="color:#000000">)]<br>        </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">string</span><span style="color:#000000"> Email { </span><span style="color:#0000ff">get</span><span style="color:#000000">; </span><span style="color:#0000ff">set</span><span style="color:#000000">; }<br>        </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">int</span><span style="color:#000000">?</span><span style="color:#000000"> Mobile { </span><span style="color:#0000ff">get</span><span style="color:#000000">; </span><span style="color:#0000ff">set</span><span style="color:#000000">; }<br><br>        </span><span style="color:#0000ff">public</span><span style="color:#000000"> IEnumerable</span><span style="color:#000000">&lt;</span><span style="color:#000000">SelectListItem</span><span style="color:#000000">&gt;</span><span style="color:#000000"> StepList { </span><span style="color:#0000ff">get</span><span style="color:#000000">; </span><span style="color:#0000ff">set</span><span style="color:#000000">; }<br><br>        </span><span style="color:#0000ff">public</span><span style="color:#000000"> UserViewModel()<br>        {<br>            var list </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> List</span><span style="color:#000000">&lt;</span><span style="color:#000000">SelectListItem</span><span style="color:#000000">&gt;</span><span style="color:#000000">() {<br>                </span><span style="color:#0000ff">new</span><span style="color:#000000"> SelectListItem { Text </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">(Select)</span><span style="color:#800000">"</span><span style="color:#000000"> },<br>                </span><span style="color:#0000ff">new</span><span style="color:#000000"> SelectListItem { Value </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">1</span><span style="color:#800000">"</span><span style="color:#000000">, Text </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">Step1</span><span style="color:#800000">"</span><span style="color:#000000"> },<br>                </span><span style="color:#0000ff">new</span><span style="color:#000000"> SelectListItem { Value </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">2</span><span style="color:#800000">"</span><span style="color:#000000">, Text </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">Step2</span><span style="color:#800000">"</span><span style="color:#000000"> },<br>                </span><span style="color:#0000ff">new</span><span style="color:#000000"> SelectListItem { Value </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">3</span><span style="color:#800000">"</span><span style="color:#000000">, Text </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">Step3</span><span style="color:#800000">"</span><span style="color:#000000"> },<br>                </span><span style="color:#0000ff">new</span><span style="color:#000000"> SelectListItem { Value </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">4</span><span style="color:#800000">"</span><span style="color:#000000">, Text </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#800000">"</span><span style="color:#800000">Step4</span><span style="color:#800000">"</span><span style="color:#000000"> }<br>            };<br>            </span><span style="color:#0000ff">this</span><span style="color:#000000">.StepList </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> SelectList(list, </span><span style="color:#800000">"</span><span style="color:#800000">Value</span><span style="color:#800000">"</span><span style="color:#000000">, </span><span style="color:#800000">"</span><span style="color:#800000">Text</span><span style="color:#800000">"</span><span style="color:#000000">);<br>        }<br><br><br>    }</span></div></pre>
</div>
</div>


<p><strong>实现：</strong></p>


<p>    这篇文章这种情况服务端和客户端的验证都会讲到。为了简化起见，这里我除去的WF的流程功能，直接用下拉框表示，当下拉框选择step1表示填写第一步注册的信息，当下拉框选择step2表示填写第二步注册的信息，当下拉框选择step3表示填写第三步注册的信息，当下拉框选择step4表示填写第四步注册的信息。写得很啰嗦，但是这个很容易实现，我使用Jquery来显示和隐藏下拉框对应的Step。Jquery代码如下：</p>


<div><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span>代码</span>
<div>
<pre><div><span style="color:#000000">    </span><span style="color:#000000">&lt;</span><span style="color:#000000">script type</span><span style="color:#000000">=</span><span style="color:#000000">"</span><span style="color:#000000">text/javascript</span><span style="color:#000000">"</span><span style="color:#000000">&gt;</span><span style="color:#000000"><br>        $(</span><span style="color:#0000ff">function</span><span style="color:#000000"> () {<br>            $.fn.enable </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">function</span><span style="color:#000000"> () {<br>                </span><span style="color:#0000ff">return</span><span style="color:#000000"> </span><span style="color:#0000ff">this</span><span style="color:#000000">.show().removeAttr(</span><span style="color:#000000">"</span><span style="color:#000000">disabled</span><span style="color:#000000">"</span><span style="color:#000000">);<br>            }<br><br>            $.fn.disable </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">function</span><span style="color:#000000"> () {<br>                </span><span style="color:#0000ff">return</span><span style="color:#000000"> </span><span style="color:#0000ff">this</span><span style="color:#000000">.hide().attr(</span><span style="color:#000000">"</span><span style="color:#000000">disabled</span><span style="color:#000000">"</span><span style="color:#000000">, </span><span style="color:#000000">"</span><span style="color:#000000">disabled</span><span style="color:#000000">"</span><span style="color:#000000">);<br>            }<br>            </span><span style="color:#0000ff">var</span><span style="color:#000000"> dllStep </span><span style="color:#000000">=</span><span style="color:#000000"> $(</span><span style="color:#000000">"</span><span style="color:#000000">#Step</span><span style="color:#000000">"</span><span style="color:#000000">);<br>            </span><span style="color:#0000ff">var</span><span style="color:#000000"> step1 </span><span style="color:#000000">=</span><span style="color:#000000"> $(</span><span style="color:#000000">"</span><span style="color:#000000">#Step1,#Step1 input</span><span style="color:#000000">"</span><span style="color:#000000">);<br>            </span><span style="color:#0000ff">var</span><span style="color:#000000"> step2 </span><span style="color:#000000">=</span><span style="color:#000000"> $(</span><span style="color:#000000">"</span><span style="color:#000000">#Step2,#Step2 input</span><span style="color:#000000">"</span><span style="color:#000000">);<br>            </span><span style="color:#0000ff">var</span><span style="color:#000000"> step3 </span><span style="color:#000000">=</span><span style="color:#000000"> $(</span><span style="color:#000000">"</span><span style="color:#000000">#Step3,#Step3 input</span><span style="color:#000000">"</span><span style="color:#000000">);<br>            </span><span style="color:#0000ff">var</span><span style="color:#000000"> step4 </span><span style="color:#000000">=</span><span style="color:#000000"> $(</span><span style="color:#000000">"</span><span style="color:#000000">#Step4,#Step4 input</span><span style="color:#000000">"</span><span style="color:#000000">);<br>            setControls();<br><br>            dllStep.change(</span><span style="color:#0000ff">function</span><span style="color:#000000"> () {<br>                setControls();<br>            });<br><br>            </span><span style="color:#0000ff">function</span><span style="color:#000000"> setControls() {<br>                </span><span style="color:#0000ff">switch</span><span style="color:#000000"> (dllStep.val()) {<br>                    </span><span style="color:#0000ff">case</span><span style="color:#000000"> </span><span style="color:#000000">"</span><span style="color:#000000">1</span><span style="color:#000000">"</span><span style="color:#000000">: <br>                        step1.enable();<br>                        step2.disable();<br>                        step3.disable();<br>                        step4.disable();<br>                        </span><span style="color:#0000ff">break</span><span style="color:#000000">;<br>                    </span><span style="color:#0000ff">case</span><span style="color:#000000"> </span><span style="color:#000000">"</span><span style="color:#000000">2</span><span style="color:#000000">"</span><span style="color:#000000">: <br>                        step1.disable();<br>                        step2.enable();<br>                        step3.disable();<br>                        step4.disable();<br>                        </span><span style="color:#0000ff">break</span><span style="color:#000000">;<br>                    </span><span style="color:#0000ff">case</span><span style="color:#000000"> </span><span style="color:#000000">"</span><span style="color:#000000">3</span><span style="color:#000000">"</span><span style="color:#000000">:<br>                        step1.disable();<br>                        step2.disable();<br>                        step3.enable();<br>                        step4.disable();<br>                        </span><span style="color:#0000ff">break</span><span style="color:#000000">;<br>                    </span><span style="color:#0000ff">case</span><span style="color:#000000"> </span><span style="color:#000000">"</span><span style="color:#000000">4</span><span style="color:#000000">"</span><span style="color:#000000">: <br>                        step1.disable();<br>                        step2.disable();<br>                        step3.disable();<br>                        step4.enable();<br>                        </span><span style="color:#0000ff">break</span><span style="color:#000000">;<br>                    </span><span style="color:#0000ff">case</span><span style="color:#000000"> </span><span style="color:#000000">""</span><span style="color:#000000">: <br>                        step1.disable();<br>                        step2.disable();<br>                        step3.disable();<br>                        step4.disable();<br>                        </span><span style="color:#0000ff">break</span><span style="color:#000000">;<br>                }<br>            }<br>        });<br>    </span><span style="color:#000000">&lt;</span><span style="color:#000000">/</span><span style="color:#000000">script&gt;</span></div></pre>
</div>
</div>


<p>如下图：</p>


<p><img src="http://pic002.cnblogs.com/images/2010/38542/2010092700090815.png" alt=""></p>


<p>第一步：填写姓名和年龄。</p>


<p><img src="http://pic002.cnblogs.com/images/2010/38542/2010092700092071.png" alt=""></p>


<p> 第二步：填写职位和薪水</p>


<p><img src="http://pic002.cnblogs.com/images/2010/38542/2010092700093673.png" alt=""></p>


<p> 第三步填写：毕业院校和毕业时间</p>


<p><img src="http://pic002.cnblogs.com/images/2010/38542/2010092700094970.png" alt=""></p>


<p>第四步填写：邮箱和电话</p>


<p><img src="http://pic002.cnblogs.com/images/2010/38542/2010092700095849.png" alt=""></p>


<p>    为了实现这样的验证，我们可以将验证的错误信息中移除不在当前步骤填写的字段的错误信息，写一个类InputValidationModelBinder继承DefaultModelBinder并重载OnModelUpdated方法，将不必要的错误信息清除，代码如下：</p>


<div>
<pre><div><span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">class</span><span style="color:#000000"> InputValidationModelBinder : DefaultModelBinder<br>    {<br>        </span><span style="color:#0000ff">protected</span><span style="color:#000000"> </span><span style="color:#0000ff">override</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> OnModelUpdated(ControllerContext controllerContext, ModelBindingContext bindingContext)<br>        {<br>            var modelState </span><span style="color:#000000">=</span><span style="color:#000000"> controllerContext.Controller.ViewData.ModelState;<br>            var valueProvider </span><span style="color:#000000">=</span><span style="color:#000000"> controllerContext.Controller.ValueProvider;<br><br>            var keysWithNoIncomingValue </span><span style="color:#000000">=</span><span style="color:#000000"> modelState.Keys.Where(x </span><span style="color:#000000">=&gt;</span><span style="color:#000000"> </span><span style="color:#000000">!</span><span style="color:#000000">valueProvider.ContainsPrefix(x));<br>            </span><span style="color:#0000ff">foreach</span><span style="color:#000000"> (var key </span><span style="color:#0000ff">in</span><span style="color:#000000"> keysWithNoIncomingValue)<br>                modelState[key].Errors.Clear();<br>        }<br>    }</span></div></pre>
</div>


<p>     上面是服务端的代码，对于客户端，我们都知道asp.net MVC客户端验证时通过MicrosoftMvcValidation.js去实现的。看下面代码。</p>


<div>
<pre><div><span style="color:#008080"> 1</span> <span style="color:#000000">    validate: </span><span style="color:#0000ff">function</span><span style="color:#000000"> Sys_Mvc_FormContext$validate(eventName) {<br></span><span style="color:#008080"> 2</span> <span style="color:#000000">        </span><span style="color:#0000ff">var</span><span style="color:#000000"> fields </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">this</span><span style="color:#000000">.fields;<br></span><span style="color:#008080"> 3</span> <span style="color:#000000">        </span><span style="color:#0000ff">var</span><span style="color:#000000"> errors </span><span style="color:#000000">=</span><span style="color:#000000"> [];<br></span><span style="color:#008080"> 4</span> <span style="color:#000000">        </span><span style="color:#0000ff">for</span><span style="color:#000000"> (</span><span style="color:#0000ff">var</span><span style="color:#000000"> i </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#000000">0</span><span style="color:#000000">; i </span><span style="color:#000000">&lt;</span><span style="color:#000000"> fields.length; i</span><span style="color:#000000">++</span><span style="color:#000000">) {<br></span><span style="color:#008080"> 5</span> <span style="color:#000000">            </span><span style="color:#0000ff">var</span><span style="color:#000000"> field </span><span style="color:#000000">=</span><span style="color:#000000"> fields[i];<br></span><span style="color:#008080"> 6</span> <span style="color:#000000">            </span><span style="color:#0000ff">if</span><span style="color:#000000"> (</span><span style="color:#000000">!</span><span style="color:#000000">field.elements[</span><span style="color:#000000">0</span><span style="color:#000000">].disabled) {<br></span><span style="color:#008080"> 7</span> <span style="color:#000000">                </span><span style="color:#0000ff">var</span><span style="color:#000000"> thisErrors </span><span style="color:#000000">=</span><span style="color:#000000"> field.validate(eventName);<br></span><span style="color:#008080"> 8</span> <span style="color:#000000">                </span><span style="color:#0000ff">if</span><span style="color:#000000"> (thisErrors) {<br></span><span style="color:#008080"> 9</span> <span style="color:#000000">                    Array.addRange(errors, thisErrors);<br></span><span style="color:#008080">10</span> <span style="color:#000000">                }<br></span><span style="color:#008080">11</span> <span style="color:#000000">            }<br></span><span style="color:#008080">12</span> <span style="color:#000000">        }<br></span><span style="color:#008080">13</span> <span style="color:#000000">        </span><span style="color:#0000ff">if</span><span style="color:#000000"> (</span><span style="color:#0000ff">this</span><span style="color:#000000">.replaceValidationSummary) {<br></span><span style="color:#008080">14</span> <span style="color:#000000">            </span><span style="color:#0000ff">this</span><span style="color:#000000">.clearErrors();<br></span><span style="color:#008080">15</span> <span style="color:#000000">            </span><span style="color:#0000ff">this</span><span style="color:#000000">.addErrors(errors);<br></span><span style="color:#008080">16</span> <span style="color:#000000">        }<br></span><span style="color:#008080">17</span> <span style="color:#000000">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> errors;<br></span><span style="color:#008080">18</span> <span style="color:#000000">    }<br></span><span style="color:#008080">19</span> <span style="color:#000000">}</span></div></pre>
</div>


<p>在第6行代码加入了一句判断：当页面的元素没有被disabled的时候才去验证。</p>


<p>好了这样就实现了一次只对Model中的几个属性字段进行验证。</p>


<p><strong>运行：</strong></p>


<p>asp.net mvc的验证机制只对model中当前页面的属性进行验证：</p>


<p><img src="http://pic002.cnblogs.com/images/2010/38542/2010092700082028.png" alt=""></p>


<p>填写正确通过验证：</p>


<p><img src="http://pic002.cnblogs.com/images/2010/38542/2010092700084937.png" alt=""></p>


<p><strong>总结：</strong>本文解决了我之前遗留下来的一个问题。实现了在ASP.NET MVC中对Model进行多步验证。希望对你有所帮助，如果你有更好的方法，欢迎给我留言。 </p>


<p><img src="http://www.cnblogs.com/zhuqil/aggbug/1836359.html?type=1" width="1" height="1" alt=""><p>评论: 3　<a href="http://www.cnblogs.com/zhuqil/archive/2010/09/27/Mvc-Validation.html#pagedcomment">查看评论</a>　<a href="http://www.cnblogs.com/zhuqil/archive/2010/09/27/Mvc-Validation.html#commentform">发表评论</a></p><p><a href="http://job.cnblogs.com/">程序员找工作，就在博客园</a></p><hr><p>最新新闻：<br>· <a href="http://news.cnblogs.com/n/75716/">阿里巴巴推出2011版出口通产品</a><span style="color:gray">(2010-09-27 20:56)</span><br>· <a href="http://news.cnblogs.com/n/75715/">腾讯声明：QQ没窥探隐私 扫描文件是监测木马</a><span style="color:gray">(2010-09-27 20:43)</span><br>· <a href="http://news.cnblogs.com/n/75711/">Chrome OS 御用新字体降临！</a><span style="color:gray">(2010-09-27 20:34)</span><br>· <a href="http://news.cnblogs.com/n/75712/">外媒称腾讯势不可挡 称霸国际指日可待</a><span style="color:gray">(2010-09-27 20:29)</span><br>· <a href="http://news.cnblogs.com/n/75709/">汉王设台湾营销平台 将促两岸网络书城合作</a><span style="color:gray">(2010-09-27 20:24)</span><br></p><p>编辑推荐：<a href="http://news.cnblogs.com/n/75635/">360向腾讯宣战：新推软件直指QQ侵犯用户隐私</a><br></p><p>网站导航：<a href="http://www.cnblogs.com">博客园首页</a>  <a href="http://home.cnblogs.com/">个人主页</a>  <a href="http://news.cnblogs.com">新闻</a>  <a href="http://home.cnblogs.com/ing/">闪存</a>  <a href="http://home.cnblogs.com/group/">小组</a>  <a href="http://space.cnblogs.com/q/">博问</a>  <a href="http://space.cnblogs.com">社区</a>  <a href="http://kb.cnblogs.com">知识库</a></p></p>

</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/yourusername/">github.com/yourusername</a><br />
                  <a href="http://twitter.com/yourusername/">twitter.com/yourusername</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
