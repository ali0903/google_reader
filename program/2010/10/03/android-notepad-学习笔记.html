<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>android notepad 学习笔记</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/">Your New Jekyll Site</a></h1>
              <a class="extra" href="/">home</a>
            </div>

                <h2>android notepad 学习笔记</h2>
<p class="meta">03 Oct 2010</p>

<div class="post">
<h2>android notepad 学习笔记</h2>

<h3>by wellen Liang</h3>

<h3>at 2010-10-02 16:12:00</h3>

<h3>original <a href="http://www.cnblogs.com/wellen/archive/2010/10/02/1841344.html">http://www.cnblogs.com/wellen/archive/2010/10/02/1841344.html</a></h3>

<p><a href="http://www.cnblogs.com/wellen/"><img src="http://pic.cnblogs.com/face/u154331.jpg" alt="" border="0"></a><br>作者: <a href="http://www.cnblogs.com/wellen/">wellen Liang</a> 发表于 2010-10-02 16:12 <a href="http://www.cnblogs.com/wellen/archive/2010/10/02/1841344.html">原文链接</a> 阅读: 548 评论: 1</p>


<p>      很久就想学习android SDK 里面自带的例子Notepad,趁着国庆休息的时间，我就学习一下吧。</p>


<p>      首先，我们要学习一个就是android 下的数据库的建立，我们的笔记是需要用数据库来保存数据的。这里我们就需要建立一个数据库，我们定义数据库的名字为data ，数据库里只有一张数据表，表名为：notes ，这个表有三个属性，属性名：id,title ,body 。看到这三个属性估计就知道了ID 作为每个记录的标示ID，所以作为主键；Title为一条记录的标题，body作为记录的文本主题。</p>


<p>     要使用数据库，android内置一个很小型的数据库 SQLite.那么我们就需要建立一个对SQLite 建立的数据库的操作的类。我们建立一个SQLDbAdapter类。定义相关的属性</p>


<p>     android内有一个针对SQLite的操作类SQLiteOpenHelper 类。这个类主要是用来负责对﻿﻿数据库创建、管理版本。</p>


<p>     这里我们定义了对数据库的CRUD 操作。这样我们就有了对数据库的操作的相关的操作类，代码如下所示：</p>


<p> </p>


<div style="width:967px;height:3102px"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span>代码</span>
<div>
<pre><div><span style="color:#008080">  1</span> <span style="color:#0000ff">package</span><span style="color:#000000"> com.wellen;<br></span><span style="color:#008080">  2</span> <span style="color:#000000"><br></span><span style="color:#008080">  3</span> <span style="color:#000000"> </span><span style="color:#0000ff">import</span><span style="color:#000000"> android.content.ContentValues;<br></span><span style="color:#008080">  4</span> <span style="color:#000000"> </span><span style="color:#0000ff">import</span><span style="color:#000000"> android.content.Context;<br></span><span style="color:#008080">  5</span> <span style="color:#000000"> </span><span style="color:#0000ff">import</span><span style="color:#000000"> android.database.Cursor;<br></span><span style="color:#008080">  6</span> <span style="color:#0000ff">import</span><span style="color:#000000"> android.database.SQLException;<br></span><span style="color:#008080">  7</span> <span style="color:#0000ff">import</span><span style="color:#000000"> android.database.sqlite.SQLiteDatabase;<br></span><span style="color:#008080">  8</span> <span style="color:#0000ff">import</span><span style="color:#000000"> android.database.sqlite.SQLiteOpenHelper;<br></span><span style="color:#008080">  9</span> <span style="color:#0000ff">import</span><span style="color:#000000"> android.util.Log;<br></span><span style="color:#008080"> 10</span> <span style="color:#000000"><br></span><span style="color:#008080"> 11</span> <span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">class</span><span style="color:#000000"> NotePadDBAdapter {<br></span><span style="color:#008080"> 12</span> <span style="color:#000000">    <br></span><span style="color:#008080"> 13</span> <span style="color:#000000">    </span><span style="color:#0000ff">private</span><span style="color:#000000"> </span><span style="color:#0000ff">static</span><span style="color:#000000"> </span><span style="color:#0000ff">final</span><span style="color:#000000"> String TAG </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#000000">"</span><span style="color:#000000">NotesDBAdapter</span><span style="color:#000000">"</span><span style="color:#000000">;<br></span><span style="color:#008080"> 14</span> <span style="color:#000000">    <br></span><span style="color:#008080"> 15</span> <span style="color:#000000">    </span><span style="color:#008000">/**</span><span style="color:#008000"><br></span><span style="color:#008080"> 16</span> <span style="color:#008000">     * 数据库表的相关属性 <br></span><span style="color:#008080"> 17</span> <span style="color:#008000">     </span><span style="color:#008000">*/</span><span style="color:#000000"><br></span><span style="color:#008080"> 18</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">static</span><span style="color:#000000"> </span><span style="color:#0000ff">final</span><span style="color:#000000"> String KEY_TITLE </span><span style="color:#000000">=</span><span style="color:#000000">"</span><span style="color:#000000">title</span><span style="color:#000000">"</span><span style="color:#000000">;<br></span><span style="color:#008080"> 19</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">static</span><span style="color:#000000"> </span><span style="color:#0000ff">final</span><span style="color:#000000"> String KEY_BODY </span><span style="color:#000000">=</span><span style="color:#000000">"</span><span style="color:#000000">body</span><span style="color:#000000">"</span><span style="color:#000000">;<br></span><span style="color:#008080"> 20</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">static</span><span style="color:#000000"> </span><span style="color:#0000ff">final</span><span style="color:#000000"> String KEY_ROWID </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#000000">"_</span><span style="color:#000000">id</span><span style="color:#000000">"</span><span style="color:#000000">;<br></span><span style="color:#008080"> 21</span> <span style="color:#000000">    <br></span><span style="color:#008080"> 22</span> <span style="color:#000000">    </span><span style="color:#008000">/**</span><span style="color:#008000"><br></span><span style="color:#008080"> 23</span> <span style="color:#008000">     * 数据库及数据表名<br></span><span style="color:#008080"> 24</span> <span style="color:#008000">     </span><span style="color:#008000">*/</span><span style="color:#000000"><br></span><span style="color:#008080"> 25</span> <span style="color:#000000">    </span><span style="color:#0000ff">private</span><span style="color:#000000"> </span><span style="color:#0000ff">static</span><span style="color:#000000"> </span><span style="color:#0000ff">final</span><span style="color:#000000"> String DATABASE_NAME </span><span style="color:#000000">=</span><span style="color:#000000">"</span><span style="color:#000000">data</span><span style="color:#000000">"</span><span style="color:#000000">;<br></span><span style="color:#008080"> 26</span> <span style="color:#000000">    </span><span style="color:#0000ff">private</span><span style="color:#000000"> </span><span style="color:#0000ff">static</span><span style="color:#000000"> </span><span style="color:#0000ff">final</span><span style="color:#000000"> String DATABASE_TABLE </span><span style="color:#000000">=</span><span style="color:#000000">"</span><span style="color:#000000">notes</span><span style="color:#000000">"</span><span style="color:#000000">;<br></span><span style="color:#008080"> 27</span> <span style="color:#000000">    </span><span style="color:#0000ff">private</span><span style="color:#000000"> </span><span style="color:#0000ff">static</span><span style="color:#000000"> </span><span style="color:#0000ff">final</span><span style="color:#000000"> </span><span style="color:#0000ff">int</span><span style="color:#000000"> DATABASE_VERSION </span><span style="color:#000000">=</span><span style="color:#000000">2</span><span style="color:#000000">;<br></span><span style="color:#008080"> 28</span> <span style="color:#000000">    <br></span><span style="color:#008080"> 29</span> <span style="color:#000000">    </span><span style="color:#008000">/**</span><span style="color:#008000"><br></span><span style="color:#008080"> 30</span> <span style="color:#008000">     * 创建数据库的SQL语句<br></span><span style="color:#008080"> 31</span> <span style="color:#008000">     </span><span style="color:#008000">*/</span><span style="color:#000000"><br></span><span style="color:#008080"> 32</span> <span style="color:#000000">    </span><span style="color:#0000ff">private</span><span style="color:#000000"> </span><span style="color:#0000ff">static</span><span style="color:#000000"> </span><span style="color:#0000ff">final</span><span style="color:#000000"> String DATABASE_CREATE </span><span style="color:#000000">=</span><span style="color:#000000">"</span><span style="color:#000000">create table notes (_id integer primary key autoincrement ,</span><span style="color:#000000">"</span><span style="color:#000000"> </span><span style="color:#000000">+</span><span style="color:#000000"><br></span><span style="color:#008080"> 33</span> <span style="color:#000000">                                                                     </span><span style="color:#000000">"</span><span style="color:#000000"> title text not null ,</span><span style="color:#000000">"</span><span style="color:#000000"> </span><span style="color:#000000">+</span><span style="color:#000000"><br></span><span style="color:#008080"> 34</span> <span style="color:#000000">                                                                     </span><span style="color:#000000">"</span><span style="color:#000000"> body text not null);</span><span style="color:#000000">"</span><span style="color:#000000">;<br></span><span style="color:#008080"> 35</span> <span style="color:#000000">    <br></span><span style="color:#008080"> 36</span> <span style="color:#000000">    </span><span style="color:#0000ff">private</span><span style="color:#000000"> </span><span style="color:#0000ff">final</span><span style="color:#000000"> Context mCtx;<br></span><span style="color:#008080"> 37</span> <span style="color:#000000">    <br></span><span style="color:#008080"> 38</span> <span style="color:#000000">    </span><span style="color:#0000ff">private</span><span style="color:#000000"> DatabaseHelper mDbHelper;<br></span><span style="color:#008080"> 39</span> <span style="color:#000000">    </span><span style="color:#008000">/**</span><span style="color:#008000"><br></span><span style="color:#008080"> 40</span> <span style="color:#008000">     * 数据库的操作类对象<br></span><span style="color:#008080"> 41</span> <span style="color:#008000">     </span><span style="color:#008000">*/</span><span style="color:#000000"><br></span><span style="color:#008080"> 42</span> <span style="color:#000000">    </span><span style="color:#0000ff">private</span><span style="color:#000000"> SQLiteDatabase mDb;<br></span><span style="color:#008080"> 43</span> <span style="color:#000000">    <br></span><span style="color:#008080"> 44</span> <span style="color:#000000">    </span><span style="color:#008000">/**</span><span style="color:#008000"> <br></span><span style="color:#008080"> 45</span> <span style="color:#008000">     * 这个类用来对数据库创建和数据库版本管理的类。<br></span><span style="color:#008080"> 46</span> <span style="color:#008000">     * </span><span style="color:#808080">@author</span><span style="color:#008000"> wellen<br></span><span style="color:#008080"> 47</span> <span style="color:#008000">     *<br></span><span style="color:#008080"> 48</span> <span style="color:#008000">     </span><span style="color:#008000">*/</span><span style="color:#000000"><br></span><span style="color:#008080"> 49</span> <span style="color:#000000">    </span><span style="color:#0000ff">private</span><span style="color:#000000"> </span><span style="color:#0000ff">static</span><span style="color:#000000"> </span><span style="color:#0000ff">class</span><span style="color:#000000"> DatabaseHelper </span><span style="color:#0000ff">extends</span><span style="color:#000000"> SQLiteOpenHelper{<br></span><span style="color:#008080"> 50</span> <span style="color:#000000">         DatabaseHelper(Context context){<br></span><span style="color:#008080"> 51</span> <span style="color:#000000">             </span><span style="color:#0000ff">super</span><span style="color:#000000">(context, DATABASE_NAME, </span><span style="color:#0000ff">null</span><span style="color:#000000">, DATABASE_VERSION);<br></span><span style="color:#008080"> 52</span> <span style="color:#000000">         }<br></span><span style="color:#008080"> 53</span> <span style="color:#000000">         <br></span><span style="color:#008080"> 54</span> <span style="color:#000000">    </span><span style="color:#008000">/**</span><span style="color:#008000"><br></span><span style="color:#008080"> 55</span> <span style="color:#008000">     * 在这个类创建的时候调用创建数据库<br></span><span style="color:#008080"> 56</span> <span style="color:#008000">     </span><span style="color:#008000">*/</span><span style="color:#000000"><br></span><span style="color:#008080"> 57</span> <span style="color:#000000">    @Override<br></span><span style="color:#008080"> 58</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> onCreate(SQLiteDatabase db) {<br></span><span style="color:#008080"> 59</span> <span style="color:#000000">            db.execSQL(DATABASE_CREATE);<br></span><span style="color:#008080"> 60</span> <span style="color:#000000">        }<br></span><span style="color:#008080"> 61</span> <span style="color:#000000"><br></span><span style="color:#008080"> 62</span> <span style="color:#000000">    </span><span style="color:#008000">/**</span><span style="color:#008000"><br></span><span style="color:#008080"> 63</span> <span style="color:#008000">     * 数据库版本更新<br></span><span style="color:#008080"> 64</span> <span style="color:#008000">     </span><span style="color:#008000">*/</span><span style="color:#000000"><br></span><span style="color:#008080"> 65</span> <span style="color:#000000">    @Override<br></span><span style="color:#008080"> 66</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> onUpgrade(SQLiteDatabase db, </span><span style="color:#0000ff">int</span><span style="color:#000000"> oldVersion, </span><span style="color:#0000ff">int</span><span style="color:#000000"> newVersion) {<br></span><span style="color:#008080"> 67</span> <span style="color:#000000"><br></span><span style="color:#008080"> 68</span> <span style="color:#000000">            Log.w(TAG, </span><span style="color:#000000">"</span><span style="color:#000000">Upgrading database from version</span><span style="color:#000000">"</span><span style="color:#000000">+</span><span style="color:#000000"> oldVersion </span><span style="color:#000000">+</span><span style="color:#000000"> </span><span style="color:#000000">"</span><span style="color:#000000">to </span><span style="color:#000000">"</span><span style="color:#000000">+</span><span style="color:#000000"> newVersion </span></div><div><span style="color:#000000">                       </span><span style="color:#000000">+</span><span style="color:#000000">"</span><span style="color:#000000">, which will destroy all old data</span><span style="color:#000000">"</span><span style="color:#000000">);<br></span><span style="color:#008080"> 69</span> <span style="color:#000000">            <br></span><span style="color:#008080"> 70</span> <span style="color:#000000">            db.execSQL(</span><span style="color:#000000">"</span><span style="color:#000000">DROP TABLE IF　EXISTS notes</span><span style="color:#000000">"</span><span style="color:#000000">);<br></span><span style="color:#008080"> 71</span> <span style="color:#000000">            onCreate(db);<br></span><span style="color:#008080"> 72</span> <span style="color:#000000">        }<br></span><span style="color:#008080"> 73</span> <span style="color:#000000">    }<br></span><span style="color:#008080"> 74</span> <span style="color:#000000">    <br></span><span style="color:#008080"> 75</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> NotePadDBAdapter(Context ctx){<br></span><span style="color:#008080"> 76</span> <span style="color:#000000">        </span><span style="color:#0000ff">this</span><span style="color:#000000">.mCtx </span><span style="color:#000000">=</span><span style="color:#000000"> ctx;<br></span><span style="color:#008080"> 77</span> <span style="color:#000000">    }<br></span><span style="color:#008080"> 78</span> <span style="color:#000000">    <br></span><span style="color:#008080"> 79</span> <span style="color:#000000">    </span><span style="color:#008000">/**</span><span style="color:#008000"><br></span><span style="color:#008080"> 80</span> <span style="color:#008000">     * 数据库打开<br></span><span style="color:#008080"> 81</span> <span style="color:#008000">     * </span><span style="color:#808080">@return</span><span style="color:#008000"><br></span><span style="color:#008080"> 82</span> <span style="color:#008000">     * </span><span style="color:#808080">@throws</span><span style="color:#008000"> SQLException<br></span><span style="color:#008080"> 83</span> <span style="color:#008000">     </span><span style="color:#008000">*/</span><span style="color:#000000"><br></span><span style="color:#008080"> 84</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> NotePadDBAdapter open()</span><span style="color:#0000ff">throws</span><span style="color:#000000"> SQLException{<br></span><span style="color:#008080"> 85</span> <span style="color:#000000">        mDbHelper </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> DatabaseHelper(mCtx);<br></span><span style="color:#008080"> 86</span> <span style="color:#000000">        mDb </span><span style="color:#000000">=</span><span style="color:#000000"> mDbHelper.getWritableDatabase();<br></span><span style="color:#008080"> 87</span> <span style="color:#000000">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> </span><span style="color:#0000ff">this</span><span style="color:#000000">;<br></span><span style="color:#008080"> 88</span> <span style="color:#000000">    }<br></span><span style="color:#008080"> 89</span> <span style="color:#000000"><br></span><span style="color:#008080"> 90</span> <span style="color:#000000">    </span><span style="color:#008000">/**</span><span style="color:#008000"><br></span><span style="color:#008080"> 91</span> <span style="color:#008000">     * 数据关闭<br></span><span style="color:#008080"> 92</span> <span style="color:#008000">     </span><span style="color:#008000">*/</span><span style="color:#000000"><br></span><span style="color:#008080"> 93</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> close(){<br></span><span style="color:#008080"> 94</span> <span style="color:#000000">        mDbHelper.close();<br></span><span style="color:#008080"> 95</span> <span style="color:#000000">    }<br></span><span style="color:#008080"> 96</span> <span style="color:#000000">    <br></span><span style="color:#008080"> 97</span> <span style="color:#000000">    </span><span style="color:#008000">/**</span><span style="color:#008000"><br></span><span style="color:#008080"> 98</span> <span style="color:#008000">     * 添加一条笔记记录<br></span><span style="color:#008080"> 99</span> <span style="color:#008000">     * </span><span style="color:#808080">@param</span><span style="color:#008000"> title 标题<br></span><span style="color:#008080">100</span> <span style="color:#008000">     * </span><span style="color:#808080">@param</span><span style="color:#008000"> body  内容<br></span><span style="color:#008080">101</span> <span style="color:#008000">     * </span><span style="color:#808080">@return</span><span style="color:#008000"> 记录的ID<br></span><span style="color:#008080">102</span> <span style="color:#008000">     </span><span style="color:#008000">*/</span><span style="color:#000000"><br></span><span style="color:#008080">103</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">long</span><span style="color:#000000"> createNote(String title , String body){<br></span><span style="color:#008080">104</span> <span style="color:#000000">        ContentValues initialValues </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> ContentValues();<br></span><span style="color:#008080">105</span> <span style="color:#000000">        initialValues.put(KEY_TITLE, title);<br></span><span style="color:#008080">106</span> <span style="color:#000000">        initialValues.put(KEY_BODY, body);<br></span><span style="color:#008080">107</span> <span style="color:#000000">        <br></span><span style="color:#008080">108</span> <span style="color:#000000">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> mDb.insert(DATABASE_TABLE, </span><span style="color:#0000ff">null</span><span style="color:#000000">, initialValues);<br></span><span style="color:#008080">109</span> <span style="color:#000000">    }<br></span><span style="color:#008080">110</span> <span style="color:#000000">    <br></span><span style="color:#008080">111</span> <span style="color:#000000">    </span><span style="color:#008000">/**</span><span style="color:#008000"><br></span><span style="color:#008080">112</span> <span style="color:#008000">     * 通过记录的ID 进行删除某条记事本记录<br></span><span style="color:#008080">113</span> <span style="color:#008000">     * </span><span style="color:#808080">@param</span><span style="color:#008000"> rowId 要删除的记录的ID<br></span><span style="color:#008080">114</span> <span style="color:#008000">     * </span><span style="color:#808080">@return</span><span style="color:#008000"> 是否成功删除<br></span><span style="color:#008080">115</span> <span style="color:#008000">     </span><span style="color:#008000">*/</span><span style="color:#000000"><br></span><span style="color:#008080">116</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">boolean</span><span style="color:#000000"> deleteNote(</span><span style="color:#0000ff">long</span><span style="color:#000000"> rowId){<br></span><span style="color:#008080">117</span> <span style="color:#000000">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> mDb.delete(DATABASE_TABLE, KEY_ROWID</span><span style="color:#000000">+</span><span style="color:#000000">"</span><span style="color:#000000">=</span><span style="color:#000000">"</span><span style="color:#000000">+</span><span style="color:#000000">rowId, </span><span style="color:#0000ff">null</span><span style="color:#000000">) </span><span style="color:#000000">&gt;</span><span style="color:#000000">0</span><span style="color:#000000">;<br></span><span style="color:#008080">118</span> <span style="color:#000000">    } <br></span><span style="color:#008080">119</span> <span style="color:#000000">    <br></span><span style="color:#008080">120</span> <span style="color:#000000">    </span><span style="color:#008000">/**</span><span style="color:#008000"><br></span><span style="color:#008080">121</span> <span style="color:#008000">     * 查询所有数据库表中的记录<br></span><span style="color:#008080">122</span> <span style="color:#008000">     * </span><span style="color:#808080">@return</span><span style="color:#008000"><br></span><span style="color:#008080">123</span> <span style="color:#008000">     </span><span style="color:#008000">*/</span><span style="color:#000000"><br></span><span style="color:#008080">124</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> Cursor fetchAllNotes(){<br></span><span style="color:#008080">125</span> <span style="color:#000000">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> mDb.query(DATABASE_TABLE, </span><span style="color:#0000ff">new</span><span style="color:#000000"> String[]{KEY_ROWID , KEY_TITLE , KEY_BODY}, </span><span style="color:#0000ff">null</span><span style="color:#000000">, </span><span style="color:#0000ff">null</span><span style="color:#000000">, </span><span style="color:#0000ff">null</span><span style="color:#000000">, </span><span style="color:#0000ff">null</span><span style="color:#000000">, </span><span style="color:#0000ff">null</span><span style="color:#000000">);<br></span><span style="color:#008080">126</span> <span style="color:#000000">    }<br></span><span style="color:#008080">127</span> <span style="color:#000000">    </span><span style="color:#008000">/**</span><span style="color:#008000"><br></span><span style="color:#008080">128</span> <span style="color:#008000">     * 通过某条记录的ID查询出这个记录的所有的信息<br></span><span style="color:#008080">129</span> <span style="color:#008000">     * </span><span style="color:#808080">@param</span><span style="color:#008000"> rowId<br></span><span style="color:#008080">130</span> <span style="color:#008000">     * </span><span style="color:#808080">@return</span><span style="color:#008000"><br></span><span style="color:#008080">131</span> <span style="color:#008000">     * </span><span style="color:#808080">@throws</span><span style="color:#008000"> SQLException<br></span><span style="color:#008080">132</span> <span style="color:#008000">     </span><span style="color:#008000">*/</span><span style="color:#000000"><br></span><span style="color:#008080">133</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> Cursor fetchNote(</span><span style="color:#0000ff">long</span><span style="color:#000000"> rowId)</span><span style="color:#0000ff">throws</span><span style="color:#000000"> SQLException{<br></span><span style="color:#008080">134</span> <span style="color:#000000">        Cursor mCursor </span><span style="color:#000000">=</span><span style="color:#000000"> mDb.query(</span><span style="color:#0000ff">true</span><span style="color:#000000">, DATABASE_TABLE, </span><span style="color:#0000ff">new</span><span style="color:#000000"> String[]{KEY_ROWID , KEY_TITLE , KEY_BODY}, KEY_ROWID</span><span style="color:#000000">+</span><span style="color:#000000">"</span><span style="color:#000000">=</span><span style="color:#000000">"</span><span style="color:#000000">+</span><span style="color:#000000">rowId, </span><span style="color:#0000ff">null</span><span style="color:#000000">, </span><span style="color:#0000ff">null</span><span style="color:#000000">, </span><span style="color:#0000ff">null</span><span style="color:#000000">, </span><span style="color:#0000ff">null</span><span style="color:#000000">, </span><span style="color:#0000ff">null</span><span style="color:#000000">);<br></span><span style="color:#008080">135</span> <span style="color:#000000">        <br></span><span style="color:#008080">136</span> <span style="color:#000000">        </span><span style="color:#0000ff">if</span><span style="color:#000000">(mCursor </span><span style="color:#000000">!=</span><span style="color:#000000"> </span><span style="color:#0000ff">null</span><span style="color:#000000">){<br></span><span style="color:#008080">137</span> <span style="color:#000000">            mCursor.moveToFirst();<br></span><span style="color:#008080">138</span> <span style="color:#000000">        }<br></span><span style="color:#008080">139</span> <span style="color:#000000">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> mCursor;<br></span><span style="color:#008080">140</span> <span style="color:#000000">    }<br></span><span style="color:#008080">141</span> <span style="color:#000000">    <br></span><span style="color:#008080">142</span> <span style="color:#000000">    </span><span style="color:#008000">/**</span><span style="color:#008000"><br></span><span style="color:#008080">143</span> <span style="color:#008000">     * 通过这条记录的ID，来更新 这条 记录的相关的信息<br></span><span style="color:#008080">144</span> <span style="color:#008000">     * </span><span style="color:#808080">@param</span><span style="color:#008000"> rowId<br></span><span style="color:#008080">145</span> <span style="color:#008000">     * </span><span style="color:#808080">@param</span><span style="color:#008000"> title<br></span><span style="color:#008080">146</span> <span style="color:#008000">     * </span><span style="color:#808080">@param</span><span style="color:#008000"> body<br></span><span style="color:#008080">147</span> <span style="color:#008000">     * </span><span style="color:#808080">@return</span><span style="color:#008000"><br></span><span style="color:#008080">148</span> <span style="color:#008000">     </span><span style="color:#008000">*/</span><span style="color:#000000"><br></span><span style="color:#008080">149</span> <span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">boolean</span><span style="color:#000000"> updataNote(</span><span style="color:#0000ff">long</span><span style="color:#000000"> rowId , String title , String body){<br></span><span style="color:#008080">150</span> <span style="color:#000000">        ContentValues args </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> ContentValues();<br></span><span style="color:#008080">151</span> <span style="color:#000000">        args.put(KEY_TITLE, title);<br></span><span style="color:#008080">152</span> <span style="color:#000000">        args.put(KEY_BODY, body);<br></span><span style="color:#008080">153</span> <span style="color:#000000">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> mDb.update(DATABASE_TABLE, args, KEY_ROWID</span><span style="color:#000000">+</span><span style="color:#000000">"</span><span style="color:#000000">=</span><span style="color:#000000">"</span><span style="color:#000000">+</span><span style="color:#000000">rowId, </span><span style="color:#0000ff">null</span><span style="color:#000000">)</span><span style="color:#000000">&gt;</span><span style="color:#000000">0</span><span style="color:#000000">;<br></span><span style="color:#008080">154</span> <span style="color:#000000">    }<br></span><span style="color:#008080">155</span> <span style="color:#000000">}<br></span><span style="color:#008080">156</span> <span style="color:#000000"><br></span><span style="color:#008080">157</span> <span style="color:#000000"><br></span><span style="color:#008080">158</span> </div></pre>
</div>
</div>


<p>这样我们就有了对数据库操作的代码的实现，下面我们有了数据库了，那么我们就需要有显示的漂亮的界面来体现我们优越性吗？（要懂得包装。）</p>


<p>那么我们来建立界面，首先我们在程序进入后，先是显示我们已经存在的记事本的所有的记录。那么我们建立显示记录的界面，我们在项目的res/layout 新建 notes_list.xml 文件</p>


<p> </p>


<p> </p>


<div><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span>代码</span>
<div>
<pre><div><span style="color:#0000ff">&lt;?</span><span style="color:#ff00ff">xml version="1.0" encoding="utf-8"</span><span style="color:#0000ff">?&gt;</span><span style="color:#000000"><br></span><span style="color:#008000">&lt;!--</span><span style="color:#008000"> XML 文件标头 </span><span style="color:#008000">--&gt;</span><span style="color:#000000"><br></span><span style="color:#008000">&lt;!--</span><span style="color:#008000"> android 中的列式布局  </span><span style="color:#008000">--&gt;</span><span style="color:#000000"><br></span><span style="color:#0000ff">&lt;</span><span style="color:#800000">LinearLayout </span><span style="color:#ff0000">xmlns:android</span><span style="color:#0000ff">="http://schemas.android.com/apk/res/android"</span><span style="color:#ff0000"><br>    android:orientation</span><span style="color:#0000ff">="vertical"</span><span style="color:#ff0000"><br>    android:layout_width</span><span style="color:#0000ff">="fill_parent"</span><span style="color:#ff0000"><br>    android:layout_height</span><span style="color:#0000ff">="fill_parent"</span><span style="color:#ff0000"><br>    </span><span style="color:#0000ff">&gt;</span><span style="color:#000000"><br> <br> </span><span style="color:#0000ff">&lt;</span><span style="color:#800000">ListView </span><span style="color:#ff0000">android:id</span><span style="color:#0000ff">="@id/android:list"</span><span style="color:#ff0000"><br>     android:layout_width</span><span style="color:#0000ff">="wrap_content"</span><span style="color:#ff0000"><br>     android:layout_height</span><span style="color:#0000ff">="wrap_content"</span><span style="color:#0000ff">&gt;</span><span style="color:#000000"><br> </span><span style="color:#0000ff">&lt;/</span><span style="color:#800000">ListView</span><span style="color:#0000ff">&gt;</span><span style="color:#000000"><br> </span><span style="color:#008000">&lt;!--</span><span style="color:#008000"> 如果没有相关的记录的时候显示 </span><span style="color:#008000">--&gt;</span><span style="color:#000000"><br> </span><span style="color:#0000ff">&lt;</span><span style="color:#800000">TextView </span><span style="color:#ff0000">android:id</span><span style="color:#0000ff">="@id/android:empty"</span><span style="color:#ff0000"><br>     android:layout_width</span><span style="color:#0000ff">="wrap_content"</span><span style="color:#ff0000"><br>     android:layout_height</span><span style="color:#0000ff">="wrap_content"</span><span style="color:#ff0000"><br>     android:text</span><span style="color:#0000ff">="@string/no_notes"</span><span style="color:#0000ff">&gt;&lt;/</span><span style="color:#800000">TextView</span><span style="color:#0000ff">&gt;</span><span style="color:#000000"><br></span><span style="color:#0000ff">&lt;/</span><span style="color:#800000">LinearLayout</span><span style="color:#0000ff">&gt;</span><span style="color:#000000"><br></span></div></pre>
</div>
</div>


<p>我们开始显示某一条记录。新建名称为note_row代码如下：</p>


<p> </p>


<div><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span>代码</span>
<div>
<pre><div><span style="color:#0000ff">&lt;?</span><span style="color:#ff00ff">xml version="1.0" encoding="UTF-8"</span><span style="color:#0000ff">?&gt;</span><span style="color:#000000"><br></span><span style="color:#0000ff">&lt;</span><span style="color:#800000">TextView </span><span style="color:#ff0000">android:id</span><span style="color:#0000ff">="@+id/text1"</span><span style="color:#ff0000"><br>  xmlns:android</span><span style="color:#0000ff">="http://schemas.android.com/apk/res/android"</span><span style="color:#ff0000"><br>  android:layout_width</span><span style="color:#0000ff">="wrap_content"</span><span style="color:#ff0000"><br>  android:layout_height</span><span style="color:#0000ff">="wrap_content"</span><span style="color:#0000ff">&gt;&lt;/</span><span style="color:#800000">TextView</span><span style="color:#0000ff">&gt;</span></div></pre>
</div>
</div>


<p>现在界面的设计完成了，我们就需要将它们联系起来。我们在创建项目定义的主类为NotePadList。我们将NotePadList 继承与ListActivity，并复写ListActivity的三个方法，三个方法分别为：onCreate() ,﻿﻿﻿onCreateOptionsMenu(Menu menu),onOptions﻿﻿﻿﻿﻿﻿ItemSelected(MenuItem item).</p>


<p>相关的代码如下：</p>


<p> </p>


<div><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span>代码</span>
<div>
<pre><div><span style="color:#0000ff">package</span><span style="color:#000000"> com.wellen;<br><br></span><span style="color:#0000ff">import</span><span style="color:#000000"> android.app.ListActivity;<br></span><span style="color:#0000ff">import</span><span style="color:#000000"> android.database.Cursor;<br></span><span style="color:#0000ff">import</span><span style="color:#000000"> android.os.Bundle;<br></span><span style="color:#0000ff">import</span><span style="color:#000000"> android.view.Menu;<br></span><span style="color:#0000ff">import</span><span style="color:#000000"> android.view.MenuItem;<br></span><span style="color:#0000ff">import</span><span style="color:#000000"> android.widget.SimpleCursorAdapter;<br></span><span style="color:#008000">/**</span><span style="color:#008000"><br> * 程序的主界面<br> * </span><span style="color:#808080">@author</span><span style="color:#008000"> wellen<br> *<br> </span><span style="color:#008000">*/</span><span style="color:#000000"><br></span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">class</span><span style="color:#000000"> NotePadList </span><span style="color:#0000ff">extends</span><span style="color:#000000"> ListActivity {<br>    <br>    </span><span style="color:#0000ff">private</span><span style="color:#000000"> </span><span style="color:#0000ff">static</span><span style="color:#000000"> </span><span style="color:#0000ff">final</span><span style="color:#000000"> </span><span style="color:#0000ff">int</span><span style="color:#000000"> INSERT_ID </span><span style="color:#000000">=</span><span style="color:#000000"> Menu.FIRST;<br>    <br>    </span><span style="color:#0000ff">private</span><span style="color:#000000"> </span><span style="color:#0000ff">int</span><span style="color:#000000"> mNoteNumber </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#000000">1</span><span style="color:#000000">;<br>    </span><span style="color:#008000">/**</span><span style="color:#008000"><br>     * 数据库操作类<br>     </span><span style="color:#008000">*/</span><span style="color:#000000"><br>    </span><span style="color:#0000ff">private</span><span style="color:#000000"> NotePadDBAdapter mDbHelper;<br>    </span><span style="color:#008000">/**</span><span style="color:#008000"> Called when the activity is first created. </span><span style="color:#008000">*/</span><span style="color:#000000"><br>    @Override<br>    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> onCreate(Bundle savedInstanceState) {<br>        </span><span style="color:#0000ff">super</span><span style="color:#000000">.onCreate(savedInstanceState);<br>        </span><span style="color:#008000">//</span><span style="color:#008000">设置列表布局 </span><span style="color:#008000"><br></span><span style="color:#000000">        setContentView(R.layout.notes_list);<br>        </span><span style="color:#008000">//</span><span style="color:#008000">初始化数据库操作类</span><span style="color:#008000"><br></span><span style="color:#000000">        mDbHelper </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> NotePadDBAdapter(</span><span style="color:#0000ff">this</span><span style="color:#000000">);<br>        </span><span style="color:#008000">//</span><span style="color:#008000">数据库打开</span><span style="color:#008000"><br></span><span style="color:#000000">        mDbHelper.open();<br>        fillData();<br>    }<br>    </span><span style="color:#008000">/**</span><span style="color:#008000"><br>     * 获取现在所有存储 的记录，并将 它们设置并显示到主界面上去<br>     </span><span style="color:#008000">*/</span><span style="color:#000000"><br>    </span><span style="color:#0000ff">private</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> fillData(){<br>        Cursor c </span><span style="color:#000000">=</span><span style="color:#000000"> mDbHelper.fetchAllNotes();<br>        startManagingCursor(c);<br>        <br>        String [] from </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> String[]{    NotePadDBAdapter.KEY_TITLE };<br>        </span><span style="color:#0000ff">int</span><span style="color:#000000"> [] to </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> </span><span style="color:#0000ff">int</span><span style="color:#000000">[] {R.id.text1};<br>        <br>        SimpleCursorAdapter notes </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> SimpleCursorAdapter(</span><span style="color:#0000ff">this</span><span style="color:#000000"> , R.layout.note_row , c, from , to);<br>        setListAdapter(notes);<br>    }<br><br>    </span><span style="color:#008000">/**</span><span style="color:#008000"><br>     * 当按下Menu的时候，就调用这个方法<br>     * 这里会弹出一个Menu 插入Note<br>     </span><span style="color:#008000">*/</span><span style="color:#000000"><br>    @Override<br>    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">boolean</span><span style="color:#000000"> onCreateOptionsMenu(Menu menu) {<br>        </span><span style="color:#0000ff">boolean</span><span style="color:#000000"> result </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">super</span><span style="color:#000000">.onCreateOptionsMenu(menu);<br>        menu.add(</span><span style="color:#000000">0</span><span style="color:#000000"> ,INSERT_ID , </span><span style="color:#000000">0</span><span style="color:#000000"> , R.string.menu_insert);<br>        <br>        </span><span style="color:#0000ff">return</span><span style="color:#000000"> result;<br>    }<br><br>    </span><span style="color:#008000">/**</span><span style="color:#008000"><br>     * 当这个Menu弹出的时候，选择插入 就会调用这个方法 <br>     </span><span style="color:#008000">*/</span><span style="color:#000000"><br>    @Override<br>    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">boolean</span><span style="color:#000000"> onOptionsItemSelected(MenuItem item) {<br>        </span><span style="color:#0000ff">switch</span><span style="color:#000000">(item.getItemId()){<br>          </span><span style="color:#0000ff">case</span><span style="color:#000000"> INSERT_ID:<br>              createNote();<br>              </span><span style="color:#0000ff">return</span><span style="color:#000000"> </span><span style="color:#0000ff">true</span><span style="color:#000000">;<br>        }<br>        </span><span style="color:#0000ff">return</span><span style="color:#000000"> </span><span style="color:#0000ff">super</span><span style="color:#000000">.onOptionsItemSelected(item);<br>    }<br>    <br>    </span><span style="color:#008000">/**</span><span style="color:#008000"><br>     * 添加一天记录并刷新显示列表<br>     </span><span style="color:#008000">*/</span><span style="color:#000000"><br>    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> createNote(){<br>        String noteName </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#000000">"</span><span style="color:#000000">Note</span><span style="color:#000000">"</span><span style="color:#000000">+</span><span style="color:#000000"> mNoteNumber</span><span style="color:#000000">++</span><span style="color:#000000">;<br>        mDbHelper.createNote(noteName, </span><span style="color:#000000">""</span><span style="color:#000000">);<br>        fillData();<br>    }<br>    <br>}</span></div></pre>
</div>
</div>


<p> </p>


<p> </p>


<p>这样我们就能够一个简单的显示日志和添加日志的两个功能的完成。但是我们还有要修改日志和删除日志等相关的操作没有写，这些将在下篇中去介绍。 </p>


<p> </p>


<p> </p>


<p> </p>


<p> </p>


<p> </p>


<p> </p>


<p><img src="http://www.cnblogs.com/wellen/aggbug/1841344.html?type=1" width="1" height="1" alt=""><p>评论: 1　<a href="http://www.cnblogs.com/wellen/archive/2010/10/02/1841344.html#pagedcomment">查看评论</a>　<a href="http://www.cnblogs.com/wellen/archive/2010/10/02/1841344.html#commentform">发表评论</a></p><p><a href="http://job.cnblogs.com/">程序员找工作，就在博客园</a></p><hr><p>最新新闻：<br>· <a href="http://news.cnblogs.com/n/76287/">嫦娥域名抢注升温 注册者叫价八千八</a><span style="color:gray">(2010-10-03 09:57)</span><br>· <a href="http://news.cnblogs.com/n/76286/">苏宁电器称3000余台iPhone 4今天到货</a><span style="color:gray">(2010-10-03 09:56)</span><br>· <a href="http://news.cnblogs.com/n/76284/">谷歌网址缩略服务脱颖而出的4大方法</a><span style="color:gray">(2010-10-03 09:33)</span><br>· <a href="http://news.cnblogs.com/n/76283/">魅族官方首次曝M9真机清晰图和多UI界面</a><span style="color:gray">(2010-10-03 09:32)</span><br>· <a href="http://news.cnblogs.com/n/76282/">Android很好很强大，iOS更强大</a><span style="color:gray">(2010-10-03 09:32)</span><br></p><p>编辑推荐：<a href="http://www.cnblogs.com/wangchangming/archive/2010/09/30/1839620.html">如果你也是.NET程序员</a><br></p><p>网站导航：<a href="http://www.cnblogs.com">博客园首页</a>  <a href="http://home.cnblogs.com/">个人主页</a>  <a href="http://news.cnblogs.com">新闻</a>  <a href="http://home.cnblogs.com/ing/">闪存</a>  <a href="http://home.cnblogs.com/group/">小组</a>  <a href="http://space.cnblogs.com/q/">博问</a>  <a href="http://space.cnblogs.com">社区</a>  <a href="http://kb.cnblogs.com">知识库</a></p></p>

</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/yourusername/">github.com/yourusername</a><br />
                  <a href="http://twitter.com/yourusername/">twitter.com/yourusername</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
