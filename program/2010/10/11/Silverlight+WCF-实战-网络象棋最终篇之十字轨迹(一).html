<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Silverlight+WCF 实战-网络象棋最终篇之十字轨迹(一)</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/">Your New Jekyll Site</a></h1>
              <a class="extra" href="/">home</a>
            </div>

                <h2>Silverlight+WCF 实战-网络象棋最终篇之十字轨迹(一)</h2>
<p class="meta">11 Oct 2010</p>

<div class="post">
<h2>Silverlight+WCF 实战-网络象棋最终篇之十字轨迹(一)</h2>

<h3>by 路过秋天</h3>

<h3>at 2010-10-11 10:47:00</h3>

<h3>original <a href="http://www.cnblogs.com/cyq1162/archive/2010/10/11/1847625.html">http://www.cnblogs.com/cyq1162/archive/2010/10/11/1847625.html</a></h3>

<p><a href="http://www.cnblogs.com/cyq1162/"><img src="http://pic.cnblogs.com/face/u17408.jpg" alt="" border="0"></a><br>作者: <a href="http://www.cnblogs.com/cyq1162/">路过秋天</a> 发表于 2010-10-11 10:47 <a href="http://www.cnblogs.com/cyq1162/archive/2010/10/11/1847625.html">原文链接</a> 阅读: 1073 评论: 10</p>


<p>前言</p>


<div><img alt="" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif"><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif"> 
<div>
<div><span style="color:#000000">继之前Silverlight+WCF 新手实例 象棋系列四十篇之后，一个多月的时间都在写CYQ.Data框架系列[<a href="http://www.cnblogs.com/cyq1162/archive/2010/09/07/1820400.html"><font color="#78afd3">CYQ.Data 轻量数据层之路 框架开源系列 索引</font></a>]，<br><br>让各位对该Silverlight+WCF 象棋系列有兴趣的网友久候了，上一系列详见：[<a href="http://www.cnblogs.com/cyq1162/archive/2010/07/26/1785082.html">Silverlight+WCF 新手实例 象棋 专题索引</a>]<br><br>今天开始就在之前四十篇续上，直到把 [<a href="http://www.cnblogs.com/cyq1162/archive/2010/07/14/1777429.html"><font color="#78afd3">Silverlight+WCF 新手实例 象棋 在线演示</font></a>] 上的最新代码写完，谢谢支持！<br></span></div></div></div>


<p> </p>


<p>乱七杂八说两句：</p>


<div>
<div><span style="color:#000000">一个多月没碰VS2010了，今天回头看原来的象棋系列代码，感觉到有点陌生了，<br><br>好多原来的思路，都忘的差不多了，要续写这系列文章，感觉还得像个新手一样重温下代码才行呢。<br><br>本系列为进阶优化系列，会在原来的基础上，慢慢改动很多代码的哦，欢迎持续关注！<br></span></div></div>


<p> </p>


<p>正文：</p>


<p>我们先回顾下，截一张<a href="http://www.cnblogs.com/cyq1162/archive/2010/07/26/1785082.html">上一系列</a> 最后一节[<font color="#78afd3">Silverlight+WCF 新手实例 象棋 主界面-棋谱-回放-结局(四十)</font> ]里的一张图片先：</p>


<p><img height="602" alt="" src="http://images.cnblogs.com/cnblogs_com/cyq1162/201008/40-1.jpg" width="965" border="0"></p>


<p> </p>


<div>
<div><span style="color:#000000">OK，从这图片我知道双方是在下棋了，可是我们并不知道现在该谁下了？<br><br>当然了，认真看一下棋谱，还是知道刚刚是黑方下了一步，不过还是要很用力的猜车一平二是怎么个平法。<br><br>十字轨迹的出现，解决了这个问题，如果到QQ平台下过棋，也见过的，就是那个棋子周围加上的一个边框了，那这个为啥叫十字轨迹？这个这个...<br></span></div></div>


<p> </p>


<p> </p>


<p>好！大伙知道十字轨迹是什么就好了，现在说说实现思路</p>


<div>
<div><span style="color:#000000">大伙想啊，十字轨迹是在棋步移动之后，在棋盘上就有两个出现了，一个在移动的棋子的原来位置，一个在移动后的位置，而且整个棋盘就只能有两个，于是，我们的思路定位就很简单了。<br><br>一：在棋盘上先创建好两个十字轨迹，默认隐藏<br><br>二：在棋手移动完棋子之后，把两个十字轨迹移动到相应的位置<br></span></div></div>


<p> </p>


<p> </p>


<p>就这么两步，很简单吧，该出手时就出手。</p>


<p> </p>


<p>实现步骤如下：</p>


<p> </p>


<p><strong style="color:red">一：棋盘Board类画十字轨迹</strong></p>


<p><strong><font color="#ff0000"></font></strong> </p>


<p><strong>1：增加两个十字轨迹属性</strong></p>


<div><img alt="" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif"><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif"> 
<div>
<div><span style="color:#000000">   </span><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;summary&gt;</span><span style="color:#008000"><br>    </span><span style="color:#808080">///</span><span style="color:#008000"> 棋盘 by 路过秋天<br>    </span><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#008000;text-decoration:underline">http://cyq1162.cnblogs.com</span><span style="color:#008000"><br>    </span><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;/summary&gt;</span><span style="color:#808080"><br></span><span style="color:#000000">    </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">class</span><span style="color:#000000"> Board<br>    {<br>        </span><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;summary&gt;</span><span style="color:#008000"><br>        </span><span style="color:#808080">///</span><span style="color:#008000"> 十字轨迹框<br>        </span><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;/summary&gt;</span><span style="color:#808080"><br></span><span style="color:#000000">        </span><span style="color:#0000ff">public</span><span style="color:#000000"> Canvas TrackFrom<br>        {<br>            </span><span style="color:#0000ff">get</span><span style="color:#000000">;<br>            </span><span style="color:#0000ff">set</span><span style="color:#000000">;<br>        }<br>        </span><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;summary&gt;</span><span style="color:#008000"><br>        </span><span style="color:#808080">///</span><span style="color:#008000"> 十字轨迹框<br>        </span><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;/summary&gt;</span><span style="color:#808080"><br></span><span style="color:#000000">        </span><span style="color:#0000ff">public</span><span style="color:#000000"> Canvas TrackTo<br>        {<br>            </span><span style="color:#0000ff">get</span><span style="color:#000000">;<br>            </span><span style="color:#0000ff">set</span><span style="color:#000000">;<br>        }<br>        </span><span style="color:#008000">//</span><span style="color:#008000">下面省略N多代码</span><span style="color:#008000"><br></span><span style="color:#000000">     }</span></div></div></div>


<p><strong>2：增加一函数，用于画十字轨迹</strong></p>


<div><img alt="" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif"><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif"> 
<div>
<div><span style="color:#000000">        </span><span style="color:#0000ff">private</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> DrawTrack(Panel panel)<br>        {<br>            </span><span style="color:#0000ff">double</span><span style="color:#000000"> width </span><span style="color:#000000">=</span><span style="color:#000000"> panel.Width </span><span style="color:#000000">-</span><span style="color:#000000"> </span><span style="color:#800080">8</span><span style="color:#000000">;<br>            </span><span style="color:#008000">//</span><span style="color:#008000">横线4条</span><span style="color:#008000"><br></span><span style="color:#000000">            DrawLine(</span><span style="color:#800080">0</span><span style="color:#000000">, </span><span style="color:#800080">0</span><span style="color:#000000">, width </span><span style="color:#000000">/</span><span style="color:#000000"> </span><span style="color:#800080">4</span><span style="color:#000000">, </span><span style="color:#800080">0</span><span style="color:#000000">, </span><span style="color:#800080">3</span><span style="color:#000000">, panel, </span><span style="color:#0000ff">false</span><span style="color:#000000">);</span><span style="color:#008000">//</span><span style="color:#008000">L-</span><span style="color:#008000"><br></span><span style="color:#000000">            DrawLine(</span><span style="color:#800080">0</span><span style="color:#000000">, width, width </span><span style="color:#000000">/</span><span style="color:#000000"> </span><span style="color:#800080">4</span><span style="color:#000000">, width, </span><span style="color:#800080">3</span><span style="color:#000000">, panel, </span><span style="color:#0000ff">false</span><span style="color:#000000">);</span><span style="color:#008000">//</span><span style="color:#008000">LB-</span><span style="color:#008000"><br></span><span style="color:#000000">            DrawLine(width </span><span style="color:#000000">*</span><span style="color:#000000"> </span><span style="color:#800080">3</span><span style="color:#000000"> </span><span style="color:#000000">/</span><span style="color:#000000"> </span><span style="color:#800080">4</span><span style="color:#000000">, </span><span style="color:#800080">0</span><span style="color:#000000">, width, </span><span style="color:#800080">0</span><span style="color:#000000">, </span><span style="color:#800080">3</span><span style="color:#000000">, panel, </span><span style="color:#0000ff">false</span><span style="color:#000000">);</span><span style="color:#008000">//</span><span style="color:#008000">R-</span><span style="color:#008000"><br></span><span style="color:#000000">            DrawLine(width </span><span style="color:#000000">*</span><span style="color:#000000"> </span><span style="color:#800080">3</span><span style="color:#000000"> </span><span style="color:#000000">/</span><span style="color:#000000"> </span><span style="color:#800080">4</span><span style="color:#000000">, width, width, width, </span><span style="color:#800080">3</span><span style="color:#000000">, panel, </span><span style="color:#0000ff">false</span><span style="color:#000000">);</span><span style="color:#008000">//</span><span style="color:#008000">RB-<br><br><br>            </span><span style="color:#008000">//</span><span style="color:#008000">直线四条</span><span style="color:#008000"><br></span><span style="color:#000000">            DrawLine(</span><span style="color:#800080">0</span><span style="color:#000000">, </span><span style="color:#800080">0</span><span style="color:#000000">, </span><span style="color:#800080">0</span><span style="color:#000000">, width </span><span style="color:#000000">/</span><span style="color:#000000"> </span><span style="color:#800080">4</span><span style="color:#000000">, </span><span style="color:#800080">3</span><span style="color:#000000">, panel, </span><span style="color:#0000ff">false</span><span style="color:#000000">);</span><span style="color:#008000">//</span><span style="color:#008000">L| ok</span><span style="color:#008000"><br></span><span style="color:#000000">            DrawLine(width, </span><span style="color:#800080">0</span><span style="color:#000000">, width, width </span><span style="color:#000000">/</span><span style="color:#000000"> </span><span style="color:#800080">4</span><span style="color:#000000">, </span><span style="color:#800080">3</span><span style="color:#000000">, panel, </span><span style="color:#0000ff">false</span><span style="color:#000000">);</span><span style="color:#008000">//</span><span style="color:#008000">R| ok</span><span style="color:#008000"><br></span><span style="color:#000000">            DrawLine(</span><span style="color:#800080">0</span><span style="color:#000000">, width, </span><span style="color:#800080">0</span><span style="color:#000000">, width </span><span style="color:#000000">*</span><span style="color:#000000"> </span><span style="color:#800080">3</span><span style="color:#000000"> </span><span style="color:#000000">/</span><span style="color:#000000"> </span><span style="color:#800080">4</span><span style="color:#000000">, </span><span style="color:#800080">3</span><span style="color:#000000">, panel, </span><span style="color:#0000ff">false</span><span style="color:#000000">);</span><span style="color:#008000">//</span><span style="color:#008000">LB|</span><span style="color:#008000"><br></span><span style="color:#000000">            DrawLine(width, width </span><span style="color:#000000">*</span><span style="color:#000000"> </span><span style="color:#800080">3</span><span style="color:#000000"> </span><span style="color:#000000">/</span><span style="color:#000000"> </span><span style="color:#800080">4</span><span style="color:#000000">, width, width, </span><span style="color:#800080">3</span><span style="color:#000000">, panel, </span><span style="color:#0000ff">false</span><span style="color:#000000">);</span><span style="color:#008000">//</span><span style="color:#008000">RB|</span><span style="color:#008000"><br></span><span style="color:#000000">        }</span></div></div></div>


<p>说明：</p>


<div>
<div><span style="color:#000000">画这么个框，记得以前还真费了不少劲，在那调坐标和宽度；<br><br>注意哦，DrawLine方法变成5个参数了，以前只有四个的。<br></span></div></div>


<p><strong>3：DrawLine方法小调整</strong></p>


<div><img alt="" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif"><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif"> 
<div>
<div><span style="color:#0000ff">        private</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> DrawLine(</span><span style="color:#0000ff">double</span><span style="color:#000000"> x1, </span><span style="color:#0000ff">double</span><span style="color:#000000"> y1, </span><span style="color:#0000ff">double</span><span style="color:#000000"> x2, </span><span style="color:#0000ff">double</span><span style="color:#000000"> y2)//保留原有方法原型，不用改其它画线代码<br>        {<br>            DrawLine(x1, y1, x2, y2, </span><span style="color:#800080">1</span><span style="color:#000000">, container, </span><span style="color:#0000ff">true</span><span style="color:#000000">);<br>        }<br>        </span><span style="color:#0000ff">private</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> DrawLine(</span><span style="color:#0000ff">double</span><span style="color:#000000"> x1, </span><span style="color:#0000ff">double</span><span style="color:#000000"> y1, </span><span style="color:#0000ff">double</span><span style="color:#000000"> x2, </span><span style="color:#0000ff">double</span><span style="color:#000000"> y2, </span><span style="color:#0000ff">int</span><span style="color:#000000"> thick, Panel panel, </span><span style="color:#0000ff">bool</span><span style="color:#000000"> auto)<br>        {<br>            </span><span style="color:#0000ff">double</span><span style="color:#000000"> tempGap </span><span style="color:#000000">=</span><span style="color:#000000"> ((x1 </span><span style="color:#000000">+</span><span style="color:#000000"> y1) </span><span style="color:#000000">&gt;</span><span style="color:#000000"> </span><span style="color:#800080">19</span><span style="color:#000000"> </span><span style="color:#000000">||</span><span style="color:#000000"> </span><span style="color:#000000">!</span><span style="color:#000000">auto) </span><span style="color:#000000">?</span><span style="color:#000000"> </span><span style="color:#800080">1</span><span style="color:#000000"> : gap;</span><span style="color:#008000">//</span><span style="color:#008000">就这行加了一个!Auto，其它没变过</span><span style="color:#008000"><br></span><span style="color:#000000">            Line line </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> Line()<br>            {<br>                X1 </span><span style="color:#000000">=</span><span style="color:#000000"> x1 </span><span style="color:#000000">*</span><span style="color:#000000"> tempGap </span><span style="color:#000000">+</span><span style="color:#000000"> marginLeft,<br>                Y1 </span><span style="color:#000000">=</span><span style="color:#000000"> y1 </span><span style="color:#000000">*</span><span style="color:#000000"> tempGap </span><span style="color:#000000">+</span><span style="color:#000000"> marginTop,<br>                X2 </span><span style="color:#000000">=</span><span style="color:#000000"> x2 </span><span style="color:#000000">*</span><span style="color:#000000"> tempGap </span><span style="color:#000000">+</span><span style="color:#000000"> marginLeft,<br>                Y2 </span><span style="color:#000000">=</span><span style="color:#000000"> y2 </span><span style="color:#000000">*</span><span style="color:#000000"> tempGap </span><span style="color:#000000">+</span><span style="color:#000000"> marginTop,<br>                Stroke </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> SolidColorBrush(Colors.Black),<br>                StrokeThickness </span><span style="color:#000000">=</span><span style="color:#000000"> thick<br>            };<br>            panel.Children.Add(line);<br>        }</span></div></div></div>


<p>说明：</p>


<div>
<div><span style="color:#000000">增加一个auto是干虾米用的呢？这是因为在画十字轨迹时，我们传进的是实际像素值，然而又可能出现x1</span><span style="color:#000000">+</span><span style="color:#000000">y1</span><span style="color:#000000">&lt;</span><span style="color:#000000">19的情况，为了保证它是按像素计算，所以...你懂的！</span></div>
<div><span style="color:#000000">还有，为啥是19，其实应该是17[数一下横线+直线有多少条，索引从0开始],这个问题在以前就说过了,这里不多解释了，保留19也没错。<br></span></div></div>


<p><strong>4：初始化画棋盘时，把十字轨迹也画上</strong></p>


<div><img alt="" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif"><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif"> 
<div>
<div><span style="color:#000000">        </span><span style="color:#0000ff">private</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> Draw()<br>        {<br>            </span><span style="color:#008000">//</span><span style="color:#008000">省略画棋盘线代码</span><span style="color:#008000"><br></span><span style="color:#000000">      <br>            </span><span style="color:#0000ff">#region</span><span style="color:#000000"> 画棋步轨迹</span><span style="color:#000000"><br>            </span><span style="color:#008000">//</span><span style="color:#008000">创建两个十字修饰框</span><span style="color:#008000"><br></span><span style="color:#000000">            TrackFrom </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> Canvas()<br>            {<br>                Width </span><span style="color:#000000">=</span><span style="color:#000000"> gap,<br>                Height </span><span style="color:#000000">=</span><span style="color:#000000"> gap,<br>                Margin </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> Thickness(</span><span style="color:#000000">-</span><span style="color:#000000">marginLeft </span><span style="color:#000000">*</span><span style="color:#000000"> </span><span style="color:#800080">12</span><span style="color:#000000">, </span><span style="color:#000000">-</span><span style="color:#000000">marginLeft </span><span style="color:#000000">*</span><span style="color:#000000"> </span><span style="color:#800080">12</span><span style="color:#000000">, </span><span style="color:#800080">0</span><span style="color:#000000">, </span><span style="color:#800080">0</span><span style="color:#000000">)<br>            };<br>            TrackTo </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> Canvas()<br>            {<br>                Width </span><span style="color:#000000">=</span><span style="color:#000000"> gap,<br>                Height </span><span style="color:#000000">=</span><span style="color:#000000"> gap,<br>                Margin </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">new</span><span style="color:#000000"> Thickness(</span><span style="color:#000000">-</span><span style="color:#000000">marginLeft </span><span style="color:#000000">*</span><span style="color:#000000"> </span><span style="color:#800080">12</span><span style="color:#000000">, </span><span style="color:#000000">-</span><span style="color:#000000">marginLeft </span><span style="color:#000000">*</span><span style="color:#000000"> </span><span style="color:#800080">12</span><span style="color:#000000">, </span><span style="color:#800080">0</span><span style="color:#000000">, </span><span style="color:#800080">0</span><span style="color:#000000">)<br>            };<br>            DrawTrack(TrackFrom);<br>            DrawTrack(TrackTo);<br>            container.Children.Add(TrackFrom);<br>            container.Children.Add(TrackTo);<br>            </span><span style="color:#0000ff">#endregion</span><span style="color:#000000"><br>            </span><span style="color:#0000ff">#region</span><span style="color:#000000"> 画楚河汉界</span><span style="color:#000000"><br>              DrawFont(</span><span style="color:#800000">"</span><span style="color:#800000">路过秋天</span><span style="color:#800000">"</span><span style="color:#000000">);<br>            </span><span style="color:#0000ff">#endregion</span><span style="color:#000000"><br>        }</span></div></div></div>


<p> </p>


<p><strong style="color:red">二：Chess象棋类增加设置十字焦点方法</strong></p>


<p><strong><font color="#ff0000"></font></strong> </p>


<p><strong>1：增加设置十字焦点方法</strong></p>


<div><img alt="" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif"><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif"> 
<div>
<div><span style="color:#000000">        </span><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;summary&gt;</span><span style="color:#008000"><br>        </span><span style="color:#808080">///</span><span style="color:#008000"> 设置轨迹十字框<br>        </span><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;/summary&gt;</span><span style="color:#808080"><br></span><span style="color:#000000">        </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> SetFocus(Point from, Point to)<br>        {<br>            from </span><span style="color:#000000">=</span><span style="color:#000000"> SwitchPixelArray(from);<br>            to </span><span style="color:#000000">=</span><span style="color:#000000"> SwitchPixelArray(to);<br>            </span><span style="color:#0000ff">double</span><span style="color:#000000"> offset </span><span style="color:#000000">=</span><span style="color:#000000"> Board.TrackFrom.Width </span><span style="color:#000000">/</span><span style="color:#000000"> </span><span style="color:#800080">2</span><span style="color:#000000"> </span><span style="color:#000000">-</span><span style="color:#000000"> Board.marginLeft </span><span style="color:#000000">*</span><span style="color:#000000"> </span><span style="color:#800080">11</span><span style="color:#000000"> </span><span style="color:#000000">-</span><span style="color:#000000"> </span><span style="color:#800080">4</span><span style="color:#000000">;</span><span style="color:#008000">//</span><span style="color:#008000">要减去默认初始位置，默认是*-12</span><span style="color:#008000"><br></span><span style="color:#000000">            Canvas.SetLeft(Board.TrackFrom, from.X </span><span style="color:#000000">-</span><span style="color:#000000"> offset);<br>            Canvas.SetTop(Board.TrackFrom, from.Y </span><span style="color:#000000">-</span><span style="color:#000000"> offset);<br>            Canvas.SetLeft(Board.TrackTo, to.X </span><span style="color:#000000">-</span><span style="color:#000000"> offset);<br>            Canvas.SetTop(Board.TrackTo, to.Y </span><span style="color:#000000">-</span><span style="color:#000000"> offset);<br>        }</span></div></div></div>


<p> </p>


<p>说明：</p>


<div>
<div><span style="color:#000000">在移动棋步的时候，我们调用一下这个方法，把两个轨迹移动到相应的位置就OK了，<br><br>重点是：移动时，要减去原来的默认初始的位置，这个调整起来很麻烦。<br></span></div></div>


<p> </p>


<p><strong style="color:red">三：ChessAction棋子动作类</strong></p>


<p><strong><font color="#ff0000"></font></strong> </p>


<p><strong>1：棋手移动时调用设置十字轨迹焦点函数</strong></p>


<div><img alt="" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif"><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif"> 
<div>
<div><span style="color:#000000">        </span><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;summary&gt;</span><span style="color:#008000"><br>        </span><span style="color:#808080">///</span><span style="color:#008000"> 移动棋子<br>        </span><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;/summary&gt;</span><span style="color:#008000"><br>        </span><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;param name=&quot;chessman&quot;&gt;</span><span style="color:#008000">棋子</span><span style="color:#808080">&lt;/param&gt;</span><span style="color:#008000"><br>        </span><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;param name=&quot;toX&quot;&gt;</span><span style="color:#008000">移动到X坐标</span><span style="color:#808080">&lt;/param&gt;</span><span style="color:#008000"><br>        </span><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;param name=&quot;toY&quot;&gt;</span><span style="color:#008000">移动到Y坐标</span><span style="color:#808080">&lt;/param&gt;</span><span style="color:#808080"><br></span><span style="color:#000000">        </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">bool</span><span style="color:#000000"> MoveTo(Chessman chessman, Point moveTo)<br>        {<br>            </span><span style="color:#0000ff">if</span><span style="color:#000000"> (Rule.IsCanMove(chessman, moveTo))<br>            {<br>                chessman.ReadyMove </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">false</span><span style="color:#000000">;<br>                chessman.chessman.Background </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#0000ff">null</span><span style="color:#000000">;<br>                PlayMove(chessman, moveTo);<br>                Parent.SetFocus(chessman.MovePoint, moveTo);</span><span style="color:#008000">//</span><span style="color:#008000">就这一行代码增加</span><span style="color:#008000"><br></span><span style="color:#000000">                HelpMoveStepEvent(chessman, moveTo);<br>                chessman.MovePoint </span><span style="color:#000000">=</span><span style="color:#000000"> moveTo;<br>                <br>                </span><span style="color:#0000ff">return</span><span style="color:#000000"> </span><span style="color:#0000ff">true</span><span style="color:#000000">;<br>            }<br>            </span><span style="color:#0000ff">return</span><span style="color:#000000"> </span><span style="color:#0000ff">false</span><span style="color:#000000">;<br>        }</span></div></div></div>


<p> </p>


<p><strong>2：对方棋手下棋手，系统会自动移动棋子，也要自动设置十字轨迹焦点</strong></p>


<div><img alt="" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif"><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif"> 
<div>
<div><span style="color:#000000">       </span><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;summary&gt;</span><span style="color:#008000"><br>        </span><span style="color:#808080">///</span><span style="color:#008000"> 系统自动移动棋子<br>        </span><span style="color:#808080">///</span><span style="color:#008000"> </span><span style="color:#808080">&lt;/summary&gt;</span><span style="color:#808080"><br></span><span style="color:#000000">        </span><span style="color:#0000ff">public</span><span style="color:#000000"> </span><span style="color:#0000ff">void</span><span style="color:#000000"> AutoMoveTo(Point from, Point to)<br>        {<br>            Chessman chessman </span><span style="color:#000000">=</span><span style="color:#000000"> Parent.FindChessman(from);<br>            Chessman eatChessman </span><span style="color:#000000">=</span><span style="color:#000000"> Parent.FindChessman(to);<br>            </span><span style="color:#0000ff">if</span><span style="color:#000000"> (chessman </span><span style="color:#000000">!=</span><span style="color:#000000"> </span><span style="color:#0000ff">null</span><span style="color:#000000">)<br>            {<br>                PlayMove(chessman, to);<br>                Parent.SetFocus(from, to);</span><span style="color:#008000">//</span><span style="color:#008000">就这一行代码增加</span><span style="color:#008000"><br></span><span style="color:#000000">                chessman.MovePoint </span><span style="color:#000000">=</span><span style="color:#000000"> to;<br>                </span><span style="color:#0000ff">if</span><span style="color:#000000"> (eatChessman </span><span style="color:#000000">!=</span><span style="color:#000000"> </span><span style="color:#0000ff">null</span><span style="color:#000000">)<br>                {<br>                    SetIsGameEnd(eatChessman);<br>                    eatChessman.GoToDead();<br>                }<br>            }<br>        }</span></div></div></div>


<p> </p>


<p><strong style="color:red">四：F5看运行结果</strong></p>


<p> </p>


<p><strong>1：运行后直接上图了</strong></p>


<p><img height="580" alt="" src="http://images.cnblogs.com/cnblogs_com/cyq1162/201010/chess_1_1.jpg" width="946" border="0"></p>


<p>OK，大伙看到效果了吧！</p>


<p> </p>


<p> <img src="http://www.cnblogs.com/cyq1162/aggbug/1847625.html?type=1" width="1" height="1" alt=""><p>评论: 10　<a href="http://www.cnblogs.com/cyq1162/archive/2010/10/11/1847625.html#pagedcomment">查看评论</a>　<a href="http://www.cnblogs.com/cyq1162/archive/2010/10/11/1847625.html#commentform">发表评论</a></p><p><a href="http://job.cnblogs.com/">程序员找工作，就在博客园</a></p><hr><p>最新新闻：<br>· <a href="http://news.cnblogs.com/n/76965/">暴雪或于2012年底推出《魔兽争霸4》</a><span style="color:gray">(2010-10-12 09:03)</span><br>· <a href="http://news.cnblogs.com/n/76964/">“百度经验”知识社区上线</a><span style="color:gray">(2010-10-12 09:03)</span><br>· <a href="http://news.cnblogs.com/n/76963/">阿里再起股权纷争：专家称马云暂无失业风险</a><span style="color:gray">(2010-10-12 09:01)</span><br>· <a href="http://news.cnblogs.com/n/76962/">iPhone 4，Facetime，为何如此迷人</a><span style="color:gray">(2010-10-12 09:00)</span><br>· <a href="http://news.cnblogs.com/n/76961/">Google赞助开发的免费办公软件－LibreOffice</a><span style="color:gray">(2010-10-12 08:49)</span><br></p><p>编辑推荐：<a href="http://news.cnblogs.com/n/76942/">从为IBM招聘实习生中学到的经验</a><br></p><p>网站导航：<a href="http://www.cnblogs.com">博客园首页</a>  <a href="http://home.cnblogs.com/">个人主页</a>  <a href="http://news.cnblogs.com">新闻</a>  <a href="http://home.cnblogs.com/ing/">闪存</a>  <a href="http://home.cnblogs.com/group/">小组</a>  <a href="http://space.cnblogs.com/q/">博问</a>  <a href="http://space.cnblogs.com">社区</a>  <a href="http://kb.cnblogs.com">知识库</a></p></p>

</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/yourusername/">github.com/yourusername</a><br />
                  <a href="http://twitter.com/yourusername/">twitter.com/yourusername</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
