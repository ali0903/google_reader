<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>JavaScript中delete操作符不能删除的对象</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/">Your New Jekyll Site</a></h1>
              <a class="extra" href="/">home</a>
            </div>

                <h2>JavaScript中delete操作符不能删除的对象</h2>
<p class="meta">06 Mar 2013</p>

<div class="post">
<h2>JavaScript中delete操作符不能删除的对象</h2>

<h3>by snandy</h3>

<h3>at 2013-03-06 14:40:00</h3>

<h3>original <a href="http://www.cnblogs.com/snandy/archive/2013/03/06/2944815.html">http://www.cnblogs.com/snandy/archive/2013/03/06/2944815.html</a></h3>

<p><a href="http://www.ecma-international.org/publications/files/ECMA-ST-ARCH/ECMA-262,%203rd%20edition,%20December%201999.pdf">ES3</a> 中，delete在8.6.2.5及11.4.1有介绍，如下</p>


<p><br><p><img style="border:1px solid gray;border-radius:10px" src="http://images.cnitblog.com/blog/114013/201303/05174120-55e269e464ae4e2096dc1da0ef118e8e.png" alt="" width="600"></p><br><p><img style="border:1px solid gray;border-radius:10px" src="http://images.cnitblog.com/blog/114013/201303/05174136-c530a339c8a34ca595dd3c8a7f79976e.png" alt="" width="600"></p><br><p> </p><br><p>有一些信息，</p><br><p>1、实现上delete操作符会调用引擎内部的[[Delete]]方法</p><br><p>2、[[Delete]]在8.6.2里定义</p><br><p><img src="http://images.cnitblog.com/blog/114013/201303/05175048-607f3da184a6466d85bff9a52e0938fc.png" alt="" width="600"></p><br><p>3、删除的属性有个DontDelete的特性，如果有，delete时直接返回false</p><br><p> </p><br><p>搜索“DontDelete”，会发现有很多，如下都不能delete</p><br><p> </p><br><p>1， 激活对象的arguments对象 (10.1.6)</p><br><div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px"><br><pre>function func() {<br>delete arguments;<br>alert(arguments);<br>}<br>func(1);<br></pre><br></div><br><p> </p><br><p>2，变量声明 (10.2.1)</p><br><div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px"><br><pre>var a = 10;<br>delete a;<br>alert(a); // 10<br></pre><br></div><br><p>这一条在很多JS书里有提及，即不能delete掉使用var声明的变量。</p><br><p> </p><br><p>3，函数声明</p><br><div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px"><br><pre>function func() {}<br>delete func;<br>alert(func); // func code<br></pre><br></div><br><p> </p><br><p>4，函数的length属性</p><br><div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px"><br><pre>function func(a, b) {}<br>delete func.length;<br>alert(func.length); // 2<br></pre><br></div><br><p> </p><br><p>5，一些常量（NaN、Infinity、undefined）</p><br><div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px"><br><pre>delete NaN; // false<br>delete Infinity; // false<br>delete undefined; // false<br></pre><br></div><br><p> </p><br><p>6，内置构造器的prototype</p><br><div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px"><br><pre>delete Object.prototype; // false<br>delete Function.prototype; // false<br>delete Array.prototype; // false<br>delete ExpReg.prototype; // false<br>delete Date.prototype; // false<br>delete Error.prototype; // false<br>delete Number.prototype; // false<br>delete Boolean.prototype; // false<br>delete String.prototype; // false<br></pre><br></div><br><p> </p><br><p>7， 数组和字符串的length</p><br><div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px"><br><pre>var arr = [], str = 'hello';<br>delete arr.length; // false<br>delete str.length; // false<br></pre><br></div><br><p> </p><br><p>8，Math对象的属性（Math.E、Math.LN10、Math.LN2、Math.LOG2E、Math.LOG10E、Math.PI、Math.SQRT1_2、Math.SQRT2）</p><br><div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px"><br><pre>delete Math.E; // false<br>...<br></pre><br></div><br><p>　　</p><br><p>9，正则对象的属性（source、global、ignoreCase、multiline、lastIndex）</p><br><div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px"><br><pre>var reg = /ss/;<br>delete reg.source; // false<br>...<br></pre><br></div><br><p>　　</p><br><p><a href="http://www.ecma-international.org/publications/files/ECMA-ST-ARCH/ECMA-262%205th%20edition%20December%202009.pdf">ES5</a> 与ES3不同，ES5中没有“DontDelete”，却增加了 [[Configurable]] （8.6.1）。</p><br><p><img src="http://images.cnitblog.com/blog/114013/201303/06142024-beba6b7c1e5d49b5b66b3a0f29c2831a.png" alt="" width="600"></p><br><p>如果该值为false，则不能delete，以上列举的9点在ES5中描述为[[Configurable]]为false。</p><br><p> </p><br><p>ES5新增的Object.defineProperty方法可显示的定义对象的Configurable，如下</p><br><div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px"><br><pre>var obj = {name: 'John'};<br>Object.defineProperty(obj, "key", {<br>  configurable: false,<br>  value: "static"<br>});<br>delete obj.name; // true<br>delete obj.key // false</pre><br></div><br><p>对象obj有name，key。name可以delete，key则不行。</p><br><p> </p><br><p>此外ES5严格模式中delete configuable为false的对象时会直接抛异常。如</p><br><div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px"><br><pre>"use strict";<br>delete Object.prototype;<br></pre><br></div><br><p>FF中控制台报错如下</p><br><p><img src="http://images.cnitblog.com/blog/114013/201303/06142905-6b2794c150b84ecfad2a90a2d7427d02.png" alt=""></p><br><p> </p><br><p>除了内置对象的一些方法或属性不能删除外，自定义对象也有不能删除的。如delete不能删除对象继承来自原型上的属性</p><br><div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px"><br><pre>function Person() {}<br>Person.prototype.name = 'John Backus';<br>var p = new Person();<br>delete p.name;<br>console.log(p.name); // 仍然输出 John Backus<br></pre><br></div><br><p>如果this和prototype上都有name，那么delete后，会将prototype上的呈现出来</p><br><div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px"><br><pre>function Person() {<br>this.name = 'John Backus';<br>}<br>Person.prototype.name = 'John Resig';<br>var p = new Person();<br>console.log(p.name); // John Backus<br>delete p.name;<br>console.log(p.name); // John Resig, 来自原型<br></pre><br></div><br><p>如果非要删除原型上的name，只能</p><br><div style="background-color:#f5f5f5;border:1px solid #cccccc;padding:10px"><br><pre>delete Person.prototype.name</pre><br></div><br><p> </p><br><p>总结下：</p><br><p>1，内置对象的属性及方法多数不能delete（虽然有些能delete，如isNaN、parseInt）</p><br><p>2，对象继承于原型的属性和方法不能delete </p><br><p> </p><br><p>原因也很简单，</p><br><p>1，内置对象的属性及方法多数不能delete保护该语言最核心API，这些API被delete了，基本上就废了。如delete Object.prototype。</p><br><p>2，对象继承于原型的属性和方法不能delete是出于保护原型，否则 “类A的对象delete了原型上的属性，那么继承于A的都将丢失该属性”。</p><br><p> </p><br><p>相关：</p><br><p><a href="http://www.cnblogs.com/snandy/archive/2011/03/19/1988284.html">JavaScript声明全局变量三种方式的异同</a></p><br><p><a href="http://www.cnblogs.com/snandy/archive/2011/03/19/1988626.html">JavaScript中两种类型的全局对象/函数</a></p><br><p><a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperty">https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperty</a></p><br><p> </p><img src="http://www.cnblogs.com/snandy/aggbug/2944815.html?type=1" width="1" height="1" alt=""><p><a href="http://www.cnblogs.com/snandy/archive/2013/03/06/2944815.html">本文链接</a></p></p>

</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/yourusername/">github.com/yourusername</a><br />
                  <a href="http://twitter.com/yourusername/">twitter.com/yourusername</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
