<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>一个简单的AJAX示例</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/">Your New Jekyll Site</a></h1>
              <a class="extra" href="/">home</a>
            </div>

                <h2>一个简单的AJAX示例</h2>
<p class="meta">08 Jan 2013</p>

<div class="post">
<h2>一个简单的AJAX示例</h2>

<h3>by 司徒正美</h3>

<h3>at 2013-01-08 14:16:00</h3>

<h3>original <a href="http://www.cnblogs.com/rubylouvre/archive/2013/01/08/2851051.html">http://www.cnblogs.com/rubylouvre/archive/2013/01/08/2851051.html</a></h3>

<p>虽然现在有了框架，许多AJAX调用直接调用它们的API就可用。但有些极端情况，比如面试，比如第三方应用不想加载这些库，我们就只有自己写。这时想必有许多人要疯狂google，百度了。网上太多垃圾信息，我还是在自己博客上保存一份吧。</p>


<p>我的实现：</p>


<p><br>var ajax = new(self.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP")<br>ajax.onreadystatechange = function(){<br>  if (ajax.readyState==4 &amp;&amp; ajax.status==200){<br>      alert(ajax.responseText)<br>  }<br>}<br>ajax.open("POST", url, true);<br>ajax.send(&quot;key=val&amp;key1=val2&quot;);<br><p>群里黑暗骑士的实现：</p><br>Ajax = function(){<br>    function request(url,opt){<br>        function fn(){}<br>        var async   = opt.async !== false,<br>            method  = opt.method    || 'GET',<br>            data    = opt.data      || null,<br>            success = opt.success   || fn,<br>            failure = opt.failure   || fn;<br>            method  = method.toUpperCase();<br>        if(method == &#39;GET&#39; &amp;&amp; data){<br>            url += (url.indexOf(&#39;?&#39;) == -1 ? &#39;?&#39; : &#39;&amp;&#39;) + data;<br>            data = null;<br>        }<br>        var xhr = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');<br>        xhr.onreadystatechange = function(){<br>            <em>onStateChange(xhr,success,failure);<br>        };<br>        xhr.open(method,url,async);<br>        if(method == 'POST'){<br>            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded;');<br>        }<br>        xhr.send(data);<br>        return xhr; <br>    }<br>    function </em>onStateChange(xhr,success,failure){<br>        if(xhr.readyState == 4){<br>            var s = xhr.status;<br>            if(s&gt;= 200 &amp;&amp; s &lt; 300){<br>                success(xhr);<br>            }else{<br>                failure(xhr);<br>            }<br>        }else{}<br>    }<br>    return {request:request};   <br>}();<br><img src="http://www.cnblogs.com/rubylouvre/aggbug/2851051.html?type=1" width="1" height="1" alt=""><p><a href="http://www.cnblogs.com/rubylouvre/archive/2013/01/08/2851051.html">本文链接</a></p></p>

</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/yourusername/">github.com/yourusername</a><br />
                  <a href="http://twitter.com/yourusername/">twitter.com/yourusername</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
